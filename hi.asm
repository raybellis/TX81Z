;****************************************************
;* A09 Assembler options			    *
;****************************************************

	IF	&VERSION < $012C
		ERR	"Incompatible assembler version - 1.44 or higher required"
	ENDIF

			NAME	HI
                        OPT     H03,NCL,NOW,EXP

FILCHR                  TEXT    $FF
BANK			TEXT	HI

			INCLUDE "inc/macros.asm"

;****************************************************
;* Used Labels					    *
;****************************************************

			INCLUDE	"inc/hw.asm"
			INCLUDE	"inc/ram.asm"

; CPU RAM

M0041			EQU	$0041
M0045			EQU	$0045
M0048			EQU	$0048
M0049			EQU	$0049
M0050			EQU	$0050
M0051			EQU	$0051
M0052			EQU	$0052
M0053			EQU	$0053
M0054			EQU	$0054
M_LOOP_COUNT		EQU	$0055
M0056			EQU	$0056
M0057			EQU	$0057
M0058			EQU	$0058
M0059			EQU	$0059
M005A			EQU	$005A
M005B			EQU	$005B
M0060			EQU	$0060
M006B			EQU	$006B
M006C			EQU	$006C
M006D			EQU	$006D
M006E			EQU	$006E
M006F			EQU	$006F
M0070			EQU	$0070
M0071			EQU	$0071
M0072			EQU	$0072
M0073			EQU	$0073
M0074			EQU	$0074
M0076			EQU	$0076
M0077			EQU	$0077
M0079			EQU	$0079
M007B			EQU	$007B
M007C			EQU	$007C
M007D			EQU	$007D
M007E			EQU	$007E
M0080			EQU	$0080
M0081			EQU	$0081
M0082			EQU	$0082
M0083			EQU	$0083
M0084			EQU	$0084
M0085			EQU	$0085
M0086			EQU	$0086
M0088			EQU	$0088
M0089			EQU	$0089
M008C			EQU	$008C
M008D			EQU	$008D
M008E			EQU	$008E
M0090			EQU	$0090
M0091			EQU	$0091
M0092			EQU	$0092
M0093			EQU	$0093
M0095			EQU	$0095
M0097			EQU	$0097
M0098			EQU	$0098
M009A			EQU	$009A
M009B			EQU	$009B
M009D			EQU	$009D
M009E			EQU	$009E
M009F			EQU	$009F
M00A0			EQU	$00A0
M00A1			EQU	$00A1
M00A2			EQU	$00A2
M00A3			EQU	$00A3
M00A4			EQU	$00A4
M00A5			EQU	$00A5
M00A6			EQU	$00A6
M00A7			EQU	$00A7
M00A9			EQU	$00A9
M00AD			EQU	$00AD
M00AE			EQU	$00AE
M00AF			EQU	$00AF
M00B0			EQU	$00B0
M00B2			EQU	$00B2
M00B3			EQU	$00B3
M00B4			EQU	$00B4
M00B6			EQU	$00B6
M00B8			EQU	$00B8
M00BA			EQU	$00BA
M00BC			EQU	$00BC
M00BD			EQU	$00BD
M00BE			EQU	$00BE
M00BF			EQU	$00BF
M00C0			EQU	$00C0
M00C1			EQU	$00C1
M00C2			EQU	$00C2
M00C3			EQU	$00C3
M00C4			EQU	$00C4
M00C5			EQU	$00C5
M00C6			EQU	$00C6
M00C7			EQU	$00C7
M00C8			EQU	$00C8
M00C9			EQU	$00C9
M00CA			EQU	$00CA
M00CB			EQU	$00CB
M00CC			EQU	$00CC
M00CE			EQU	$00CE
M00DA			EQU	$00DA
M00DC			EQU	$00DC
M00DF			EQU	$00DF
M00E0			EQU	$00E0
M00E1			EQU	$00E1
M00E2			EQU	$00E2
M00E3			EQU	$00E3
M00E5			EQU	$00E5
M00E7			EQU	$00E7
M00EF			EQU	$00EF
M00F0			EQU	$00F0
M00F1			EQU	$00F1
M00F2			EQU	$00F2
M00F3			EQU	$00F3
M00F4			EQU	$00F4
M00F5			EQU	$00F5
M00F6			EQU	$00F6
M00FE			EQU	$00FE

; System RAM

M69C1			EQU	$69C1
M6A19			EQU	$6A19
M6A67			EQU	$6A67
M6A9B			EQU	$6A9B
M6AA6			EQU	$6AA6
M6AA9			EQU	$6AA9
M6AAD			EQU	$6AAD
M6ABE			EQU	$6ABE
M6AC1			EQU	$6AC1
M6AC4			EQU	$6AC4
M6AD5			EQU	$6AD5
M6DD7			EQU	$6DD7
M6DE0			EQU	$6DE0
M6E37			EQU	$6E37
M6E38			EQU	$6E38
M6E39			EQU	$6E39
M6E3A			EQU	$6E3A
M7565			EQU	$7565
M7566			EQU	$7566
M7567			EQU	$7567
M7568			EQU	$7568
M7569			EQU	$7569
M756A			EQU	$756A
M756B			EQU	$756B
M756C			EQU	$756C
M756D			EQU	$756D
M756E			EQU	$756E
M756F			EQU	$756F
M7570			EQU	$7570
M7571			EQU	$7571
M75F1			EQU	$75F1
M75F2			EQU	$75F2
M75F3			EQU	$75F3
M75F4			EQU	$75F4
M75F5			EQU	$75F5
M75F6			EQU	$75F6
M75F7			EQU	$75F7
M75F8			EQU	$75F8
M7628			EQU	$7628
M7640			EQU	$7640
M76C0			EQU	$76C0
M7735			EQU	$7735
M7740			EQU	$7740
M7750			EQU	$7750
M7751			EQU	$7751
M7752			EQU	$7752
M7753			EQU	$7753
M7754			EQU	$7754
M7755			EQU	$7755
M7756			EQU	$7756
M775B			EQU	$775B
M775C			EQU	$775C
M775D			EQU	$775D
M775F			EQU	$775F
M7761			EQU	$7761
M7763			EQU	$7763
M7765			EQU	$7765
M7766			EQU	$7766
M7767			EQU	$7767
M7769			EQU	$7769
M776A			EQU	$776A
M776B			EQU	$776B
M776C			EQU	$776C
M776D			EQU	$776D
M776E			EQU	$776E
M776F			EQU	$776F
M7770			EQU	$7770
M7771			EQU	$7771
M7772			EQU	$7772
M7773			EQU	$7773
M7774			EQU	$7774
M7775			EQU	$7775
M7776			EQU	$7776
M7777			EQU	$7777
M7778			EQU	$7778
M7779			EQU	$7779
M777A			EQU	$777A
M777B			EQU	$777B
M777C			EQU	$777C
M777D			EQU	$777D
M777E			EQU	$777E
M777F			EQU	$777F
M7780			EQU	$7780
M7781			EQU	$7781
M7783			EQU	$7783
M7784			EQU	$7784
M7786			EQU	$7786
M7787			EQU	$7787
M7788			EQU	$7788
M7789			EQU	$7789
M778A			EQU	$778A
M778B			EQU	$778B
M778C			EQU	$778C
M778D			EQU	$778D
M778E			EQU	$778E
M778F			EQU	$778F
M7790			EQU	$7790
M7791			EQU	$7791
M7792			EQU	$7792
M7793			EQU	$7793
M7794			EQU	$7794
M7795			EQU	$7795
M7796			EQU	$7796
M77A6			EQU	$77A6
M77B6			EQU	$77B6
M77C6			EQU	$77C6
M77CE			EQU	$77CE
M77EE			EQU	$77EE
M780E			EQU	$780E
M781E			EQU	$781E
M782E			EQU	$782E
M7836			EQU	$7836
M7846			EQU	$7846
M784E			EQU	$784E
M784F			EQU	$784F
M7850			EQU	$7850
M7851			EQU	$7851
M7852			EQU	$7852
M7853			EQU	$7853
M7873			EQU	$7873
M7893			EQU	$7893
M78A3			EQU	$78A3
M78C3			EQU	$78C3
M78D3			EQU	$78D3
M7913			EQU	$7913
M791B			EQU	$791B
M7923			EQU	$7923
M792B			EQU	$792B
M7933			EQU	$7933
M7937			EQU	$7937
M793B			EQU	$793B
M7942			EQU	$7942
M7943			EQU	$7943
M7CE3			EQU	$7CE3
M7CF1			EQU	$7CF1
M7CF3			EQU	$7CF3
M7D01			EQU	$7D01
M7D03			EQU	$7D03
M7D13			EQU	$7D13
M7D15			EQU	$7D15
M7D17			EQU	$7D17
M7D19			EQU	$7D19
M7D1B			EQU	$7D1B
M7D23			EQU	$7D23
M7D2B			EQU	$7D2B
M7D33			EQU	$7D33
M7D3B			EQU	$7D3B
M7D53			EQU	$7D53
M7D5A			EQU	$7D5A
M7D5B			EQU	$7D5B
M7D62			EQU	$7D62
M7D63			EQU	$7D63
M7D6A			EQU	$7D6A
M7D6B			EQU	$7D6B
M7D72			EQU	$7D72
M7D73			EQU	$7D73
M7D7B			EQU	$7D7B
M7D83			EQU	$7D83
M7D8A			EQU	$7D8A
M7DCB			EQU	$7DCB
M7DCC			EQU	$7DCC
M7E0B			EQU	$7E0B
M7E0C			EQU	$7E0C
M7EE7			EQU	$7EE7
M7EE8			EQU	$7EE8
M7EE9			EQU	$7EE9
M7EF1			EQU	$7EF1
M7EF9			EQU	$7EF9
M7F01			EQU	$7F01
M7F08			EQU	$7F08
M7F09			EQU	$7F09
M7F29			EQU	$7F29
M7F39			EQU	$7F39
M7F89			EQU	$7F89
M7F99			EQU	$7F99
M7F9A			EQU	$7F9A
M7FB2			EQU	$7FB2

;****************************************************
;* Program Code / Data Areas			    *
;****************************************************

			ORG	$8000

hdlr_RST		BANK_HI			; ensure we remain in the HI bank
			LDAA	#%11111000	; set P63 - P67 as outputs
			STAA	DDR6		; -
			BANK_HI			; make sure we're really in the HI bank
			JMP	RESET		; jump to real reset routine

hdlr_OCI		JSR	OCI
			RTI
			JSR	OCI		; entry point from LO bank
			BANK_SW			; return to LO bank
			RTI

hdlr_CMI		JSR	CMI
			RTI
			JSR	CMI		; entry point from LO bank
			BANK_SW			; return to LO bank
			RTI

hdlr_SIO		JSR	SIO
			RTI
			JSR	SIO		; entry point from LO bank
			BANK_SW			; return to LO bank
			RTI

hdlr_IRQ1		JSR	IRQ1
			RTI
			JSR	IRQ1		; entry point from LO bank
			BANK_SW			; return to LO bank
			RTI

			INCLUDE	"inc/xrom.asm"
			INCLUDE	"inc/init.asm"

;-------

			ORG	$8200

RESET			; disable interrupts
			SEI

			; enable internal RAM and MRE (MRDY on P52)
			LDAA	#%01000100
			STAA	RP5CR

			; initalise timers
			CLRA
			STAA	TCSR1
			STAA	TCSR2

			; timer 2 input = E clock / 128
			LDAA	#%00000010
			STAA	TCSR3

			; set initial stack pointer
			LDS	#STACK_TOP

			; set all LEDs off
			LDAA	#%00001000
			STAA	PORT6

			; P20 is an output (Cassette interface output)
			CLR	>PORT2
			LDAA	#%00000001
			STAA	DDR2
			CLR	>PORT2

			; Initialise the YM2414 OPZ FM chip
			JSR	OPZ_INIT

			; clear CPU RAM from $40 - $ff
			LDX	#XROM
			LDAB	#$C0
			CLRA
1			STAA	,X
			INX
			DECB
			BNE	1B

			LDAA	#$FF
			STAA	M0051
			JSR	HI_CALL_08
			JSR	LCD_INIT
			JSR	F_C548
			LDAA	M7772
			ANDA	#$04
			BEQ	2F
			JSR	F_B820
			JSR	LO_CALL_08
2			JSR	HI_CALL_00
			JSR	HI_CALL_01
			JSR	F_91FE

			; reset timer 2 and set its match value to 72
			LDAA	#0
			STAA	T2CNT
			LDAA	#72
			STAA	TCONR

			; setup timer 2
			;
			; ECMI      =  %1 -> counter match interrupt enabled
			; TOS1:TOS0 = %00 -> timer output on P26 inhibited
			; CKS1:CKS0 = %10 -> clock = FRC / 128
			;
			LDAA	#%01010010
			STAA	TCSR3

			; enable IRQ1 on P50 from the OPZ chip
			OIM	#%00000001,RP5CR

			; clear all condition code registers
			CLRA
			TAP

			BRA	LOOP

;
; vector of entry points exposed to the other ROM bank
;
XROM_VEC		FDB	HI_CALL_00
			FDB	HI_CALL_01
			FDB	HI_CALL_02
			FDB	HI_CALL_03
			FDB	HI_CALL_04
			FDB	HI_CALL_05
			FDB	HI_CALL_06
			FDB	HI_CALL_07
			FDB	HI_CALL_08
			FDB	HI_CALL_09
			FDB	HI_CALL_0A
			FDB	HI_CALL_0B
			FDB	HI_CALL_0C
			FDB	HI_CALL_0D
			FDB	HI_CALL_0E
			FDB	HI_CALL_0F
			FDB	HI_CALL_10
			FDB	HI_CALL_11
			FDB	HI_CALL_12
			FDB	HI_CALL_13
			FDB	HI_CALL_14
			FDB	HI_CALL_15
			FDB	HI_CALL_16
			FDB	HI_CALL_17
			FDB	HI_CALL_18
			FDB	HI_CALL_19
			FDB	HI_CALL_1A
			FDB	HI_CALL_1B
			FDB	HI_CALL_1C
			FDB	HI_CALL_1D
XROM_VEC2		FDB	hdlr_RST

;-------
;
; main execution loop
;
LOOP			OIM	#ECMI,TCSR3
			LDAA	M_LOOP_COUNT	; increment loop count modulo 16
			INCA			; -
			ANDA	#$0F		; -
			STAA	M_LOOP_COUNT	; -
			BNE	1F		; -
			JSR	F_89F9		; called every 16 iterations
1			JSR	F_CB3F
			JSR	F_CB3F
			NOP
			BRA	LOOP

;-------

HI_CALL_1D		STAB	M00E0
			LDX	#M00F6
			ABX
			LDAA	,X
			BNE	1F
			JMP	18F
1			PSHA
			LDAB	M0052
			JSR	F_8803
			BCS	3F
			PULA
2			JMP	18F
3			LDX	#M7EE9
			LDAB	M00E0
			ABX
			LDAA	,X
			STAA	M0053
			JSR	F_87CA
			LDAB	M7772
			ANDB	#$04
			BEQ	4F
			TST	M6E38
			BEQ	4F
			PULA
			LDAA	M7EF9
			INCA
			BEQ	2B
			BRA	5F
4			LDAA	M00E0
			JSR	F_9A2F
			TST	$3F,X
			PULA
			BEQ	5F
			JMP	F_8406
5			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAB	,X
			ASLB
			STAB	M00E1
			LDAB	$08,X
			ASLB
			STAB	M00E2
			LDAB	M0053
6			CMPB	M00E2
			BLS	7F
			LDAB	M00E1
7			LDX	#M7CE3
			ABX
			TIM	#%00000010,$01,X
			BNE	8F
			TIM	#%00000001,$01,X
			BEQ	11F
8			INCB
			INCB
			DECA
			BNE	6B
			LDX	M00E3
			LDAB	,X
			LDAA	#$FF
			STAA	,X
			CPX	M0079
			BNE	9F
			LDX	M0077
			BRA	10F
9			INX
10			STX	M00E3
			LDX	#M7CE3
			ABX
11			STAB	M0053
			LSRB
			STX	M00E1
			JSR	F_9169
			LDAB	M0053
			LSRB
			LDAA	#$08
			SEI
12			SPIN3
			OPZ_POLL
			OPZ_OUT_B
			CLI
			LDX	#M7F29
			LDAB	M00E0
			ASLB
			ABX
			LDD	,X
			PSHX
			LDX	M00E1
			STD	$20,X
			LDAB	M0053
			LSRB
			LDAA	M0052
			JSR	F_890E
			LDX	M00E1
			STD	$10,X
			PULX
			STD	,X
			LDX	M00E1
			LDAA	M0052
			LDAB	#$02
			ORAB	M0058
			STD	,X
			LDAB	M0053
			LDX	M00E5
			STAB	,X
			CPX	M0079
			BNE	15F
			LDX	M0077
			BRA	16F
15			INX
16			STX	M00E5
			BSR	F_83C0
			LDAA	M0053
			LSRA
			INCA
			LDX	#M7EE9
			LDAB	M00E0
			ABX
			CMPA	$10,X
			BLS	17F
			LDAA	$08,X
17			ASLA
			STAA	,X
			LDX	#M7F09
			LDAB	M00E0
			ASLB
			ABX
			LDD	M00E3
			STD	,X
			LDD	M00E5
			STD	$10,X
18			RTS

;-------

F_83C0			AIM	#%11111110,RP5CR
			LDAA	M0053
			LSRA
			LDAB	M00F1
			STAB	M00F0
			LDAB	M0052
			SUBB	#$0D
			JSR	F_A155
			LDAB	M0053
			LSRB
			JSR	F_8525
			LDAB	M0053
			LSRB
			LDAA	#$01
1			DECB
			BMI	2F
			ASLA
			BRA	1B
2			ORAA	M00EF
			STAA	M00EF
			LDAB	M0053
			LSRB
			LDX	#M7913
			ABX
			LDAA	#$40
			ORAA	,X
			ADDB	#$20
			SEI
3			SPIN3
			OPZ_POLL
			OPZ_OUT_A
			CLI
			RTS

;-------

F_8406			LDAA	M00E0
			LDAB	M006C
			ASLB
			MUL
			ADDD	#M7F39
			STD	M00E1
			LDX	#M7F01
			LDAB	M00E0
			ABX
			LDAA	,X
			STAA	M005A
			LDX	M00E1
			TSTA
			BEQ	3F
			CMPA	M006C
			BEQ	2F
			LDAB	M006C
1			TST	,X
			BEQ	3F
			INX
			INX
			DECB
			BNE	1B
			RTS
2			JSR	F_84EB
			LDAA	M0052
			LDAB	#$02
			ORAB	M0058
			STD	,X
			LDAB	M00E0
			LDAA	#$03
			BRA	4F
3			LDAA	M0052
			LDAB	#$02
			ORAB	M0058
			STD	,X
			LDAA	M005A
			INCA
			STAA	M005A
			LDX	#M7F01
			LDAB	M00E0
			ABX
			STAA	,X
4			LDX	#M7EF1
			ABX
			LDAB	,X
			LDX	#M7CE3
			ASLB
			ABX
			LSRB
			CMPA	#$01
			BNE	6F
			PSHB
			PSHX
			JSR	F_9169
			PULX
			LDAA	#$08
			PULB
			PSHB
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_B
			CLI
			PSHX
			LDAA	M0052
			JSR	F_890E
			PULX
			PSHX
			STD	$10,X
			PSHA
			PSHB
			LDAA	M00E0
			JSR	F_9A2F
			TST	$41,X
			PULB
			PULA
			PULX
			BEQ	5F
			STD	$20,X
5			PULB
			ASLB
			STAB	M0053
			JSR	F_83C0
			RTS
6			CMPA	#$02
			BNE	10F
			LDAA	M0052
			PSHX
			PSHB
			CLRB
			LDX	M00E1
			SUBD	,X
			BCC	7F
			CLRA
			BRA	8F
7			LDAA	#$01
8			LDX	#M005B
			LDAB	M00E0
			ABX
			STAA	,X
9			LDAA	M0052
			STAA	$08,X
			PULB
			JSR	F_890E
			PULX
			STD	$10,X
			RTS
10			PSHX
			PSHB
			LDX	#M005B
			LDAB	M00E0
			ABX
			LDAA	,X
			BEQ	11F
			LDAA	M0052
			SUBA	$08,X
			BCS	12F
			BRA	9B
11			LDAA	M0052
			SUBA	$08,X
			BCC	12F
			BRA	9B
12			PULB
			PULX
			RTS

;-------

F_84EB			LDX	#M005B
			LDAB	M00E0
			ABX
			CLR	>M006B
			TST	,X
			BEQ	1F
			COM	>M006B
1			CLRB
2			PSHX
			LDX	M00E1
			ASLB
			ABX
			LSRB
			LDAA	,X
			PULX
			BEQ	5F
			TST	,X
			BNE	3F
			CMPA	M006B
			BCS	5F
			BRA	4F
3			CMPA	M006B
			BHI	5F
4			STAA	M006B
			STAB	M007B
5			INCB
			CMPB	M006C
			BNE	2B
			LDX	M00E1
			LDAB	M007B
			ASLB
			ABX
			RTS

;-------

F_8525			TBA
			PSHA
			LDX	#M7846
			ABX
			LDAB	,X
			ANDB	#$03
			CMPB	#$01
			BNE	1F
			LDAB	M7850
			BMI	3F
			LDX	#M782E
			ABX
			TST	,X
			BEQ	3F
			LDAB	#$10
			BRA	2F
1			CMPB	#$02
			BNE	4F
			LDAB	M7851
			BMI	3F
			LDX	#M782E
			ABX
			TST	,X
			BEQ	3F
			LDAB	#$20
2			ORAB	M7852
			LDAA	#$1B
			SEI
			OPZ_POLL
			OPZ_OUT_B
			CLI
3			PULB
			BRA	5F
4			PULB
			LDX	#M782E
			ABX
			TST	,X
			BEQ	5F
			LDX	#M7836
			ASLB
			ABX
			LDD	#$3FFF
			STD	,X
5			CLRB
			LDX	#M782E
			ABX
			TST	,X
			BEQ	6F
			LDX	#M7836
			ASLB
			ABX
			LDD	#$3FFF
			STD	,X
6			RTS

;-------

HI_CALL_1C		STAB	M00E0
			LDX	#M00F6
			ABX
			TST	,X
			BNE	1F
			JMP	10F
1			LDAB	M0051
			JSR	F_8803
			BCS	2F
			JMP	10F
2			JSR	F_87CA
			LDAA	M7772
			ANDA	#$04
			BEQ	3F
			TST	M6E38
			BNE	4F
3			LDAA	M00E0
			JSR	F_9A2F
			TST	$3F,X
			BEQ	4F
			JMP	11F
4			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAA	,X
			TAB
			LDX	#M7CE3
			ASLB
			ABX
5			LDAB	M0051
			CMPB	,X
			BNE	6F
			TIM	#%00000010,$01,X
			BEQ	6F
			LDAB	M0058
			EORB	$01,X
			ANDB	#$7C
			BEQ	F_85FA
6			INX
			INX
			PSHX
			LDX	#M7EF9
			LDAB	M00E0
			ABX
			CMPA	,X
			PULX
			BEQ	10F
			INCA
			BRA	5B

;-------

F_85FA			PSHX
			PSHB
			LDX	#M0049
			LDAB	M00E0
			ABX
			PULB
			TIM	#%10000000,$00,X
			PULX
			BNE	9F

F_8609			CLR	$01,X
			AIM	#%11111110,RP5CR
			LDAB	#$08
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_A
			CLI
			PSHA
			BSR	F_8631
			PULA
			BSR	F_8664
			BRA	10F
9			OIM	#%00000001,$01,X
			AIM	#%11111101,$01,X
10			RTS

;-------

F_8631			AIM	#%11111110,RP5CR
			LDAB	#$01
			PSHA
1			DECA
			BMI	2F
			ASLB
			BRA	1B
2			COMB
			ANDB	M00EF
			STAB	M00EF
			PULA
			TAB
			LDX	#M7913
			ABX
			LDAA	,X
			ANDA	#$BF
			ADDB	#$20
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_A
			CLI
			OIM	#%00000001,RP5CR
			RTS

;-------

F_8664			ASLA
			STAA	M0054
			LDX	M0077
1			LDAA	,X
			CMPA	M0054
			BEQ	2F
			CPX	M0079
			BEQ	10F
			INX
			BRA	1B
2			CPX	M00E3
			BEQ	7F
3			CPX	M0079
			BEQ	4F
			INX
			CPX	M00E5
			BEQ	5F
			DEX
			LDAA	$01,X
			STAA	,X
			INX
			BRA	3B
4			PSHX
			LDX	M00E5
			CPX	M0077
			PULX
			BEQ	6F
			PSHX
			LDX	M0077
			LDAA	,X
			PULX
			STAA	,X
			LDX	M0077
			BRA	3B
5			DEX
6			STX	M00E5
			LDAA	#$FF
			STAA	,X
			BRA	10F
7			LDAA	#$FF
			STAA	,X
			CPX	M0079
			BNE	8F
			LDX	M0077
			BRA	9F
8			INX
9			STX	M00E3
10			LDX	#M7F09
			LDAB	M00E0
			ASLB
			ABX
			LDD	M00E3
			STD	,X
			LDD	M00E5
			STD	$10,X
			RTS
11			LDX	#M7F01
			LDAB	M00E0
			ABX
			LDAA	,X
			STAA	M005A
			TSTA
			BLE	15F
			LDAA	M00E0
			LDAB	M006C
			ASLB
			MUL
			ADDD	#M7F39
			STD	M00E1
			JSR	F_876B
			BCS	15F

;-------	fallthrough

F_86E4			LDAA	M005A
			DECA
			STAA	M005A
			PSHX
			LDX	#M7F01
			LDAB	M00E0
			ABX
			STAA	,X
			PULX
			BNE	F_8731
			LDX	M00E1
			PSHX
			LDX	#M0049
			LDAB	M00E0
			ABX
			TST	,X
			PULX
			BMI	14F

;-------	fallthrough

F_8703			CLR	$01,X
			AIM	#%11111110,RP5CR
			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAB	,X
			LDAA	#$08
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_B
			CLI
			TBA
			JSR	F_8631
			BRA	15F
14			OIM	#%00000001,$01,X
			AIM	#%11111101,$01,X
15			RTS

;-------

F_8731			LDD	#$0000
			STD	,X
			JSR	F_8787
			PSHB
			PSHA
			PSHX
			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAB	,X
			PSHB
			JSR	F_890E
			STD	M00DC
			PULB
			LDX	#M7CF3
			ASLB
			ABX
			LDD	M00DC
			STD	,X
			PULX
			LDAA	M005A
			CMPA	#$01
			BNE	1F
			LDD	#$0000
			STD	,X
			LDX	M00E1
			PULA
			PULB
			STD	,X
			BRA	2F
1			PULA
			PULB
2			RTS

;-------

F_876B			LDAB	M006C
			LDX	M00E1
1			LDAA	,X
			CMPA	M0051
			BNE	2F
			LDAA	M0058
			EORA	$01,X
			ANDA	#$7C
			BEQ	3F
2			INX
			INX
			DECB
			BNE	1B
			SEC
			BRA	4F
3			CLC
4			RTS

;-------

F_8787			LDX	M00E1
			STX	M0079
			LDX	#M005B
			LDAB	M00E0
			ABX
			CLR	$08,X
			CLRB
			TST	,X
			BNE	1F
			COM	$08,X
1			PSHX
			LDX	M0079
			LDAA	,X
			PULX
			BEQ	4F
			TST	,X
			BEQ	2F
			CMPA	$08,X
			BCS	4F
			BRA	3F
2			CMPA	$08,X
			BHI	4F
3			STAA	$08,X
			STAB	M007B
4			PSHX
			LDX	M0079
			INX
			INX
			STX	M0079
			PULX
			INCB
			CMPB	M006C
			BNE	1B
			LDX	M00E1
			LDAB	M007B
			ASLB
			ABX
			LDD	,X
			RTS

;-------

F_87CA			LDAB	M00E0
			LDX	#M7EF1
			ABX
			LDAB	,X
			BMI	1F
			PSHX
			LDX	#M00E7
			ABX
			STX	M0077
			PULX
			LDAB	$08,X
			BMI	1F
			LDX	#M00E7
			ABX
			STX	M0079
			LDX	#M7F09
			LDAB	M00E0
			ASLB
			ABX
			LDD	,X
			STD	M00E3
			LDD	$10,X
			STD	M00E5
			BRA	2F
1			LDX	#M00E7
			STX	M0077
			STX	M0079
			STX	M00E3
			STX	M00E5
2			RTS

;-------

F_8803			LDAA	M7772
			ANDA	#$04
			BEQ	3F
			PSHB
			LDAA	M00E0
			LDAB	#$0C
			MUL
			LDX	#M6DD7
			ABX
			PULB
			LDAA	$05,X
			CMPA	$04,X
			BCC	1F
			CMPB	$04,X
			BCC	3F
			CMPB	$05,X
			BLS	3F
			BRA	2F
1			CMPB	$04,X
			BCS	2F
			CMPB	$05,X
			BLS	3F
2			CLC
			RTS
3			SEC
			RTS

;-------

F_8831			PSHA
			LDAA	M7772
			ANDA	#$04
			PULA
			BEQ	3F
			PSHB
			LDAB	#$0C
			MUL
			LDX	#M6DD7
			ABX
			PULB
			LDAA	$05,X
			CMPA	$04,X
			BCC	1F
			CMPB	$04,X
			BCC	3F
			CMPB	$05,X
			BLS	3F
			BRA	2F
1			CMPB	$04,X
			BCS	2F
			CMPB	$05,X
			BLS	3F
2			CLC
			RTS
3			SEC
			RTS

;-------

F_885F			STAB	M00E0
			LDX	#M0041
			ABX
			LDAA	,X
			ANDA	#$80
			PSHX
			PSHA
			COMA
			ANDA	$08,X
			BEQ	5F
			JSR	F_87CA
			LDAA	M7772
			ANDA	#$04
			BEQ	1F
			TST	M6E38
			BNE	2F
1			LDAA	M00E0
			JSR	F_9A2F
			TST	$3F,X
			BEQ	2F
			JMP	6F
2			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAA	,X
			TAB
			LDX	#M7CE3
			ASLB
			ABX
3			TIM	#%00000001,$01,X
			BEQ	4F
			AIM	#%11111110,RP5CR
			LDAB	#$08
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_A
			CLI
			CLR	$01,X
			PSHX
			PSHA
			JSR	F_8631
			PULA
			PSHA
			JSR	F_8664
			PULA
			PULX
4			INX
			INX
			PSHX
			LDX	#M7EF9
			LDAB	M00E0
			ABX
			CMPA	,X
			PULX
			BEQ	5F
			INCA
			BRA	3B
5			PULA
			PULX
			STAA	$08,X
			RTS
6			LDAA	M00E0
			LDAB	M006C
			ASLB
			MUL
			ADDD	#M7F39
			XGDX
			TIM	#%00000001,$01,X
			BEQ	7F
			CLR	$01,X
			AIM	#%11111110,RP5CR
			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAA	,X
			LDAB	#$08
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_A
			CLI
			JSR	F_8631
7			BRA	5B

;-------

F_890E			STAB	M00DC
			LDX	#M793B
			ABX
			LDAB	,X
			PSHB
			LDAB	M7772
			BITB	#$04
			BNE	1F
			JMP	13F
1			PULB
			PSHA
			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			PULA
			PSHX
			TST	$0B,X
			BEQ	5F
			LDAB	M6E37
			CMPB	#$01
			BNE	2F
			TAB
			ASLB
			LDX	#M7640
			ABX
			LDD	,X
			ASLB
			ASLB
			BRA	6F
2			TAB
			CLRA
3			SUBB	#$0C
			BMI	4F
			ADDA	M7F99
			BRA	3B
4			ADDB	#$0C
			LDX	#M7F9A
			ASLB
			ABX
			ADDA	,X
			LDAB	$01,X
			ASLB
			ASLB
			BRA	6F
5			CLRB
6			SUBA	#$0D
			STD	M008E
			LDAB	M00DC
			LDX	#M791B
			ABX
			ADDA	,X
7			BLT	9F
8			CMPA	#$60
			BCS	10F
			SUBA	#$0C
			BRA	8B
9			ADDA	#$0C
			BRA	7B
10			STAA	M008E
			PULX
			LDAA	#$9F
			LDAB	M008E
			SBA
			LSRA
			LSRA
			LDAB	$06,X
			SUBB	#$07
			BPL	11F
			NEGB
			MUL
			LSRD
			LSRD
			STD	M00DC
			LDD	M008E
			SUBD	M00DC
			BPL	12F
			CLRA
			BRA	12F
11			MUL
			LSRD
			LSRD
			STD	M00DC
			LDD	M008E
			ADDD	M00DC
			CMPA	#$60
			BCS	12F
			CLRA
12			RTS
13			PULB
			TST	M7F99
			BEQ	17F
			LDAB	M7789
			CMPB	#$02
			BEQ	16F
			TAB
			CLRA
14			SUBB	#$0C
			BMI	15F
			ADDA	M7F99
			BRA	14B
15			ADDB	#$0C
			LDX	#M7F9A
			ASLB
			ABX
			ADDA	,X
			LDAB	$01,X
			ASLB
			ASLB
			BRA	18F
16			TAB
			ASLB
			LDX	#M7640
			ABX
			LDD	,X
			ASLB
			ASLB
			BRA	18F
17			CLRB
18			SUBA	#$0D
			STD	M008E
			LDAB	M00DC
			LDX	#M791B
			ABX
			ADDA	,X
19			BLT	21F
20			CMPA	#$60
			BCS	22F
			SUBA	#$0C
			BRA	20B
21			ADDA	#$0C
			BRA	19B
22			STAA	M008E
			LDD	M008E
			RTS

;-------

F_89F9			JSR	HI_CALL_17
			TSTB
			BEQ	F_8A08
			CLR	>M00CC
			CLR	>M0056
			CLR	>M0057

;-------	fallthrough

F_8A08			CMPB	#$03
			BCS	1F
			CMPB	#$04
			BEQ	1F
			LDAA	#$FF
			STAA	M7795
			CMPB	#$0A
			BCC	1F
			STAA	M7794
1			LDAA	M7772

			JSR	JMPOFF1
			FCB	C_8ADD - *
			FCB	$01
			FCB	C_8A39 - *
			FCB	$03
			FCB	C_8AC2 - *
			FCB	$08
			FCB	C_8ACA - *
			FCB	$0A
			FCB	2F - *
			FCB	$0C
			FCB	3F - *
			FCB	$0D
			FCB	2F - *
			FCB	$00

2			JMP	C_8B9E
3			JMP	C_8BB3
4			JMP	C_8BBB

C_8A39			CMPA	#$12
			BCC	17F

			JSR	JMPOFFA
			FCB	13F - *
			FCB	13F - *
			FCB	C_8A69 - *
			FCB	C_8ADD - *
			FCB	13F - *
			FCB	13F - *
			FCB	6F - *
			FCB	C_8ADD - *
			FCB	C_8ADD - *
			FCB	18F - *
			FCB	19F - *
			FCB	C_8ADD - *
			FCB	C_8ADD - *
			FCB	C_8ADD - *
			FCB	20F - *
			FCB	C_8ADD - *
			FCB	C_8ADD - *
			FCB	18F - *

6			DECB
			TST	M7795
			BMI	7F
			TSTB
			BNE	10F
			JSR	F_B88D
			BRA	10F
7			JSR	F_8D02
			TAB

;-------	fallthrough

F_8A64			JSR	F_B7C3
			BRA	4B

C_8A69			SUBB	#$01
			TST	M7795
			BMI	11F
			TSTB
			BNE	10F
			JSR	F_B83F
10			LDAA	#$FF
			STAA	M7795
			BRA	4B
11			JSR	F_8CCE
			TAB

;-------	fallthrough

F_8A81			JSR	F_B784
			BRA	4B

;-------

13			ANDA	#$18
			BNE	C_8ADD
			TST	M7794
			BMI	15F
			CMPB	#$01
			BNE	14F
			JSR	F_B8A7
14			LDAA	#$FF
			STAA	M7794
			BRA	4B
15			JSR	F_B931
			BCS	16F
			JSR	F_BC2A
			BCS	4B
			BRA	C_8ADD
16			TST	>M00CE
			BEQ	4B
			CLR	>M00CE
17			BRA	C_8ADD
18			JSR	F_B8E3
			BRA	22F
19			JSR	F_B862
			BRA	22F
20			JSR	F_B884
			BRA	22F
C_8AC2			SUBB	#$03
			JSR	F_AF7B
22			JMP	C_8BBB
C_8ACA			SUBB	#$08
			CMPA	#$07
			BCC	C_8ADD
			CLR	>M00A4

			JSR	JMPOFFA
			FCB	27F - *
			FCB	27F - *
			FCB	37F - *
			FCB	34F - *
			FCB	25F - *
			FCB	26F - *
			FCB	C_8ADD - *

C_8ADD			JMP	44F
25			JMP	39F
26			JMP	38F
27			LDAA	M7788
			BEQ	33F
			CMPA	#$01
			BEQ	31F
			CMPA	#$02
			BHI	C_8ADD
			LDAA	M7774
			CMPA	#$1C
			BNE	30F
			LDAA	M7789
			BEQ	30F
			CMPA	#$02
			BEQ	29F
			TST	M778C
			BEQ	28F
			JSR	F_8C90
			LDAB	M7774
			BRA	36F
28			COMB
			ANDB	#$01
			LDAA	#$0A
			STAA	M00A7
			LDAA	M778A
			JSR	F_8D0C
			STAA	M778A
			BRA	32F
29			JSR	F_8C64
			BCS	32F
30			JSR	F_8C42
			BRA	32F
31			LDAA	M7789
			PSHA
			JSR	F_8C06
			JSR	F_8BC2
			PULA
			JSR	F_8D48
32			LDAB	M7774
			BRA	36F
33			LDAA	M7772
			CMPA	#$01
			BEQ	35F
			LDAA	#$14
			STAA	M00A9
			LDAA	#$1E
			STAA	M00A7
			LDAA	M7774
			JSR	F_8CA9
			TAB
			BRA	36F
34			JMP	C_8BBB
35			LDAA	#$0A
			STAA	M00A7
			CLR	>M00A9
			LDAA	M7774
			JSR	F_8CA9
			TAB
			JSR	F_8DB2
36			JSR	F_B1DD
			BRA	C_8BBB
37			JSR	F_8CE7
			TAB
			JSR	F_B784
			BRA	C_8BBB
38			LDAA	#$35
			STAA	M00A7
			LDAA	#$28
			STAA	M00A9
			LDAA	M7774
			JSR	F_8CA9
			TAB
			JSR	F_8D1D
			BRA	36B
39			LDAA	#$3E
			STAA	M00A7
			LDAA	#$3C
			STAA	M00A9
			LDAA	M7774
			JSR	F_8CA9
			TAB
			BRA	36B
C_8B9E			TST	M7790
			BEQ	41F
			CMPB	#$0C
			BCC	44F
			SUBB	#$0A
			JSR	F_8DCD
			BRA	C_8BBB
41			JSR	F_AB9E
			BRA	C_8BBB
C_8BB3			COM	M7790
			BEQ	C_8BBB
			CLR	>M009A
C_8BBB			JSR	F_C95A
			JSR	F_C972
44			RTS

;-------

F_8BC2			LDAA	M7774
			CMPA	#$04
			BEQ	3F
			CMPA	#$15
			BNE	5F
			LDAA	M7789
			TSTB
			BEQ	1F
			CMPA	#$08
			BNE	5F
			BRA	2F
1			CMPA	#$0A
			BNE	5F
2			TST	M756C
			BNE	5F
			JSR	F_8C06
			JSR	F_8C06
			JSR	F_8C06
			BRA	5F
3			PSHB
			JSR	F_B6A8
			TSTB
			BNE	4F
			TAB
			LDAA	#$05
			JSR	F_AF64
			TST	$57,X
			BNE	4F
			PULB
			JSR	F_8C06
			BRA	5F
4			PULB
5			RTS

;-------

F_8C06			LDAA	M7789
			CMPA	M778D
			BHI	2F
			TSTB
			BNE	1F
			DECA
			BPL	3F
			BRA	2F
1			INCA
			CMPA	M778D
			BLS	3F
2			CLR	M7788
			CLR	M7789
			LDAA	#$01
			STAA	M00A4
			LDAA	M7774
			CMPA	#$19
			BCS	4F
			CMPA	#$1C
			BCC	4F
			PSHB
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			JSR	F_91FE
			PULB
			BRA	4F
3			STAA	M7789
4			RTS

;-------

F_8C42			LDAA	M778A
			CMPA	M778E
			BHI	2F
			TSTB
			BNE	1F
			DECA
			BPL	3F
			BRA	2F
1			INCA
			CMPA	M778E
			BLS	3F
2			LDAA	#$01
			STAA	M7788
			STAA	M00A4
			CLRA
3			STAA	M778A
			RTS

;-------

F_8C64			PSHB
			LDX	#M7CE3
			LDAB	#$08
1			TIM	#%00000010,$01,X
			BNE	3F
			INX
			INX
			DECB
			BNE	1B
			LDX	#M7F39
			LDAB	M006C
2			TIM	#%00000010,$01,X
			BNE	3F
			INX
			INX
			DECB
			BNE	2B
			CLC
			BRA	4F
3			LDAA	,X
			ANDA	#$7F
			STAA	M778A
			SEC
4			PULB
			RTS

;-------

F_8C90			LDAA	M778F
			TSTB
			BEQ	1F
			INCA
			CMPA	#$0C
			BCS	2F
			CLRA
			BRA	2F
1			DECA
			CMPA	#$0C
			BCS	2F
			LDAA	#$0B
2			STAA	M778F
			RTS

;------

F_8CA9			CMPA	M00A7
			BHI	2F
			TSTB
			BNE	3F
			DECA
			TST	>M00A9
			BEQ	1F
			CMPA	M00A9
			BCC	4F
			LDAA	M00A9
			BRA	4F
1			CMPA	M00A7
			BCS	4F
2			LDAA	M00A9
			BRA	4F
3			INCA
			CMPA	M00A7
			BLS	4F
			LDAA	M00A7
4			RTS

;-------

F_8CCE			LDAA	M7773
			TSTB
			BEQ	1F
			DECA
			BRA	2F
1			INCA
2			ANDA	#$1F
			LDAB	M7773
			ANDB	#$E0
			ABA
			CMPA	#$A0
			BCS	3F
			LDAA	#$80
3			RTS

;-------

F_8CE7			LDAA	M7773
			TSTB
			BNE	1F
			SUBA	#$20
			CMPA	#$A0
			BCS	2F
			ANDA	#$1F
			ADDA	#$80
			BRA	2F
1			ADDA	#$20
			CMPA	#$A0
			BCS	2F
			ANDA	#$1F
2			RTS

;-------

F_8D02			LDAA	#$17
			STAA	M00A7
			LDAA	M7779
			JMP	F_8D0C

;-------

F_8D0C			TSTB
			BEQ	1F
			DECA
			BPL	2F
			LDAA	M00A7
			BRA	2F
1			INCA
			CMPA	M00A7
			BLS	2F
			CLRA
2			RTS

;-------

F_8D1D			CMPB	#$33
			BNE	1F
			LDAA	M778C
			ADDA	#$02
			CMPA	#$0A
			BCS	3F
			LDAA	#$09
			BRA	3F
1			CMPB	#$35
			BNE	2F
			CLRA
			BRA	3F
2			LDAA	M7774
			CMPA	#$33
			BNE	4F
			LDAA	M778C
			SUBA	#$02
			BPL	3F
			CLRA
3			STAA	M778C
4			RTS

;-------

F_8D48			PSHB
			TST	M7788
			BEQ	3F
			LDAB	M7774
			CMPB	#$03
			BNE	6F
			CMPA	#$01
			BNE	1F
			LDAA	M7789
			BEQ	4F
			LDAA	M778C
			CMPA	#$05
			BCC	4F
			DECA
			BPL	2F
			CLRA
			BRA	2F
1			LDAA	M7789
			BEQ	4F
			CMPA	#$01
			BNE	5F
			LDAA	M778C
			CMPA	#$04
			BCC	4F
			INCA
2			STAA	M778C
3			PULB
			RTS
4			CLRA
			BRA	2B
5			LDAA	M778C
			CMPA	#$04
			BCS	3B
			BRA	4B
6			CMPB	#$04
			BNE	7F
			LDAA	M7789
			BEQ	4B
			CMPA	#$03
			BEQ	4B
			CMPA	#$06
			BEQ	4B
			CMPA	#$09
			BEQ	4B
			LDAA	#$01
			BRA	2B
7			CMPB	#$07
			BNE	8F
			BRA	5B
8			CMPB	#$09
			BNE	3B
			BRA	5B

;-------

F_8DB2			TSTB
			BEQ	2F
			CMPB	#$05
			BEQ	1F
			CMPB	#$06
			BEQ	1F
			CMPB	#$08
			BNE	3F
1			LDAA	M778C
			CMPA	#$04
			BCS	3F
2			CLRA
			STAA	M778C
3			RTS

;-------

F_8DCD			CMPA	#$09
			BEQ	1F
			CMPA	#$11
			BNE	2F
1			JMP	29F
2			CMPA	#$07
			BCC	3F

			JSR	JMPOFFA
			FCB	C_8DEA - *
			FCB	C_8E38 - *
			FCB	3F - *
			FCB	3F - *
			FCB	C_8E2E - *
			FCB	C_8EBB - *
			FCB	4F - *

3			RTS
4			JMP	C_8EF6
C_8DEA			LDAA	M776B
			ANDA	#$F7
			STAA	M776B
			LDAA	M7774
			CMPA	#$1F
			BNE	6F
			JMP	21F
6			CMPA	#$1B
			BNE	7F
			LDAA	M7788
			CMPA	#$02
			BNE	3B
			BRA	14F
7			CMPA	#$1C
			BNE	3B
			LDAA	M7788
			CMPA	#$02
			BNE	3B
			LDAA	M7789
			CMPA	#$01
			BEQ	8F
			CMPA	#$03
			BNE	16F
8			LDAA	M778A
			CMPA	#$01
			BCS	9F
			CMPA	#$05
			BCS	16F
9			CLRA
			JMP	27F
C_8E2E			LDAA	M7774
			CMPA	#$3C
			BNE	3B
			JMP	C_8EF6
C_8E38			LDAA	M7774
			BEQ	13F
			CMPA	#$0B
			BCC	3B
			CMPA	#$03
			BCS	3B
			BNE	15F
			LDAA	M7788
			BEQ	3B
			CMPA	#$01
			BNE	3B
			LDAA	M7789
			BEQ	13F
			CMPA	#$01
			BEQ	12F
			JMP	C_8EF6
12			JMP	28F
13			LDAA	#$04
			JMP	26F
14			LDAA	#$03
			JMP	26F
15			CMPA	#$04
			BNE	17F
			LDAA	M7788
			CMPA	#$01
			BNE	19F
			LDAA	M7789
			BEQ	13B
			CMPA	#$03
			BEQ	13B
			CMPA	#$06
			BEQ	13B
			CMPA	#$09
			BEQ	13B
			LDAA	#$05
			BRA	26F
16			LDAA	#$01
			BRA	26F
17			CMPA	#$07
			BCS	C_8EF6
			BEQ	18F
			CMPA	#$09
			BCS	C_8EF6
			BEQ	18F
			BHI	20F
18			LDAA	M7788
			CMPA	#$01
			BEQ	C_8EF6
19			JMP	3B
20			LDAA	M7788
			CMPA	#$01
			BNE	19B
			LDAA	M7789
			CMPA	#$0F
			BNE	19B
20			LDAA	#$09
			BRA	26F
21			LDAA	#$0F
			BRA	26F
C_8EBB			LDAA	M7774
			CMPA	#$28
			BEQ	19B
			CMPA	#$34
			BEQ	19B
			CMPA	#$36
			BCC	19B
			CMPA	#$35
			BEQ	20B
			CMPA	#$33
			BNE	C_8EF6
			LDAA	M6E37
			CMPA	#$03
			BCS	23F
			CMPA	#$07
			BCS	20B
23			LDAA	M778C
			BEQ	24F
			CMPA	#$02
			BNE	20B
			TSTB
			BNE	20B
			DEC	M778C
			BRA	20B
24			TSTB
			BEQ	20B
			INC	M778C
			BRA	20B
C_8EF6			LDAA	#$07
26			STAA	M00A7
			CLR	>M00A9
			LDAA	M778C
			JSR	F_8CA9
27			STAA	M778C
			LDAB	M7774
			JMP	F_B1DD
28			LDAA	#$08
			BRA	26B
29			LDAA	#$01
			STAA	M00A7
			CLR	>M00A9
			LDAA	M0059
			JSR	F_8CA9
			STAA	M0059
			RTS

;-------
;
; CMI interrupt handler
;
CMI			LDAA	#%00010010
			STAA	TCSR3
			LDAA	TCSR1
			PSHA
			AIM	#%11110111,TCSR1
			LDAA	TCSR2
			PSHA
			AIM	#%11110111,TCSR2
			LDAA	RP5CR
			PSHA
			AIM	#%11111110,RP5CR
			LDAA	XROM
			PSHA
			CLI
			COM	>M006D
			JSR	F_EC17
			JSR	F_E8D0
			JSR	F_ABC7
			TST	>M006D
			BPL	Z8F58
			JSR	F_A390
			JSR	F_AAF7
			JSR	F_AA1A
			JSR	F_A538
			BRA	Z8F78
Z8F58			JSR	F_A64D
			LDAA	M776B
			ANDA	#$02
			BEQ	Z8F6F
			LDAA	M7767
			BEQ	Z8F6F
			ANDA	#$03
			DECA
			STAA	M7767
			BRA	Z8F75
Z8F6F			JSR	F_ECFE
			JSR	F_A68F
Z8F75			JSR	F_A94B
Z8F78			SEI
			SPIN3
			PULA
			STAA	XROM
			PULA
			STAA	RP5CR
			PULA
			STAA	TCSR2
			PULA
			STAA	TCSR1
			OIM	#ECMI,TCSR3
			RTS

;-------
;
; Timer 1 Output Compare Interrupt
;
OCI			LDAA	RP5CR
			PSHA
			AIM	#%11111110,RP5CR
			LDAA	TCSR3
			PSHA
			LDAA	TCSR2
			PSHA
			AIM	#%11110111,TCSR1
			AIM	#%11110111,TCSR2
			AIM	#~ECMI,TCSR3
			LDD	FRCH
			ADDD	#$373B
			STD	OCR1H
			CLI
			PULB
			ROLB
			ROLB
			BCS	Z8FB6
			ROLB
			BCS	Z8FB2
			BRA	Z8FEC
Z8FB2			NOP
			NOP
			BRA	Z8FDF
Z8FB6			LDAA	M776B
			BITA	#$01
			BEQ	Z8FEC
			LDAA	XROM
			PSHA
			LDX	M0077
			PSHX
			LDX	M0079
			PSHX
			LDAA	M007B
			PSHA
			JSR	F_EAE6
			PULA
			STAA	M007B
			PULX
			STX	M0079
			PULX
			STX	M0077
			PULA
			STAA	XROM
			LDAA	M776B
			BITA	#$01
			BEQ	Z8FEC
Z8FDF			SEI
			OIM	#%00001000,TCSR1
			SPIN3
			PULA
			STAA	TCSR3
			PULA
			STAA	RP5CR
			RTS
Z8FEC			SEI
			SPIN3
			PULA
			STAA	TCSR3
			PULA
			STAA	RP5CR
			RTS

;-------
;
; IRQ1 handler (OPZ chip)
;
IRQ1			LDAA	TCSR3
			PSHA
			AIM	#~ECMI,TCSR3
			AIM	#%11111110,RP5CR
			CLI
			LDAB	OPZ_DATA
			BITB	#$20
			BEQ	Z9081
			ANDB	#$1C
			LSRB
			LSRB
			TST	>M00EF
			BEQ	Z901F
			PSHB
			TBA
			LDAB	#$01
Z9014			DECA
			BMI	Z901A
			ASLB
			BRA	Z9014
Z901A			ANDB	M00EF
			BNE	Z9026
			PULB
Z901F			PSHB
			JSR	F_91B0
			PULB
			BRA	Z9049
Z9026			COMB
			ANDB	M00EF
			STAB	M00EF
			PULB
			PSHB
			JSR	F_91B0
			PULB
			ORAB	#$78
			LDAA	#$08
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_B
			CLI
			ANDB	#$07
Z9049			LDX	#M7913
			ABX
			LDAA	,X
			ANDA	#$BF
			ADDB	#$20
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_A
			CLI
			LDAB	#$40
Z9067			LDAA	#$14
			SEI
			SPIN3
			OPZ_POLL
			OPZ_OUT_B
			OIM	#%00000001,RP5CR
			PULA
			STAA	TCSR3
			RTS
Z9081			LDAB	#$30
			BRA	Z9067

;-------

OPZ_WAIT		OPZ_POLL
			RTS

;-------

F_908B			LDAB	#$A5
			MUL
			ASLD
			ASLD
			RTS

F_9091			LDAB	#$C8
			MUL
			RTS

			LDAB	#$8E
			MUL
			RTS

			LDAB	#$26
			MUL
			RTS

;-------

OPZ_INIT		CLRB
			LDAA	#$09
			JSR	OPZ_WRITE_FAST
			LDAA	#$0F
			JSR	OPZ_WRITE
			LDAA	#$1C
			JSR	OPZ_WRITE
			LDAA	#$1E
			JSR	OPZ_WRITE
			LDAA	#$0A
			LDAB	#$04
			JSR	OPZ_WRITE
			LDAA	#$14
			LDAB	#$70
			JSR	OPZ_WRITE
			LDAA	#$15
			LDAB	#$01
			JSR	OPZ_WRITE
			RTS

;-------

OPZ_WRITE		JSR	OPZ_WAIT

;-------	fallthrough

OPZ_WRITE_FAST		OPZ_OUT_B
			RTS

;-------

HI_CALL_01		PSHA
			PSHB
			PSHX
			AIM	#%11110111,TCSR1
			JSR	HI_CALL_16
			CLRA
			CLRB
			LDX	#M7CE3
Z90E3			STD	,X
			INX
			INX
			CPX	#M7CF3
			BNE	Z90E3
			LDD	#$1700
Z90EF			STD	,X
			INX
			INX
			CPX	#M7D13
			BNE	Z90EF
			LDD	#$1700
			LDX	#M7F29
Z90FE			STD	,X
			INX
			INX
			CPX	#M7F39
			BNE	Z90FE
			CLRA
			CLRB
			LDX	#M7F39
Z910C			STD	,X
			INX
			INX
			CPX	#M7F89
			BNE	Z910C
			LDX	#M00E7
			LDAA	#$FF
Z911A			STAA	,X
			INX
			CPX	#M00EF
			BNE	Z911A
			JSR	F_993C
			JSR	F_995A
			PULX
			PULB
			PULA
			RTS

HI_CALL_00		PSHA
			PSHB
			PSHX
			AIM	#%11111110,RP5CR
			AIM	#%11110111,TCSR1
			CLR	>M00EF
			BSR	F_915E
			LDAA	#$08
			CLRB
Z913D			SEI
			SPIN3
			JSR	OPZ_WAIT
			OPZ_OUT_B
			CLI
			INCB
			CMPB	#$08
			BNE	Z913D
			LDAA	#$01
			STAA	M777D
			OIM	#%00000001,RP5CR
			PULX
			PULB
			PULA
			RTS

F_915E			CLRB
Z915F			PSHB
			BSR	F_9169
			PULB
			INCB
			CMPB	#$08
			BNE	Z915F
			RTS

F_9169			PSHB
			CLRA
			ADDB	#$E0
Z916D			PSHA
			LDAA	#$FE
			SEI
			OPZ_POLL
			OPZ_OUT_A
			CLI
			ADDB	#$08
			PULA
			INCA
			CMPA	#$04
			BNE	Z916D
			PULB
			CLRA
Z918A			PSHA
			PSHB
			LDX	#M77EE
			ABX
			LDAA	,X
			ANDA	#$E8
			ADDB	#$C0
			SEI
			OPZ_POLL
			OPZ_OUT_A
			CLI
			PULB
			ADDB	#$08
			PULA
			INCA
			CMPA	#$04
			BNE	Z918A
			RTS

F_91B0			TBA
			PSHA
			CLRB
Z91B3			PSHB
			LDX	#M77CE
			TAB
			ABX
			LDAB	,X
			PSHA
			ADDA	#$E0
			SEI
			OPZ_POLL
			OPZ_OUT_B
			CLI
			PULA
			ADDA	#$08
			PULB
			INCB
			CMPB	#$04
			BNE	Z91B3
			PULA
			CLRB
Z91D9			PSHB
			LDX	#M77EE
			TAB
			ABX
			LDAB	,X
			PSHA
			ADDA	#$C0
			SEI
			OPZ_POLL
			OPZ_OUT_B
			CLI
			PULA
			ADDA	#$08
			PULB
			INCB
			CMPB	#$04
			BNE	Z91D9
			RTS

F_91FE			PSHA
			PSHB
			PSHX
			JSR	HI_CALL_0F
			BRA	Z9212
HI_CALL_05		PSHA
			PSHB
			PSHX
			JSR	HI_CALL_0F
			LDX	#F_9EEC
			JSR	F_92DB
Z9212			LDX	#F_9E95
			JSR	F_92DB
			LDX	#F_9EB9
			JSR	F_92DB
			LDX	#F_9ECC
			JSR	F_92DB
			LDX	#F_9E8A
			JSR	F_92DB
			LDX	#F_9A41
			JSR	F_92E3
			LDX	#F_9F00
			JSR	F_92DB
			LDX	#F_9DD7
			JSR	F_92DB
			LDX	#F_9E58
			JSR	F_92DB
			LDX	#F_9FEC
			JSR	F_92DB
			LDX	#F_9D68
			JSR	F_92DB
			LDX	#F_9E6D
			JSR	F_92DB
			LDX	#F_9D91
			JSR	F_92E3
			JSR	F_9A87
			LDX	#F_9B02
			JSR	F_92E3
			LDX	#F_9C35
			JSR	F_92E3
			LDX	#F_9AC2
			JSR	F_92E3
			JSR	F_9C76
			LDX	#F_9D12
			JSR	F_92E3
			LDX	#F_A049
			JSR	F_92E3
			LDX	#F_A01B
			JSR	F_92E3
			LDX	#F_A0D1
			JSR	F_92E3
			LDX	#F_A0F1
			JSR	F_92E3
			LDX	#F_A100
			JSR	F_92E3
			LDX	#F_A110
			JSR	F_92E3
			JSR	HI_CALL_18
			JSR	HI_CALL_11
			LDAA	M777D
			CMPA	#$01
			BNE	Z92B2
			LDX	#F_9EEC
			JSR	F_92DB
			CLR	M777D
Z92B2			PULX
			PULB
			PULA
			RTS
			LDX	#F_9D91
			JSR	F_92E3
			JSR	F_9A87
			LDX	#F_9B02
			JSR	F_92E3
			LDX	#F_9C35
			JSR	F_92E3
			LDX	#F_9AC2
			JSR	F_92E3
			JSR	F_9C76
			LDX	#F_9D12
			JSR	F_92E3
			RTS

F_92DB			STX	M0079
			LDX	#Z9306
			JMP	Z92E8
F_92E3			STX	M0079
			JMP	Z9306
Z92E8			LDD	M006F
			PSHA
			PSHB
			CLRA
			CLRB
			STD	M006F
Z92F0			PSHX
			JSR	,X
			PULX
			INC	>M006F
			LDAB	#$0D
			ADDB	M0070
			STAB	M0070
			CMPB	#$34
			BNE	Z92F0
			PULB
			PULA
			STD	M006F
			RTS
Z9306			CLR	>M0073
			LDD	#$0000
			STD	M0074
			CLR	>M0076
Z9311			LDX	#M00F6
			LDAB	M0073
			CMPB	#$08
			BEQ	Z9337
			ABX
			LDAB	,X
			STAB	M007B
			BEQ	Z9325
			LDX	M0079
			JSR	,X
Z9325			CLRA
			LDAB	#$6E
			ADDD	M0074
			STD	M0074
			LDAA	M0076
			CMPA	#$08
			BEQ	Z9337
			INC	>M0073
			BRA	Z9311
Z9337			RTS
HI_CALL_0F		LDAA	TCSR1
			PSHA
			AIM	#%11110111,TCSR1
			LDX	#M00F6
			STX	M0079
			LDAB	M7772
			ANDB	#$04
			BNE	Z937F
			CLRB
Z934B			CMPB	#$01
			BNE	Z935D
			LDAA	M7774
			CMPA	#$1A
			BNE	Z9374
			TST	M7788
			BEQ	Z9374
			BRA	Z936C
Z935D			TSTB
			BNE	Z9374
			LDAA	M7774
			CMPA	#$1A
			BNE	Z9370
			TST	M7788
			BEQ	Z9370
Z936C			LDAA	#$04
			BRA	Z9375
Z9370			LDAA	#$08
			BRA	Z9375
Z9374			CLRA
Z9375			STAA	,X
			INX
			INCB
			CMPB	#$08
			BNE	Z934B
			BRA	Z9382
Z937F			JSR	F_95F5
Z9382			LDAA	#$FF
			LDAB	#$08
			LDX	#M7942
Z9389			STAA	,X
			DEX
			DECB
			BNE	Z9389
			LDX	#M793B
			STX	M0079
			LDX	#M00F6
			CLRB
Z9398			LDAA	,X
			PSHX
			LDX	M0079
			TSTA
			BEQ	Z93A8
Z93A0			STAB	,X
			INX
			DECA
			BNE	Z93A0
			BRA	Z93A8
Z93A8			INCB
			STX	M0079
			CPX	#M7943
			PULX
			BEQ	Z93B7
			INX
			CPX	#M00FE
			BNE	Z9398
Z93B7			LDAB	#$FF
			STAB	M784E
			STAB	M784F
			CLRB
Z93C0			PSHB
			LDX	#M00F6
			ABX
			TST	,X
			BEQ	Z93DB
			TST	M784E
			BPL	Z93D3
			STAB	M784E
			BRA	Z93DB
Z93D3			TST	M784F
			BPL	Z93DB
			STAB	M784F
Z93DB			PULB
			INCB
			CMPB	#$08
			BNE	Z93C0
			LDX	#M7846
			STX	M0079
			CLRB
Z93E7			PSHB
			LDX	#M793B
			ABX
			LDAB	,X
			BMI	Z9410
			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			LDAB	$0A,X
			BEQ	Z9410
			CMPB	#$03
			BCC	Z9413
			PSHB
			DECB
			LDX	#M784E
			ABX
			LDAA	,X
			BMI	Z940F
			ASLA
			ASLA
			PULB
			ABA
			BRA	Z9414
Z940F			PULB
Z9410			CLRA
			BRA	Z9414
Z9413			TBA
Z9414			LDX	M0079
			STAA	,X
			INX
			STX	M0079
			PULB
			INCB
			CMPB	#$08
			BNE	Z93E7
			LDAB	#$FF
			STAB	M7850
			STAB	M7851
			CLRB
Z942A			PSHB
			LDX	#M7846
			ABX
			LDAA	,X
			ANDA	#$03
			BEQ	Z944F
			CMPA	#$03
			BCC	Z944F
			CMPA	#$01
			BNE	Z9447
			TST	M7850
			BPL	Z944F
			STAB	M7850
			BRA	Z944F
Z9447			TST	M7851
			BPL	Z944F
			STAB	M7851
Z944F			PULB
			INCB
			CMPB	#$08
			BNE	Z942A
			JSR	F_95C4
			LDAB	M7772
			ANDB	#$04
			BNE	Z94A9
			LDAA	M7774
			CMPA	#$1A
			BNE	Z9481
			TST	M7788
			BEQ	Z9481
			LDAA	#$04
			LDX	#M793B
Z9470			DEX
			STAA	,X
			CPX	#M7933
			BEQ	Z948E
			CPX	#M7937
			BHI	Z9470
			LDAA	#$02
			BRA	Z9470
Z9481			LDAA	#$07
			LDX	#M793B
Z9486			DEX
			STAA	,X
			CPX	#M7933
			BNE	Z9486
Z948E			LDAA	#$01
			LDX	#M784E
Z9493			DEX
			STAA	,X
			CPX	#M7846
			BNE	Z9493
			CLR	M7850
			LDAA	#$FF
			STAA	M7851
			LDAA	#$08
			STAA	M006C
			BRA	Z94B0
Z94A9			LDAA	#$05
			STAA	M006C
			JSR	F_C7FF
Z94B0			JSR	F_98A1
			JSR	F_995A
			LDAA	TCSR3
			PSHA
			AIM	#~ECMI,TCSR3
			JSR	HI_CALL_15
			PULA
			STAA	TCSR3
			JSR	HI_CALL_03
			PULA
			STAA	TCSR1
			RTS

F_94C9			PSHA
			PSHB
			PSHX
			BRA	Z94D7
			PSHA
			PSHB
			PSHX
			LDX	#F_9EEC
			JSR	F_9575
Z94D7			LDX	#F_9E95
			JSR	F_9575
			LDX	#F_9EB9
			JSR	F_9575
			LDX	#F_9ECC
			JSR	F_9575
			LDX	#F_9E8A
			JSR	F_9575
			LDX	#F_9A41
			JSR	F_957D
			LDX	#F_9F00
			JSR	F_9575
			LDX	#F_9DD7
			JSR	F_9575
			LDX	#F_9E58
			JSR	F_9575
			LDX	#F_9FEC
			JSR	F_9575
			LDX	#F_9D68
			JSR	F_9575
			LDX	#F_9E6D
			JSR	F_9575
			LDX	#F_9D91
			JSR	F_957D
			JSR	F_9A87
			LDX	#F_9B02
			JSR	F_957D
			LDX	#F_9C35
			JSR	F_957D
			LDX	#F_9AC2
			JSR	F_957D
			JSR	F_9C76
			LDX	#F_9D12
			JSR	F_957D
			LDX	#F_A049
			JSR	F_957D
			LDX	#F_A01B
			JSR	F_957D
			LDX	#F_A0D1
			JSR	F_957D
			LDX	#F_A0F1
			JSR	F_957D
			LDX	#F_A100
			JSR	F_957D
			LDX	#F_A110
			JSR	F_957D
			LDAA	M777D
			CMPA	#$01
			BNE	Z9571
			LDX	#F_9EEC
			JSR	F_9575
			CLR	M777D
Z9571			PULX
			PULB
			PULA
			RTS

F_9575			STX	M0079
			LDX	#Z9582
			JMP	Z92E8

F_957D			STX	M0079
			JMP	Z9582
Z9582			LDAB	M0073
			LDX	#M7EF1
			ABX
			LDAA	,X
			STAA	M0076
			LDX	#M00F6
			LDAB	M0073
			ABX
			LDAB	,X
			STAB	M007B
			BEQ	Z95A3
			LDAA	M0073
			LDAB	#$6E
			MUL
			STD	M0074
			LDX	M0079
			JSR	,X
Z95A3			RTS

F_95A4			LDX	#M7EF1
			ABX
			LDAA	,X
			LDX	#M00F6
			ABX
			TAB
			LDAA	,X
			BEQ	Z95C3
Z95B3			PSHA
			PSHB
			JSR	F_9169
			PULB
			INCB
			PULA
			DECA
			BNE	Z95B3
			LDAA	#$01
			STAA	M777D
Z95C3			RTS

F_95C4			CLR	>M0076
Z95C7			JSR	F_9A1C
			LDAA	$09,X
			LDX	#M7933
			LDAB	M0076
			ABX
			ASLA
			CMPA	#$06
			BNE	Z95D9
			ORAA	#$01
Z95D9			STAA	,X
			INC	>M0076
			LDAB	M0076
			CMPB	#$08
			BNE	Z95C7
			RTS

F_95E5			JSR	F_95C4
			LDX	#F_9A41
			JSR	F_92E3
			LDX	#F_9F00
			JSR	F_92DB
			RTS

F_95F5			CLRB
Z95F6			PSHB
			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			LDAA	,X
			LDX	M0079
			STAA	,X
			INX
			STX	M0079
			PULB
			INCB
			CMPB	#$08
			BNE	Z95F6
			RTS
HI_CALL_03		LDAB	M7772
			ANDB	#$04
			BNE	Z9624
			JSR	F_9881
			TAB
			LDAA	M778F
			BRA	Z962A
Z961E			LDX	#M7628
			JMP	Z9677
Z9624			LDAB	M6E37
			LDAA	M6E3A
Z962A			CMPB	#$02
			BCS	Z961E
			SUBB	#$02
			JSR	F_969B
			LDX	#M7F9A
			STX	M00A9
			LDX	#M7F9A
			STX	M00A7
			CLRB
Z963E			PSHB
			LDX	M00A9
			LDD	,X
			PSHA
			LDAA	M7772
			ANDA	#$04
			BNE	Z9650
			JSR	F_9881
			BRA	Z9653
Z9650			LDAA	M6E37
Z9653			CMPA	#$0B
			PULA
			BCS	Z9662
			BNE	Z965E
			SUBA	#$1E
			BRA	Z9664
Z965E			SUBA	#$0F
			BRA	Z9664
Z9662			SUBA	#$3C
Z9664			INX
			INX
			STX	M00A9
			LDX	M00A7
			STD	,X
			INX
			INX
			STX	M00A7
			PULB
			INCB
			CMPB	#$0C
			BNE	Z963E
Z9676			RTS
Z9677			STX	M00A9
			LDX	#M7F9A
			STX	M00A7
			CLRB
Z967F			PSHB
			LDX	M00A9
			LDD	,X
			SUBA	#$3C
			INX
			INX
			STX	M00A9
			LDX	M00A7
			STD	,X
			INX
			INX
			STX	M00A7
			PULB
			INCB
			CMPB	#$0C
			BNE	Z967F
			JMP	Z9676

F_969B			LDX	#DVEC_9703
			ABX
			ABX
			LDX	,X
			STX	M00A9
			TSTB
			BEQ	Z96AB
			CMPB	#$05
			BCS	Z96B6
Z96AB			LDAB	#$18
			LDX	#M7F9A
			JSR	F_AE8A
			JMP	Z9702
Z96B6			ASLA
			PSHA
			DECB
			LDAA	#$18
			MUL
			PULA
			PSHA
			ABA
			TAB
			LDX	#M9821
			ABX
			LDD	,X
			STD	M007E
			LDX	#M7F9A
			PULB
			ABX
			STX	M00A7
			LDAB	#$0C
Z96D1			PSHB
			LDX	M00A9
			LDD	,X
			INX
			INX
			STX	M00A9
			SUBA	#$0D
			ASLB
			ASLB
			LSRD
			LSRD
			ADDD	M007E
			ASLD
			ASLD
			ADDA	#$0D
			LSRB
			LSRB
			LDX	M00A7
			CPX	#M7FB2
			BCS	Z96F6
			XGDX
			SUBD	#$0018
			XGDX
			SUBA	#$0C
Z96F6			STD	,X
			LDX	M00A7
			INX
			INX
			STX	M00A7
			PULB
			DECB
			BNE	Z96D1
Z9702			RTS

DVEC_9703		FDB	M9719_via_dvec_9703
			FDB	M9731_via_dvec_9705
			FDB	M9749_via_dvec_9707
			FDB	M9761_via_dvec_9709
			FDB	M9779_via_dvec_970b
			FDB	M9791_via_dvec_970d
			FDB	M97A9_via_dvec_970f
			FDB	M97C1_via_dvec_9711
			FDB	M97D9_via_dvec_9713
			FDB	M97F1_via_dvec_9715
			FDB	M9809_via_dvec_9717

M9719_via_dvec_9703	FDB	$3C00,$3D00,$3E00,$3F00,$4000,$4100,$4200,$4300
			FDB	$4400,$4500,$4600,$4700

M9731_via_dvec_9705	FDB	$3C0A,$3C37,$3E0D,$3F14,$4001,$4109,$4136,$430B
			FDB	$4338,$4500,$4615,$4703

M9749_via_dvec_9707	FDB	$3C0A,$3C37,$3D3F,$3F14,$4001,$4109,$4136,$430B
			FDB	$4338,$4500,$4615,$4703

M9761_via_dvec_9709	FDB	$3C07,$3C37,$3E02,$3F0D,$3F3E,$4109,$4139,$4304
			FDB	$4335,$4500,$460B,$463C

M9779_via_dvec_970b	FDB	$3B3C,$3D05,$3D3F,$3E38,$4001,$403B,$4204,$423D
			FDB	$4406,$4500,$453A,$4703

M9791_via_dvec_970d	FDB	$3C08,$3D01,$3E03,$3F04,$4001,$4106,$4200,$4305
			FDB	$4403,$4500,$4605,$4703

M97A9_via_dvec_970f	FDB	$3C07,$3D00,$3E02,$3F03,$3F3E,$4105,$4200,$4304
			FDB	$4402,$4500,$4604,$463F

M97C1_via_dvec_9711	FDB	$3C04,$3D00,$3E01,$3F03,$3F3F,$4105,$413F,$4303
			FDB	$4401,$4500,$4604,$463D

M97D9_via_dvec_9713	FDB	$3C20,$3D20,$3E20,$3F20,$4020,$4120,$4220,$4320
			FDB	$4420,$4520,$4620,$4720

M97F1_via_dvec_9715	FDB	$4200,$4220,$4300,$4320,$4400,$4420,$4500,$4520
			FDB	$4600,$4620,$4700,$4720

M9809_via_dvec_9717	FDB	$3F00,$3F10,$3F20,$3F30,$4000,$4010,$4020,$4030
			FDB	$4100,$4110,$4120,$4130

M9821			FDB	$0000,$0048,$0075,$00CA,$00F7,$013F,$016C,$01B3
			FDB	$0209,$0236,$027D,$02AB,$0000,$0048,$0075,$00CA
			FDB	$00F7,$013F,$016C,$01C1,$0209,$0236,$027D,$02AB
			FDB	$0000,$004B,$007C,$00C7,$00F7,$0142,$0173,$01BE
			FDB	$0209,$0239,$0284,$02B5,$0000,$003A,$0083,$00BC
			FDB	$0105,$013F,$0188,$01C1,$01FB,$0244,$027D,$02C6

F_9881			LDAA	M7774
			CMPA	#$1C
			BNE	Z989F
			LDAA	M7788
			CMPA	#$02
			BNE	Z989F
			LDAA	M7789
			BEQ	Z989F
			CMPA	#$02
			BEQ	Z989F
			LDAA	M778A
			ADDA	#$02
			BRA	Z98A0
Z989F			CLRA
Z98A0			RTS

F_98A1			CLR	>M0072
Z98A4			LDAB	M0072
			LDX	#M00F6
			ABX
			TST	,X
			BNE	Z98B2
			LDAA	#$FF
			BRA	Z98C1
Z98B2			CLRB
			CLRA
			LDX	#M00F6
Z98B7			CMPB	M0072
			BEQ	Z98C1
			ADDA	,X
			INCB
			INX
			BRA	Z98B7
Z98C1			LDAB	M0072
			LDX	#M7EF1
			ABX
			STAA	,X
			LDAB	M0072
			INCB
			STAB	M0072
			CMPB	#$08
			BNE	Z98A4
			CLRB
Z98D3			LDX	#M7EF1
			ABX
			LDAA	,X
			BPL	Z98DF
			LDAA	#$FF
			BRA	Z98E6
Z98DF			LDX	#M00F6
			ABX
			ADDA	,X
			DECA
Z98E6			LDX	#M7EF9
			ABX
			STAA	,X
			INCB
			CMPB	#$08
			BNE	Z98D3
			LDAB	M7772
			ANDB	#$04
			BEQ	Z9911
			TST	M6E38
			BEQ	Z9911
			CLRA
			CLRB
Z98FF			LDX	#M00F6
			ABX
			ADDA	,X
			INCB
			CMPB	#$08
			BNE	Z98FF
			DECA
			STAA	M7EF9
			CLR	M7EF1
Z9911			CLRB
Z9912			PSHB
			LDX	#M7EF1
			ABX
			LDAB	,X
			BPL	Z9920
			LDX	#M00E7
			BRA	Z9924
Z9920			LDX	#M00E7
			ABX
Z9924			STX	M0077
			LDX	#M7F09
			PULB
			PSHB
			ASLB
			ABX
			LDD	M0077
			STD	,X
			STD	$10,X
			PULB
			INCB
			CMPB	#$08
			BNE	Z9912
			BSR	F_993C
			RTS

F_993C			LDX	#M7EE9
			LDAB	#$08
Z9941			LDAA	$08,X
			BPL	Z9949
			LDAA	#$FF
			BRA	Z994A
Z9949			ASLA
Z994A			STAA	,X
			INX
			DECB
			BNE	Z9941
			CLRA
			LDX	#M7F08
			LDAB	#$08
			JSR	F_C7F8
			RTS

F_995A			LDX	#M7F89
Z995D			CLR	,X
			INX
			CPX	#M7F99
			BCS	Z995D
			LDAA	#$01
			STAA	M007B
			LDAA	M7772
			ANDA	#$04
			BEQ	Z999F
			CLRA
Z9971			PSHA
			LDAB	#$0C
			MUL
			ADDD	#M6DD7
			XGDX
			LDAB	,X
			BEQ	Z9991
			LDAB	$03,X
			CMPB	#$10
			BNE	Z9987
			BSR	F_99DE
			BRA	Z9991
Z9987			LDX	#M7F89
			ABX
			LDAB	M007B
			ORAB	,X
			STAB	,X
Z9991			PULA
			TST	M6E38
			BNE	Z99CD
			INCA
			ASL	>M007B
			BNE	Z9971
			BRA	Z99CD
Z999F			CLRA
Z99A0			PSHA
			LDAB	M7566
			CMPB	#$10
			BEQ	Z99C9
			LDX	#M7F89
			ABX
			LDAB	M007B
			ORAB	,X
			STAB	,X
Z99B2			PULA
			LDAB	M7774
			CMPB	#$1A
			BNE	Z99CD
			TST	M7788
			BEQ	Z99CD
			INCA
			CMPA	#$02
			BEQ	Z99CD
			ASL	>M007B
			BRA	Z99A0
Z99C9			BSR	F_99DE
			BRA	Z99B2
Z99CD			LDAB	M00BD
			CMPB	#$F0
			BCC	Z99DD
			ANDB	#$0F
			LDX	#M7F89
			ABX
			LDAB	,X
			STAB	M00DA
Z99DD			RTS

F_99DE			CLRB
Z99DF			LDX	#M7F89
			ABX
			LDAA	M007B
			ORAA	,X
			STAA	,X
			INCB
			CMPB	#$10
			BNE	Z99DF
			RTS

F_99EF			LDD	#M6A67
			ADDD	M0074
			XGDX
			LDAB	M0070
			ABX
			RTS

F_99F9			LDAA	M006F
			LDAB	#$05
			MUL
			LDX	#M6ABE
			ABX
			XGDX
			ADDD	M0074
			XGDX
			RTS

F_9A07			TAB
			LDX	#M793B
			ABX
			LDAA	,X
			CMPA	#$08
			BCS	Z9A18
			CLRA
			BSR	F_9A2F
			SEC
			BRA	Z9A1B
Z9A18			BSR	F_9A2F
			CLC
Z9A1B			RTS

F_9A1C			LDX	#M793B
			LDAB	M0076
			ABX
			LDAB	,X
			BPL	Z9A27
			CLRB
Z9A27			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			RTS

F_9A2F			LDAB	#$6E
			MUL
			ADDD	#M6A67
			XGDX
			RTS

HI_CALL_11		LDAA	M75F7
			JSR	F_908B
			STAA	M7750
			RTS

;-------

F_9A41			LDD	#M6A9B
			ADDD	M0074
			XGDX
			LDAB	$01,X
			ASLB
			ASLB
			ASLB
			ORAB	,X
			STAB	M0072
Z9A50			LDX	#M7933
			LDAB	M0076
			ABX
			LDAA	,X
			ANDA	#$04
			BEQ	Z9A60
			LDAB	#$80
			BRA	Z9A61
Z9A60			CLRB
Z9A61			ORAB	M0072
			TBA
			LDX	#M7913
			LDAB	M0076
			ABX
			STAA	,X
			LDAB	#$20
			ADDB	M0076
			SEI
			JSR	OPZ_WAIT
			OPZ_OUT_A
			CLI
			INC	>M0076
			DEC	>M007B
			BNE	Z9A50
			RTS

;-------

F_9A87			CLR	>M0072
			LDAA	M784E
			BMI	Z9A98
			JSR	F_9A2F
			LDAA	$3B,X
			ANDA	#$03
			STAA	M0072
Z9A98			LDAA	M784F
			BMI	Z9AAA
			JSR	F_9A2F
			LDAA	$3B,X
			ANDA	#$03
			ASLA
			ASLA
			ORAA	M0072
			STAA	M0072
Z9AAA			LDAA	M0072
			STAA	M7852
			LDAB	#$1B
			SEI
			SPIN3
			JSR	OPZ_WAIT
			OPZ_OUT_A
			CLI
			RTS

F_9AC2			JSR	F_A120
			JSR	F_9AE2
			LDAA	$3A,X
			LDX	#M782E
			STX	M00A7
			JMP	Z9AD2

Z9AD2			LDX	M00A7
			LDAB	M0076
			ABX
			STAA	,X
			INC	>M0076
			DEC	>M007B
			BNE	Z9AD2
			RTS

F_9AE2			PSHX
			LDX	#M7846
			LDAB	M0076
			ABX
			LDAB	,X
			ANDB	#$03
			BEQ	Z9B00
			CMPB	#$03
			BEQ	Z9B00
			LDAB	,X
			PULX
			LSRB
			LSRB
			ANDB	#$07
			TBA
			JSR	F_9A2F
			BRA	Z9B01
Z9B00			PULX
Z9B01			RTS

;-------

F_9B02			LDAB	#$36
			JSR	F_A121
			PSHX
			LDX	#M7846
			LDAB	M0076
			ABX
			LDAB	,X
			ANDB	#$03
			BEQ	Z9B4F
			CMPB	#$03
			BEQ	Z9B4F
			PSHB
			LDAB	,X
			LSRB
			LSRB
			ANDB	#$07
			TBA
			JSR	F_9A2F
			LDAA	$36,X
			JSR	F_908B
			LDAB	$3B,X
			CMPB	#$03
			BEQ	Z9B36
			LDX	#MA82B
			TAB
			ABX
			LDAA	,X
			COMA
Z9B36			PULB
			CMPB	#$01
			BEQ	Z9B3F
			LDAB	#$16
			BRA	Z9B41
Z9B3F			LDAB	#$18
Z9B41			SEI
			JSR	OPZ_WAIT
			OPZ_OUT_A
			CLI
Z9B4F			PULX
			LDAB	,X
			ASLB
			LDX	#D_9B6D
			ABX
			LDD	,X
Z9B59			PSHB
			LDX	#M781E
			LDAB	M0076
			ASLB
			ABX
			PULB
			STD	,X
			INC	>M0076
			DEC	>M007B
			BNE	Z9B59
			RTS

D_9B6D			FDB	$0001,$0002,$000E,$001B
			FDB	$003D,$0052,$0081,$00BF
			FDB	$00EF,$0125,$0169,$01C9
			FDB	$020D,$026C,$02FB,$0346
			FDB	$03D5,$0420,$048D,$051D
			FDB	$05F7,$06D1,$071C,$07F6
			FDB	$083A,$08D0,$0A39,$0AC8
			FDB	$0BED,$0C7D,$0DA2,$0E31
			FDB	$0F56,$107B,$110A,$1199
			FDB	$122F,$1472,$1598,$16B6
			FDB	$17DB,$1900,$1B43,$1C68
			FDB	$1D87,$1EAC,$1FD1,$20EF
			FDB	$2214,$2339,$2339,$26A2
			FDB	$28E5,$28E5,$2B2F,$2D72
			FDB	$2FB6,$3200,$3443,$3443
			FDB	$3687,$38D1,$3B14,$3B14
			FDB	$3D57,$3FA2,$41E5,$41E5
			FDB	$4428,$4428,$4672,$48B6
			FDB	$48B6,$4D43,$51CA,$51CA
			FDB	$5657,$5AE5,$5AE5,$5F6C
			FDB	$63F9,$63F9,$6887,$6887
			FDB	$6D0D,$719B,$719B,$7628
			FDB	$7628,$7AB6,$7AB6,$7F3C
			FDB	$7F3C,$83CA,$83CA,$83CA
			FDB	$8857,$8CDE,$8CDE,$8CDE

;-------

F_9C35			LDAB	#$37
			JSR	F_A121
			PSHX
			LDX	#M7846
			LDAB	M0076
			ABX
			LDAB	,X
			ANDB	#$03
			BEQ	Z9C5E
			CMPB	#$03
			BEQ	Z9C5E
			LDAB	,X
			LSRB
			LSRB
			ANDB	#$07
			TBA
			JSR	F_9A2F
			LDAB	#$37
			ABX
			JSR	F_9CF5
			PULX
			BRA	Z9C62
Z9C5E			PULX
			JSR	F_9CF5
Z9C62			PSHB
			LDX	#M780E
			LDAB	M0076
			ASLB
			ABX
			PULB
			STD	,X
			INC	>M0076
			DEC	>M007B
			BNE	Z9C62
			RTS

;-------

F_9C76			LDX	#M784E
			STX	M00A9
			LDX	#M7D13
			STX	M00A7
Z9C80			LDX	M00A9
			LDAA	,X
			BMI	Z9CB3
			JSR	F_9A2F
			LDAA	$39,X
			JSR	F_908B
			PSHX
			LDX	M00A7
			STAA	,X
			PULX
			LDAA	$48,X
			JSR	F_908B
			PSHX
			LDX	M00A7
			STAA	$02,X
			PULX
			LDAA	$4A,X
			JSR	F_908B
			PSHX
			LDX	M00A7
			STAA	$04,X
			PULX
			LDAA	$6D,X
			JSR	F_908B
			LDX	M00A7
			STAA	$06,X
Z9CB3			LDX	M00A7
			INX
			STX	M00A7
			LDX	M00A9
			INX
			STX	M00A9
			CPX	#M7850
			BNE	Z9C80
			LDX	#M7D3B
			STX	M00A7
			CLRA
Z9CC8			PSHA
			JSR	F_9A07
			LDAA	$47,X
			JSR	F_908B
			PSHX
			LDX	M00A7
			STAA	,X
			PULX
			LDAA	$49,X
			JSR	F_908B
			PSHX
			LDX	M00A7
			STAA	$08,X
			PULX
			LDAA	$6C,X
			JSR	F_908B
			LDX	M00A7
			STAA	$10,X
			INX
			STX	M00A7
			PULA
			INCA
			CMPA	#$08
			BNE	Z9CC8
			RTS

;-------

F_9CF5			LDAA	#$63
			SUBA	,X
			TAB
			ANDB	#$70
			LSRB
			LSRB
			LSRB
			LSRB
			SUBB	#$07
			NEGB
			STAB	M0071
			ANDA	#$0F
			ORAA	#$10
			ASLA
			CLRB
Z9D0B			LSRD
			DEC	>M0071
			BNE	Z9D0B
			RTS

;-------

F_9D12			JSR	F_A120
			JSR	F_9AE2
			LDAA	$38,X
			JSR	F_908B
			LDX	#M7D7B
			STX	M00A7
			JMP	Z9AD2
F_9D25			LDAB	M006F
			ASLB
			ASLB
			ASLB
			ABA
			ADDA	M0076
			LDAB	M0072
Z9D2F			SEI
			JSR	OPZ_WAIT
			OPZ_OUT_B
			CLI
			PSHB
			CMPA	#$C0
			BCS	Z9D5D
			CMPA	#$E0
			BCC	Z9D52
			BITB	#$20
			BEQ	Z9D5D
			TAB
			SUBB	#$C0
			LDX	#M77EE
			BRA	Z9D58
Z9D52			TAB
			SUBB	#$E0
			LDX	#M77CE
Z9D58			ABX
			LDAB	M0072
			STAB	,X
Z9D5D			PULB
			INCA
			INC	>M0076
			DEC	>M007B
			BNE	Z9D2F
			RTS

;-------

F_9D68			JSR	F_99EF
			LDAB	$07,X
			LDX	#D_9D89
			ABX
			LDAA	,X
Z9D73			LDX	#M7853
			LDAB	M006F
			ASLB
			ASLB
			ASLB
			ADDB	M0076
			ABX
			STAA	,X
			INC	>M0076
			DEC	>M007B
			BNE	Z9D73
			RTS

D_9D89			FCB	$00,$25,$49,$6E,$92,$B7,$DB,$FF

;-------

F_9D91			LDX	#M7846
			LDAB	M0076
			ABX
			LDAB	,X
			ANDB	#$03
			BEQ	Z9DB7
			CMPB	#$03
			BEQ	Z9DB7
			PSHB
			LDAB	#$3C
			JSR	F_A121
			ASLA
			ASLA
			ASLA
			ASLA
			LDAB	$01,X
			ABA
			PULB
			CMPB	#$02
			BNE	Z9DB8
			ORAA	#$84
			BRA	Z9DB8
Z9DB7			CLRA
Z9DB8			TAB
Z9DB9			LDAA	#$38
			ADDA	M0076
			BSR	Z9DC8
			INC	>M0076
			DEC	>M007B
			BNE	Z9DB9
			RTS
Z9DC8			SEI
			JSR	OPZ_WAIT
			OPZ_OUT_B
			CLI
			RTS
F_9DD7			JSR	F_99EF
			PSHX
			JSR	F_99F9
			TST	,X
			BNE	Z9DE5
			CLRB
			BRA	Z9DEC
Z9DE5			LDAB	#$01
			LDAA	$01,X
			PULX
			BRA	Z9DF8
Z9DEC			PULX
			LDAA	$0C,X
			CMPA	#$03
			BCC	Z9DF6
			COMA
			BRA	Z9DF8
Z9DF6			SUBA	#$03
Z9DF8			ASLA
			ASLA
			ASLA
			ASLA
			TSTB
			BEQ	Z9E03
			LDAB	$0B,X
			BRA	Z9E0B
Z9E03			LDAB	$0B,X
			LDX	#D_9E18
			ABX
			LDAB	,X
Z9E0B			LSRB
			LSRB
			ABA
			ANDA	#$7F
			STAA	M0072
			LDAA	#$40
			JSR	F_9D25
			RTS
D_9E18			FCB	$00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0C,$0A,$0B
			FCB	$10,$0D,$0E,$14,$0F,$11,$18,$12,$13,$1C,$15,$16,$20
			FCB	$19,$17,$24,$1A,$1D,$28,$1B,$1E,$2C,$21,$30,$1F,$22
			FCB	$25,$34,$23,$38,$29,$26,$3C,$2D,$27,$2A,$31,$2E,$2B
			FCB	$35,$32,$2F,$39,$36,$33,$3D,$3A,$37,$3E,$3B,$3F
F_9E58			JSR	F_99F9
			LDAA	$03,X
			ASLA
			ASLA
			ASLA
			ASLA
			ADDA	$02,X
			ORAA	#$80
			STAA	M0072
			LDAA	#$40
			JSR	F_9D25
			RTS
F_9E6D			JSR	F_99F9
			LDAB	$04,X
			ASLB
			ASLB
			ASLB
			ASLB
			ASLB
			ASLB
			PSHB
			LDAB	#$6B
			JSR	F_A121
			PULB
			ABA
			ORAA	#$28
			STAA	M0072
			LDAA	#$C0
			JSR	F_9D25
			RTS
F_9E8A			CLRA
			ORAA	#$28
			STAA	M0072
			LDAA	#$C0
			JSR	F_9D25
			RTS
F_9E95			JSR	F_99EF
			LDAB	$06,X
			ASLB
			ASLB
			ASLB
			ASLB
			ASLB
			ASLB
			ADDB	,X
			PSHB
			JSR	F_99F9
			PULB
			TST	,X
			BEQ	Z9EAF
			ORAB	#$20
			BRA	Z9EB1
Z9EAF			ANDB	#$DF
Z9EB1			STAB	M0072
			LDAA	#$80
			JSR	F_9D25
			RTS
F_9EB9			JSR	F_99EF
			LDAB	$08,X
			RORB
			RORB
			ANDB	#$80
			ADDB	$01,X
			STAB	M0072
			LDAA	#$A0
			JSR	F_9D25
			RTS	
F_9ECC			JSR	F_99EF
			LDAA	$02,X
			LDAB	$0B,X
			LDX	#D_9E18
			ABX
			LDAB	,X
			ANDB	#$03
			ASLB
			ASLB
			ASLB
			ASLB
			ASLB
			ASLB
			ABA
			ANDA	#$DF
			STAA	M0072
			LDAA	#$C0
			JSR	F_9D25
			RTS

;-------

F_9EEC			JSR	F_99EF
			LDAA	$04,X
			COMA
			ASLA
			ASLA
			ASLA
			ASLA
			ADDA	$03,X
			STAA	M0072
			LDAA	#$E0
			JSR	F_9D25
			RTS

;-------

F_9F00			JSR	F_99EF
			LDAA	$05,X
			JSR	F_908B
			STAA	M007C
			LDAB	#$0A
			ABX
			JSR	F_9FD9
			LDX	#M7913
			LDAB	M0076
			ABX
			LDAB	,X
			ANDB	#$07
			SUBB	#$04
			BCS	Z9F2A
			CMPB	#$04
			BCS	Z9F23
			CLRB
Z9F23			JSR	JMPOFFB
			FCB	C_9F32 - *
			FCB	C_9F3C - *
			FCB	C_9F3C - *
			FCB	C_9F45 - *

Z9F2A			LDAB	M006F
			CMPB	#$03
			BNE	Z9F4D
			BRA	Z9F50
C_9F32			LDAB	M006F
			BITB	#$02
			BEQ	Z9F4D
			ADDA	#$08
			BRA	Z9F47
C_9F3C			TST	>M006F
			BEQ	Z9F4D
			ADDA	#$0D
			BRA	Z9F47
C_9F45			ADDA	#$10
Z9F47			BPL	Z9F50
			LDAA	#$7F
			BRA	Z9F50
Z9F4D			ASLA
			BRA	Z9F6E
Z9F50			ASLA
			LDAB	M7772
			ANDB	#$04
			BEQ	Z9F6E
			LDX	#M7933
			LDAB	M0076
			ABX
			TST	,X
			BEQ	Z9F6C
			LDX	#M793B
			LDAB	M0076
			ABX
			LDAB	,X
			BPL	Z9F6E
Z9F6C			LDAA	#$FF
Z9F6E			STAA	M007D
Z9F70			LDX	#M7943
			LDAB	M006F
			LDAA	#$1D
			MUL
			ABX
			STX	M007E
			LDAB	M0076
			LDAA	#$74
			MUL
			ADDD	M007E
			XGDX
			CLRB
Z9F84			PSHB
			PSHX
			LDX	#D_9FBC
			ABX
			LDAA	,X
			PULX
			LDAB	M007C
			MUL
			ADDA	M007D
			BCC	Z9F96
			LDAA	#$FF
Z9F96			STAA	,X
			INX
			PULB
			INCB
			CMPB	#$1D
			BNE	Z9F84
			INC	>M0076
			DEC	>M007B
			BNE	Z9F70
			RTS

;-------

D_9FA8			FCB	$7F,$7A,$76,$72,$6E,$6B
			FCB	$68,$66,$64,$62,$60,$5E
			FCB	$5C,$5A,$58,$56,$55,$54
			FCB	$52,$51

D_9FBC			FCB	$00,$01,$02,$03,$04,$05
			FCB	$06,$07,$08,$09,$0B,$0E
			FCB	$10,$13,$17,$1C,$21,$27
			FCB	$2F,$39,$43,$50,$5F,$71
			FCB	$86,$A0,$BE,$E0,$FF

F_9FD9			LDAB	,X
			CMPB	#$14
			BCS	Z9FE5
			LDAA	#$63
			SUBA	,X
			BRA	Z9FEB
Z9FE5			LDX	#D_9FA8
			ABX
			LDAA	,X
Z9FEB			RTS

;-------

F_9FEC			JSR	F_99EF
			LDAA	$09,X
			BEQ	Z9FFE
			LDAB	#$20
			MUL
			LDAA	$09,X
			ASLA
			ORAA	#$F0
			COMA
			BRA	ZA001
Z9FFE			LDD	#$0000
ZA001			PSHB
			LDX	#M78D3
			LDAB	M006F
			ASLB
			ASLB
			ASLB
			ADDB	M0076
			ABX
			PULB
			STAA	,X
			STAB	$20,X
			INC	>M0076
			DEC	>M007B
			BNE	ZA001
			RTS

;-------

F_A01B			LDAB	#$3E
			JSR	F_A121
			SUBA	#$18
			LDAB	M7772
			ANDB	#$04
			BEQ	ZA041
			LDX	#M793B
			LDAB	M0076
			ABX
			LDAB	,X
			BMI	ZA041
			PSHA
			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			LDAB	$07,X
			SUBB	#$18
			PULA
			ABA
ZA041			LDX	#M791B
			STX	M00A7
			JMP	Z9AD2

;-------

F_A049			LDAB	M7772
			ANDB	#$04
			BEQ	1F
			TST	M6E38
			BEQ	1F
			LDAB	M6AA9
			BRA	2F
1			LDAB	#$42
			JSR	F_A121
2			LDX	#D_A06D
			ABX
			LDAA	,X
			LDX	#M77C6
			STX	M00A7
			JMP	Z9AD2

D_A06D			FCB	$FF,$FE,$F3,$E8,$D3,$CA,$C1,$B9
			FCB	$B2,$AB,$A5,$9F,$99,$93,$8D,$87
			FCB	$82,$7D,$78,$73,$6E,$6A,$66,$62
			FCB	$5E,$5B,$58,$55,$52,$4F,$4C,$4A
			FCB	$48,$46,$44,$42,$40,$3E,$3C,$3A
			FCB	$38,$36,$35,$33,$31,$2F,$2E,$2C
			FCB	$2A,$29,$27,$26,$25,$24,$22,$21
			FCB	$1F,$1E,$1C,$1B,$1A,$19,$18,$17
			FCB	$16,$15,$14,$13,$12,$12,$11,$10
			FCB	$10,$0F,$0E,$0E,$0D,$0D,$0C,$0C
			FCB	$0B,$0B,$0A,$0A,$09,$09,$08,$08
			FCB	$07,$07,$06,$06,$05,$05,$04,$04
			FCB	$03,$03,$02,$01

;-------

F_A0D1			LDAB	#$40
			JSR	F_A121
			LDX	#D_A0E4
			ABX
			LDAA	,X
			LDX	#M7923
			STX	M00A7
			JMP	Z9AD2

D_A0E4			FCB	$00,$10,$21,$31,$41,$51,$61,$71
			FCB	$81,$91,$A2,$B2,$C2

;-------

F_A0F1			LDAB	#$4B
			JSR	F_A121
			SUBA	#$32
			LDX	#M792B
			STX	M00A7
			JMP	Z9AD2

;-------

F_A100			LDAB	#$43
			JSR	F_A121
			JSR	F_908B
			LDX	#M7D1B
			STX	M00A7
			JMP	Z9AD2

;-------

F_A110			LDAB	#$4C
			JSR	F_A121
			JSR	F_908B
			LDX	#M7D33
			STX	M00A7
			JMP	Z9AD2

;-------

F_A120			CLRB
F_A121			LDX	#M6A67
			ABX
			XGDX
			ADDD	M0074
			XGDX
			LDAA	,X
			TAB
			RTS

;-------

HI_CALL_18		LDAB	M7565
			ASLB
			EORB	#$80
			BMI	ZA138
			CLRA
			BRA	ZA13A
ZA138			LDAA	#$FF
ZA13A			ASLD
			STD	M0086
			RTS
			LDAB	#$60
			LDAA	#$FF
			CLC
			RORA
ZA144			SEI
			OPZ_OUT_A
			CLI
			INCB
			CMPB	#$80
			BNE	ZA144
			RTS

F_A155			STAB	M0083
			PSHA
			JSR	F_A354
			PULA
			STAA	M0084
			CLRB
			STAB	M0085
ZA161			LDX	#MA350
			ABX
			LDAB	,X
			LDX	#M776E
			ABX
			LDAA	,X
			ANDA	#$01
			BNE	ZA175
			LDAA	#$FF
			BRA	ZA1B8
ZA175			LDX	#M7943
			LDAB	M0085
			LDAA	#$1D
			MUL
			ABX
			STX	M00DC
			LDAB	M0084
			LDAA	#$74
			MUL
			ADDD	M00DC
			XGDX
			PSHX
			LDX	#M791B
			LDAB	M0084
			ABX
			LDAB	,X
			ADDB	M0083
ZA193			BLT	ZA19D
ZA195			CMPB	#$60
			BCS	ZA1A1
			SUBB	#$0C
			BRA	ZA195
ZA19D			ADDB	#$0C
			BRA	ZA193
ZA1A1			LDX	#MA2F0
			ABX
			LDAB	,X
			SUBB	#$0E
			BCC	ZA1AC
			CLRB
ZA1AC			CMPB	#$70
			BLS	ZA1B2
			LDAB	#$70
ZA1B2			LSRB
			LSRB
			PULX
			ABX
			LDAA	,X
ZA1B8			PSHA
			LDAA	#$08
			LDAB	M0085
			MUL
			ADDB	M0084
			STAB	M0080
			LDX	#M78D3
			ABX
			LDAB	M00F0
			LDAA	$20,X
			MUL
			ADDA	,X
			BCC	ZA1D1
			LDAA	#$FF
ZA1D1			PULB
			ABA
			BCC	ZA1D7
			LDAA	#$FF
ZA1D7			LDAB	M0080
			LDX	#M78A3
			ABX
			STAA	,X
			CMPA	#$FF
			BEQ	ZA1EF
			LDX	#M7873
			LDAB	M0080
			ABX
			ADDA	,X
			BCC	ZA1EF
			LDAA	#$FF
ZA1EF			LSRA
			LDAB	#$60
			ADDB	M0080
			SEI
			OPZ_POLL
			OPZ_OUT_A
			CLI
			LDAB	M0085
			INCB
			STAB	M0085
			CMPB	#$04
			BEQ	ZA210
			JMP	ZA161
ZA210			LDAA	M7772
			ANDA	#$04
			BEQ	ZA223
			TST	M6E38
			BEQ	ZA223
			TIM	#%01000000,M0041
			BEQ	ZA254
			BRA	ZA243
ZA223			LDAA	M0084
			JSR	F_9A07
			LDAA	$3F,X
			BEQ	ZA230
			LDAA	$41,X
			BNE	ZA254
ZA230			LDX	#M793B
			LDAB	M0084
			ABX
			LDAB	,X
			BMI	ZA254
			LDX	#M0041
			ABX
			TIM	#%01000000,$00,X
			BEQ	ZA254
ZA243			LDX	#M77C6
			LDAB	M0084
			ABX
			LDAA	,X
			CMPA	#$FF
			BEQ	ZA254
			LDX	#M7D03
			BRA	ZA257
ZA254			LDX	#M7CF3
ZA257			LDAB	M0084
			ASLB
			ABX
			LDD	,X
			STD	M00DC
			LDD	M0086
			PSHB
			LDX	#M78C3
			LDAB	M0084
			ASLB
			ABX
			PULB
			ADDD	,X
			BVC	ZA278
			BCS	ZA275
			LDD	#$7FFF
			BRA	ZA278
ZA275			LDD	#$0000
ZA278			LDX	#M77B6
			PSHB
			TST	>M0084
			BNE	ZA28D
			LDAB	M7846
			ANDB	#$03
			CMPB	#$03
			BEQ	ZA28D
			PULB
			BRA	ZA2A0
ZA28D			LDAB	M0084
			ASLB
			ABX
			PULB
			ADDD	,X
			BVC	ZA2A0
			BCS	ZA29D
			LDD	#$7FFF
			BRA	ZA2A0
ZA29D			LDD	#$0000
ZA2A0			ADDD	M00DC
ZA2A2			BLT	ZA2AC
ZA2A4			CMPA	#$60
			BCS	ZA2B0
			SUBA	#$0C
			BRA	ZA2A4
ZA2AC			ADDA	#$0C
			BRA	ZA2A2
ZA2B0			PSHB
			LDX	#MA2F0
			TAB
			ABX
			LDAA	,X
			PULB
			ANDB	#$FC
			STD	M0081
			LDAA	#$28
			ADDA	M0084
			LDAB	M0081
			SEI
			OPZ_POLL
			OPZ_OUT_B
			ADDA	#$08
			LDX	#M7933
			LDAB	M0084
			ABX
			LDAB	,X
			ANDB	#$01
			ORAB	M0082
			OPZ_POLL
			OPZ_OUT_B
			CLI
			RTS

MA2F0			FCB	$00,$01,$02,$04,$05,$06,$08,$09,$0A,$0C,$0D,$0E,$10
			FCB	$11,$12,$14,$15,$16,$18,$19,$1A,$1C,$1D,$1E,$20,$21
			FCB	$22,$24,$25,$26,$28,$29,$2A,$2C,$2D,$2E,$30,$31,$32
			FCB	$34,$35,$36,$38,$39,$3A,$3C,$3D,$3E,$40,$41,$42,$44
			FCB	$45,$46,$48,$49,$4A,$4C,$4D,$4E,$50,$51,$52,$54,$55
			FCB	$56,$58,$59,$5A,$5C,$5D,$5E,$60,$61,$62,$64,$65,$66
			FCB	$68,$69,$6A,$6C,$6D,$6E,$70,$71,$72,$74,$75,$76,$78
			FCB	$79,$7A,$7C,$7D,$7E

MA350			FCB	$03,$01,$02,$00

F_A354			TAB
			LDX	#M7846
			ABX
			LDAB	,X
			ANDB	#$03
			BEQ	ZA36C
			CMPB	#$03
			BCC	ZA36C
			DECB
			LDX	#M7850
			ABX
			LDAB	,X
			BPL	ZA36D
ZA36C			TAB
ZA36D			STAB	M0084
			ASLB
			LDX	#M780E
			ABX
			LDD	,X
			SUBD	#$1300
			BEQ	ZA38F
			LDX	#M7796
			LDAB	M0084
			ASLB
			ABX
			PSHX
			LDX	#M77A6
			ABX
			LDD	#$0000
			STD	,X
			PULX
			STD	,X
ZA38F			RTS

F_A390			LDAB	#$07
			STAB	M0097
ZA394			LDX	#M793B
			LDAB	M0097
			ABX
			LDAB	,X
			BPL	ZA3A4
			LDD	#$0000
			JMP	ZA461
ZA3A4			LDX	#M7D83
			ABX
			LDAB	,X
			CMPB	#$80
			BNE	ZA3B3
ZA3AE			LDD	#$0000
			BRA	ZA3FE
ZA3B3			LSRB
			LDX	#MA4B8
			ABX
			LDAA	,X
			ASLA
			EORA	#$80
			STAA	M008C
			LDX	#M7923
			LDAB	M0097
			ABX
			LDAB	,X
			BEQ	ZA3AE
			LDAA	M008C
			CMPB	#$C2
			BNE	ZA3E7
			TSTA
			BMI	ZA3DB
			CMPA	#$7E
			BNE	ZA3E7
			LDD	#$0C00
			BRA	ZA3F7
ZA3DB			NEGA
			LDAB	#$C0
			MUL
			COMA
			COMB
			INCB
			BCC	ZA3F4
			INCA
			BRA	ZA3F4
ZA3E7			TSTA
			BMI	ZA3EE
			ASLA
			MUL
			BRA	ZA3F3
ZA3EE			COMA
			ASLA
			MUL
			COMB
			COMA
ZA3F3			LSRD
ZA3F4			LSRD
			LSRD
			LSRD
ZA3F7			TST	>M008C
			BPL	ZA3FE
			ORAA	#$F0
ZA3FE			STD	M0089
			LDX	#M792B
			LDAB	M0097
			ABX
			LDAB	,X
			BNE	ZA40F
			LDD	#$0000
			BRA	ZA45F
ZA40F			STAB	M008D
			PSHB
			LDX	#M793B
			LDAB	M0097
			ABX
			LDAB	,X
			BPL	ZA41F
			CLRA
			BRA	ZA42D
ZA41F			LDX	#M7D5B
			ABX
			LDAA	,X
			BNE	ZA42D
			PULB
			LDD	#$0000
			BRA	ZA45F
ZA42D			PULB
			CMPB	#$32
			BEQ	ZA436
			CMPB	#$31
			BNE	ZA43F
ZA436			CMPA	#$FE
			BCS	ZA442
			LDD	#$C000
			BRA	ZA456
ZA43F			TSTB
			BMI	ZA447
ZA442			BSR	F_A47E
			MUL
			BRA	ZA456
ZA447			NEGB
			CMPB	#$31
			BCC	ZA475
ZA44C			BSR	F_A47E
			MUL
ZA44F			COMA
			COMB
			ADDD	#DDR2
			BEQ	ZA45F
ZA456			LSRD
			LSRD
			TST	>M008D
			BPL	ZA45F
			ORAA	#$C0
ZA45F			ADDD	M0089
ZA461			PSHB
			LDX	#M78C3
			LDAB	M0097
			ASLB
			ABX
			PULB
			STD	,X
			DEC	>M0097
			BMI	ZA474
			JMP	ZA394
ZA474			RTS
ZA475			CMPA	#$FE
			BCS	ZA44C
			LDD	#$C000
			BRA	ZA44F

F_A47E			LDX	#MA485
			ABX
			LDAB	,X
			RTS

MA485			FCB	$00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0A,$0B,$0C
			FCB	$0D,$0F,$11,$14,$17,$1A,$1C,$1F,$23,$27,$2A,$2E,$32
			FCB	$36,$3A,$3E,$43,$48,$4E,$52,$58,$5D,$62,$69,$6E,$75
			FCB	$7B,$81,$88,$8E,$95,$9C,$A4,$AB,$B3,$BB,$C2,$C2

MA4B8			FCB	$00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0A,$0B,$0C
			FCB	$0D,$0E,$0F,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19
			FCB	$1A,$1B,$1C,$1D,$1E,$1F,$20,$21,$22,$23,$24,$25,$26
			FCB	$27,$28,$2A,$2B,$2C,$2D,$2E,$2F,$30,$31,$32,$33,$34
			FCB	$35,$36,$37,$38,$39,$3A,$3B,$3C,$3D,$3E,$3F,$40,$40
			FCB	$40,$41,$42,$43,$44,$45,$46,$47,$48,$49,$4A,$4B,$4C
			FCB	$4D,$4E,$4F,$50,$51,$52,$53,$54,$55,$56,$58,$59,$5A
			FCB	$5B,$5C,$5D,$5E,$5F,$60,$61,$62,$63,$64,$65,$66,$67
			FCB	$68,$69,$6A,$6B,$6C,$6D,$6E,$6F,$70,$71,$72,$73,$74
			FCB	$75,$76,$77,$78,$79,$7A,$7B,$7C,$7D,$7E,$7F

F_A538			LDX	#M7D01
			LDAB	#$07
			STAB	M0097
ZA53F			PSHX
			LDAA	M7772
			ANDA	#$04
			BEQ	ZA553
			TST	M6E38
			BEQ	ZA553
			TIM	#%01000000,M0041
			BNE	ZA578
			BRA	ZA573
ZA553			LDAA	M0097
			JSR	F_9A07
			TST	$3F,X
			BEQ	ZA560
			TST	$41,X
			BNE	ZA578
ZA560			LDX	#M793B
			LDAB	M0097
			ABX
			LDAB	,X
			BMI	ZA573
			LDX	#M0041
			ABX
			TIM	#%01000000,$00,X
			BNE	ZA578
ZA573			PULX
			LDD	,X
			BRA	ZA5B9
ZA578			PULX
			LDD	,X
			STD	M0098
			SUBD	$10,X
			BEQ	ZA5B7
			BPL	ZA5A7
			BSR	F_A59A
			BEQ	ZA5B7
			NEGA
			LSRA
			LSRA
			INCA
			MUL
			STD	M0095
			LDD	$10,X
			SUBD	M0095
			XGDX
			CPX	M0098
			XGDX
			BCC	ZA5B9
			BRA	ZA5B7

F_A59A			PSHX
			LDX	#M77C6
			LDAB	M0097
			ABX
			LDAB	,X
			PULX
			CMPB	#$FF
			RTS
ZA5A7			BSR	F_A59A
			BEQ	ZA5B7
			LSRA
			LSRA
			INCA
			MUL
			ADDD	$10,X
			XGDX
			CPX	M0098
			XGDX
			BCS	ZA5B9
ZA5B7			LDD	M0098
ZA5B9			STD	$10,X
			PSHX
			LDD	M0086
			PSHB
			LDX	#M78C3
			LDAB	M0097
			ASLB
			ABX
			PULB
			ADDD	,X
			LDX	#M77B6
			PSHB
			TST	>M0097
			BNE	ZA5DE
			LDAB	M7846
			ANDB	#$03
			CMPB	#$03
			BEQ	ZA5DE
			PULB
			BRA	ZA5F1
ZA5DE			LDAB	M0097
			ASLB
			ABX
			PULB
			ADDD	,X
			BVC	ZA5F1
			BCS	ZA5EE
			LDD	#$7FFF
			BRA	ZA5F1
ZA5EE			LDD	#$0000
ZA5F1			PULX
			ADDD	$10,X
ZA5F4			BLT	ZA5FE
ZA5F6			CMPA	#$60
			BCS	ZA602
			SUBA	#$0C
			BRA	ZA5F6
ZA5FE			ADDA	#$0C
			BRA	ZA5F4
ZA602			PSHB
			PSHX
			LDX	#MA2F0
			TAB
			ABX
			LDAA	,X
			PULX
			PULB
			ANDB	#$FC
			STD	M0081
			LDAA	#$28
			ADDA	M0097
			LDAB	M0081
			SEI
			SPIN3
			OPZ_OUT_B
			ADDA	#$08
			PSHX
			LDX	#M7933
			LDAB	M0097
			ABX
			LDAB	,X
			PULX
			ANDB	#$01
			ORAB	M0082
			OPZ_POLL
			OPZ_OUT_B
			CLI
			DEX
			DEX
			DEC	>M0097
			BMI	ZA64C
			JMP	ZA53F
ZA64C			RTS

F_A64D			CLR	>M0097
ZA650			LDAB	M0097
			ASLB
			LDX	#M7796
			ABX
			PSHX
			LDX	#M780E
			ABX
			LDD	,X
			PULX
			ADDD	,X
			BCC	ZA666
			LDD	#$FFFF
ZA666			STD	,X
			ADDD	#DDR2
			BNE	ZA685
			LDAB	M0097
			ASLB
			LDX	#M77A6
			ABX
			PSHX
			LDX	#M780E
			ABX
			LDD	,X
			PULX
			ADDD	,X
			BCC	ZA683
			LDD	#$FFFF
ZA683			STD	,X
ZA685			INC	>M0097
			LDAA	M0097
			CMPA	#$08
			BNE	ZA650
			RTS

F_A68F			CLR	>M0097
			TST	>M0091
			BEQ	ZA69B
			LDAA	#$04
			STAA	M0097
ZA69B			LDX	#M7D1B
			LDAB	M0097
			ABX
			LDAA	$18,X
			PSHX
			LDX	#M793B
			LDAB	M0097
			ABX
			LDAB	,X
			BPL	ZA6B2
			PULX
			JMP	ZA75D
ZA6B2			STAB	M0093
			LDX	#M7D5B
			ABX
			STX	M0089
			LDAB	,X
			PULX
			MUL
			STAA	M00F4
			LDAA	$18,X
			SUBA	M00F4
			STAA	$08,X
			LDAA	,X
			PSHX
			LDX	M0089
			LDAB	$08,X
			PULX
			MUL
			STAA	$10,X
			LDAA	,X
			SUBA	$10,X
			PSHX
			LDX	M0089
			ADDA	$10,X
			PULX
			BCC	ZA6DF
			LDAA	#$FF
ZA6DF			COMA
			TAB
			PSHX
			LDX	#MA82B
			ABX
			LDAA	,X
			LDAB	M776D
			COMB
			LDX	#MA82B
			ABX
			ADDA	,X
			BCC	ZA6F8
			LDAA	#$FF
			BRA	ZA712
ZA6F8			LDAB	M776B
			ANDB	#$02
			BEQ	ZA712
			LDX	#M7753
			LDAB	M0093
			ABX
			LDAB	,X
			COMB
			LDX	#MA82B
			ABX
			ADDA	,X
			BCC	ZA712
			LDAA	#$FF
ZA712			PULX
			STAA	$10,X
			LDAB	$08,X
			COMB
			LDX	#MA82B
			ABX
			TAB
			CLRA
			ADDB	,X
			ROLA
			XGDX
			STX	M0093
			LDX	#M7893
			LDAB	M0097
			ASLB
			ABX
			LDD	,X
			PSHA
			PSHB
			LDD	M0093
			STD	,X
			PULB
			PULA
			SUBD	M0093
			BEQ	ZA75D
			BCC	ZA740
			COMA
			COMB
			ADDD	#DDR2
ZA740			XGDX
			CPX	#$0020
			BCS	ZA749
			CLRA
			BRA	ZA750
ZA749			XGDX
			LDX	#MA92B
			ABX
			LDAA	,X
ZA750			LDAB	M0097
			SEI
			OPZ_OUT_A
			CLI
ZA75D			INC	>M0097
			LDAB	M0097
			ANDB	#$03
			BEQ	ZA769
			JMP	ZA69B
ZA769			LDAB	#$03
			STAB	M0088
			STAB	M0097
			TST	>M0091
			BNE	ZA77C
			COM	>M0091
			CLR	>M0092
			BRA	ZA783
ZA77C			CLR	>M0091
			LDAB	#$04
			STAB	M0092
ZA783			LDAB	M0088
			ASLB
			ASLB
			ASLB
			ADDB	M0097
			ADDB	M0092
			STAB	M0090
			LDX	#M7853
			LDAB	M0090
			ABX
			LDAA	,X
			LDX	#M7D23
			LDAB	M0097
			ADDB	M0092
			ABX
			LDAB	,X
			MUL
			COMA
			LDX	#MA82B
			TAB
			ABX
			LDAA	,X
			LDX	#M7913
			LDAB	M0097
			ADDB	M0092
			ABX
			LDAB	,X
			ANDB	#$07
			SUBB	#$04
			BCS	ZA7C3
			BEQ	ZA7CB
			CMPB	#$03
			BCS	ZA7D2
			BRA	ZA7D7
ZA7C1			BRA	ZA783
ZA7C3			LDAB	M0088
			CMPB	#$03
			BNE	ZA7E5
			BRA	ZA7D7
ZA7CB			TIM	#%00000010,M0088
			BEQ	ZA7E5
			BRA	ZA7D7
ZA7D2			TST	>M0088
			BEQ	ZA7E5
ZA7D7			LDX	#M7D2B
			LDAB	M0097
			ADDB	M0092
			ABX
			ADDA	,X
			BCC	ZA7E5
			LDAA	#$FF
ZA7E5			LDX	#M7873
			LDAB	M0090
			ABX
			STAA	,X
			LDX	#M78A3
			LDAB	M0090
			ABX
			ADDB	#$60
			PSHA
			ADDA	,X
			BCC	ZA7FC
			LDAA	#$FF
ZA7FC			PSHA
			LDAA	M776B
			ANDA	#$02
			PULA
			BEQ	ZA80D
			TST	M7767
			BEQ	ZA80D
			CLC
			BRA	ZA80E
ZA80D			SEC
ZA80E			RORA
			SEI
			OPZ_OUT_A
			CLI
			PULA
			DEX
			DEC	>M0097
			BPL	ZA7C1
			LDAB	#$03
			STAB	M0097
			DEC	>M0088
			BPL	ZA7C1
			RTS

MA82B			FCB	$FF,$FF,$E0,$CD,$C0,$B5,$AD,$A6,$A0,$9A,$95,$91,$8D
			FCB	$89,$86,$82,$80,$7D,$7A,$78,$75,$73,$71,$6F,$6D,$6B
			FCB	$69,$67,$66,$64,$62,$61,$60,$5E,$5D,$5B,$5A,$59,$58
			FCB	$56,$55,$54,$53,$52,$51,$50,$4F,$4E,$4D,$4C,$4B,$4A
			FCB	$49,$48,$47,$46,$46,$45,$44,$43,$42,$42,$41,$40,$40
			FCB	$3F,$3E,$3D,$3D,$3C,$3B,$3B,$3A,$39,$39,$38,$38,$37
			FCB	$36,$36,$35,$35,$34,$33,$33,$32,$32,$31,$31,$30,$30
			FCB	$2F,$2F,$2E,$2E,$2D,$2D,$2C,$2C,$2B,$2B,$2A,$2A,$2A
			FCB	$29,$29,$28,$28,$27,$27,$26,$26,$26,$25,$25,$24,$24
			FCB	$24,$23,$23,$22,$22,$22,$21,$21,$21,$20,$20,$20,$1F
			FCB	$1F,$1E,$1E,$1E,$1D,$1D,$1D,$1C,$1C,$1C,$1B,$1B,$1B
			FCB	$1A,$1A,$1A,$19,$19,$19,$18,$18,$18,$18,$17,$17,$17
			FCB	$16,$16,$16,$15,$15,$15,$15,$14,$14,$14,$13,$13,$13
			FCB	$13,$12,$12,$12,$12,$11,$11,$11,$11,$10,$10,$10,$10
			FCB	$0F,$0F,$0F,$0F,$0E,$0E,$0E,$0E,$0D,$0D,$0D,$0D,$0C
			FCB	$0C,$0C,$0C,$0B,$0B,$0B,$0B,$0A,$0A,$0A,$0A,$09,$09
			FCB	$09,$09,$08,$08,$08,$08,$08,$07,$07,$07,$07,$06,$06
			FCB	$06,$06,$06,$05,$05,$05,$05,$05,$04,$04,$04,$04,$04
			FCB	$03,$03,$03,$03,$03,$02,$02,$02,$02,$02,$02,$01,$01
			FCB	$01,$01,$01,$00,$00,$00,$00,$00,$00

MA92B			FCB	$30,$30,$30,$20,$1C,$1B,$1A,$19,$18,$17,$16,$15,$14
			FCB	$13,$12,$11,$10,$0F,$0E,$0D,$0C,$09,$09,$09,$09,$08
			FCB	$08,$08,$08,$06,$04,$02

F_A94B			TST	>M0091
			BNE	ZA953
			CLRB
			BRA	ZA955
ZA953			LDAB	#$01
ZA955			STAB	M0097
			LDX	#M7D15
			LDAB	M0097
			ABX
			LDAA	,X
			LDAB	M7850
			BEQ	ZA977
			CMPB	#$FF
			BEQ	ZA977
			TST	>M0097
			BNE	ZA972
			LDAB	M784F
			BRA	ZA984
ZA972			LDAB	M784E
			BRA	ZA984
ZA977			TST	>M0097
			BNE	ZA981
			LDAB	M784E
			BRA	ZA984
ZA981			LDAB	M784F
ZA984			LDX	#M7D53
			ABX
			STAB	M0089
			LDAB	,X
			MUL
			STAA	M00F2
			LDX	#M7D17
			LDAB	M0097
			ABX
			LDAA	,X
			LDX	#M7D5B
			LDAB	M0089
			ABX
			LDAB	,X
			MUL
			STAA	M00F3
			LDX	#M7D19
			LDAB	M0097
			ABX
			LDAA	,X
			LDX	#M7D63
			LDAB	M0089
			ABX
			LDAB	,X
			MUL
			STAA	M00F5
			LDAA	M00F2
			ADDA	M00F3
			BCS	ZA9BF
			ADDA	M00F5
			BCC	ZA9C1
ZA9BF			LDAA	#$FF
ZA9C1			PSHA
			LDX	#M7D13
			LDAB	M0097
			ABX
			LDAA	,X
			LDX	#M7850
			LDAB	M0097
			ABX
			LDAB	,X
			BMI	ZA9DC
			LDX	#M77A6
			ABX
			LDAB	,X
			BRA	ZA9DD
ZA9DC			CLRB
ZA9DD			MUL
			PULB
			ABA
			BCC	ZA9E4
			LDAA	#$FF
ZA9E4			TAB
			COMB
			LDX	#MA82B
			ABX
			LDAA	,X
			LDX	#M7850
			LDAB	M0097
			ABX
			LDAB	,X
			BMI	ZAA02
			LDX	#M7873
			ABX
			ADDA	,X
			BCC	ZAA00
			LDAA	#$FF
ZAA00			SUBA	,X
ZAA02			LSRA
			TST	>M0097
			BNE	ZAA0C
			LDAB	#$19
			BRA	ZAA0E
ZAA0C			LDAB	#$17
ZAA0E			SEI
			OPZ_OUT_A
			CLI
			RTS

F_AA1A			TST	>M0091
			BNE	ZAA24
			CLR	>M0092
			BRA	ZAA28
ZAA24			LDAB	#$04
			STAB	M0092
ZAA28			CLR	>M0097
ZAA2B			LDX	#M793B
			LDAB	M0097
			ADDB	M0092
			ABX
			LDAB	,X
			BMI	ZAA6F
			LDX	#M7D53
			ABX
			STX	M0089
			LDX	#M7D3B
			LDAB	M0097
			ADDB	M0092
			ABX
			LDAA	,X
			PSHX
			LDX	M0089
			LDAB	,X
			PULX
			MUL
			STAA	$38,X
			LDAA	$10,X
			PSHX
			LDX	M0089
			LDAB	$10,X
			PULX
			MUL
			PSHA
			LDAA	$08,X
			PSHX
			LDX	M0089
			LDAB	$08,X
			PULX
			MUL
			PULB
			ABA
			BCS	ZAA6B
			ADDA	$38,X
			BCC	ZAA6D
ZAA6B			LDAA	#$FF
ZAA6D			STAA	$38,X
ZAA6F			INC	>M0097
			LDAB	M0097
			CMPB	#$04
			BNE	ZAA2B
			TST	>M0091
			BNE	ZAA82
			CLR	>M0097
			BRA	ZAA86
ZAA82			LDAB	#$01
			STAB	M0097
ZAA86			LDX	#M7D7B
			TST	>M0097
			BNE	ZAA93
			LDAB	M7850
			BRA	ZAA96
ZAA93			LDAB	M7851
ZAA96			BPL	ZAA9B
			CLRA
			BRA	ZAADD
ZAA9B			ABX
			LDAA	,X
			LDX	#M77A6
			ASLB
			ABX
			LDAB	,X
			MUL
			LDAB	M7850
			BEQ	ZAABE
			CMPB	#$FF
			BEQ	ZAABE
			TST	>M0097
			BNE	ZAAB9
			LDAB	M784F
			BRA	ZAACB
ZAAB9			LDAB	M784E
			BRA	ZAACB
ZAABE			TST	>M0097
			BNE	ZAAC8
			LDAB	M784E
			BRA	ZAACB
ZAAC8			LDAB	M784F
ZAACB			BMI	ZAADD
			LDX	#M7EF1
			ABX
			LDAB	,X
			LDX	#M7D73
			ABX
			ADDA	,X
			BCC	ZAADD
			LDAA	#$FF
ZAADD			LSRA
			ORAA	#$80
			TST	>M0097
			BNE	ZAAE9
			LDAB	#$19
			BRA	ZAAEB
ZAAE9			LDAB	#$17
ZAAEB			SEI
			OPZ_OUT_A
			CLI
			RTS

F_AAF7			CLR	>M0097
ZAAFA			LDAB	M0097
			BEQ	ZAB0A
			LDX	#M7846
			ABX
			LDAA	,X
			ANDA	#$03
			CMPA	#$03
			BNE	ZAB77
ZAB0A			LDX	#M7836
			ASLB
			ABX
			PSHX
			LDD	,X
			LDX	#M781E
			PSHB
			LDAB	M0097
			ASLB
			ABX
			PULB
			ADDD	,X
			PULX
			STD	,X
			ASLD
			BCC	ZAB24
			COMA
ZAB24			TST	>M0097
			BNE	ZAB2C
			STAA	M776A
ZAB2C			ADDA	#$80
			PSHA
			LDX	#M7D73
			LDAB	M0097
			ABX
			LDAA	$08,X
			ADDA	,X
			BEQ	ZAB76
			BCC	ZAB3F
			LDAA	#$FF
ZAB3F			LDX	#M77A6
			LDAB	M0097
			ASLB
			ABX
			LDAB	,X
			MUL
			TAB
			PULA
			TSTA
			BMI	ZAB51
			MUL
			BRA	ZAB58
ZAB51			NEGA
			MUL
			COMA
			COMB
			ADDD	#DDR2
ZAB58			TAB
			BMI	ZAB5E
			CLRA
			BRA	ZAB60
ZAB5E			LDAA	#$FF
ZAB60			LDX	#M77B6
			PSHB
			LDAB	M0097
			ASLB
			ABX
			PULB
			ASLD
			STD	,X
			LDAA	M0097
			INCA
			STAA	M0097
			CMPA	#$08
			BNE	ZAAFA
			RTS
ZAB76			PULA
ZAB77			LDD	#$0000
			BRA	ZAB60

			INCLUDE	"inc/jmpoff.asm"

F_AB9E			CMPB	#$0D
			BEQ	ZABC2
			CMPB	#$0E
			BEQ	ZABC2
			LDAA	#$01
			STAA	M009A
			LDAA	M776D
			LSRA
			CMPB	#$0B
			BEQ	ZABB9
			CMPA	#$7F
			BEQ	ZABBD
			INCA
			BRA	ZABBD
ZABB9			TSTA
			BEQ	ZABBD
			DECA
ZABBD			ASLA
			STAA	M776D
ZABC1			RTS
ZABC2			CLR	>M009A
			BRA	ZABC1

F_ABC7			TST	>M00AE
			BNE	ZABDD
			LDAB	M7772
			ANDB	#$04
			BNE	ZABD8
			TST	M7793
			BNE	ZABDD
ZABD8			CLR	>M006E
			BRA	ZAC19
ZABDD			LDAB	M7772
			ANDB	#$03
			LDAA	M006E
			INCA
			ANDA	#$3F
			STAA	M006E
			BEQ	ZAC05
			CMPA	#$20
			BNE	ZAC19
			TST	>M00AE
			BNE	ZAC1A
			TSTB
			BEQ	ZAC00
			CMPB	#$01
			BNE	ZAC19
			AIM	#%10111111,PORT6
			BRA	ZAC19
ZAC00			AIM	#%01111111,PORT6
			BRA	ZAC19
ZAC05			TST	>M00AE
			BNE	ZAC23
			TSTB
			BEQ	ZAC16
			CMPB	#$01
			BNE	ZAC19
			OIM	#%01000000,PORT6
			BRA	ZAC19
ZAC16			OIM	#%10000000,PORT6
ZAC19			RTS
ZAC1A			CMPB	#$02
			BNE	ZAC19
			AIM	#%11011111,PORT6
			BRA	ZAC19
ZAC23			CMPB	#$02
			BNE	ZAC19
			OIM	#%00100000,PORT6
			DEC	>M00AE
			BRA	ZAC19

ZAC2F			JSR	JMPOFF1
			FCB	ZAC48 - *
			FCB	$01
			FCB	JAC45 - *
			FCB	$04
			FCB	JAC41 - *
			FCB	$06
			FCB	JAC3C - *
			FCB	$0B
			FCB	ZAC48 - *
			FCB	$00

JAC3C			COMB
			SUBB	#$F0
			BRA	ZAC48
JAC41			SUBB	#$03
			BRA	ZAC48
JAC45			COMB
			SUBB	#$F2
ZAC48			TST	>M00A3
			BEQ	ZAC58
			CMPB	M00A0
			BEQ	ZAC58
			CMPB	#$0D
			BCC	ZAC5A
			CLRB
			BRA	ZAC5A
ZAC58			STAB	M00A0
ZAC5A			CLR	>M00A1
			CLR	>M00A2
			CLR	>M00A3
			RTS
HI_CALL_17		LDAA	PORT2
			COMA
			ANDA	#$E0
			LSRA
			LSRA
			LSRA
			LSRA
			LSRA
			STAA	M009D
			LDAA	PORT5
			COMA
			ANDA	#$F2
			LSRA
			CLR	>M009E
			LSRA
			BCC	ZAC7F
			OIM	#%00000100,M009E
ZAC7F			ASLA
			ORAA	M009D
			STAA	M009D
			LDAA	PORT6
			COMA
			ANDA	#$07
			LSRA
			BCC	ZAC8F
			OIM	#%10000000,M009D
ZAC8F			ORAA	M009E
			STAA	M009E
			CLRB
			LDX	#M009B
			LDAA	M009D
			CMPA	,X
			BNE	ZACA8
			INX
			INCB
			LDAA	M009E
			CMPA	,X
			BNE	ZACA8
			JMP	ZAD0C
ZACA8			CMPB	#$01
			BNE	ZACBF
			PSHA
			EORA	,X
			ANDA	#$04
			PULA
			BEQ	ZACBF
			STAA	,X
			LDAB	#$03
			BITA	#$04
			BNE	ZAC48
			INCB
			BRA	ZAC48
ZACBF			ASLB
			ASLB
			ASLB
			PSHB
			EORA	,X
			BEQ	ZAD0C
			BITA	,X
			BNE	ZACE6
			CLR	>M0071
ZACCE			INC	>M0071
			LSRA
			BCC	ZACCE
			PULB
			ADDB	M0071
			CLRA
			SEC
ZACD9			ROLA
			DEC	>M0071
			BNE	ZACD9
			ORAA	,X
			STAA	,X
			JMP	ZAC2F
ZACE6			ANDA	,X
			TAB
			EORA	,X
			STAA	,X
			PULA
			TSTA
			BNE	ZAD0C
			ANDB	#$06
			BEQ	ZAD0C
			CMPB	#$06
			BEQ	ZAD07
			BITB	#$02
			BEQ	ZAD02
			LDAB	#$0D
			JMP	ZAC48
ZAD02			LDAB	#$0E
			JMP	ZAC48
ZAD07			AIM	#%11111011,$00,X
			BRA	ZAD02
ZAD0C			LDAB	M00A0

			JSR	JMPOFF1
			FCB	ZAD20 - *
			FCB	$01
			FCB	JAD24 - *
			FCB	$03
			FCB	ZAD20 - *
			FCB	$08
			FCB	JADEF - *
			FCB	$0A
			FCB	JAD1D - *
			FCB	$0C
			FCB	ZAD20 - *
			FCB	$00

JAD1D			JMP	ZAE50
ZAD20			CLRB
			JMP	ZAC48
JAD24			TBA
			LDAB	M7772
			CMPB	#$02
			BEQ	ZAD30
			CMPB	#$06
			BNE	ZAD33
ZAD30			JMP	ZADB6
ZAD33			CMPB	#$09
			BCS	ZAD3B
			CMPB	#$12
			BCS	ZADB6
ZAD3B			LDAB	M7774

			JSR	JMPOFF1
			FCB	ZADB6 - *
			FCB	$02
			FCB	JAD75 - *
			FCB	$05
			FCB	ZADB6 - *
			FCB	$07
			FCB	JAD75 - *
			FCB	$08
			FCB	ZADB6 - *
			FCB	$09
			FCB	JAD75 - *
			FCB	$0B
			FCB	ZAD65 - *
			FCB	$14
			FCB	ZADB6 - *
			FCB	$15
			FCB	JAD83 - *
			FCB	$16
			FCB	ZAD65 - *
			FCB	$19
			FCB	JAD75 - *
			FCB	$1B
			FCB	JAD67 - *
			FCB	$1C
			FCB	JADAA - *
			FCB	$1D
			FCB	ZAD65 - *
			FCB	$1F
			FCB	ZADB6 - *
			FCB	$20
			FCB	ZAD65 - *
			FCB	$28
			FCB	ZADB6 - *
			FCB	$36
			FCB	ZAD65 - *
			FCB	$00

ZAD65			BRA	ZAD20
JAD67			LDAB	M7788
			CMPB	#$02
			BNE	ZAD65
			TST	>M00A4
			BNE	ZAD65
			BRA	ZADB6
JAD75			LDAB	M7788
			CMPB	#$01
			BNE	ZAD65
			TST	>M00A4
			BNE	ZAD65
			BRA	ZADB6
JAD83			LDAB	M7788
			CMPB	#$01
			BEQ	ZAD9C
			CMPB	#$02
			BNE	ZAD65
			TST	>M00A4
			BNE	ZAD65
			LDAB	M7789
			CMPB	#$0C
			BNE	ZAD65
			BRA	ZADB6
ZAD9C			TST	>M00A4
			BNE	ZAD65
			LDAB	M7789
			CMPB	#$08
			BCS	ZADB6
			BRA	ZAD65
JADAA			LDAB	M7788
			CMPB	#$02
			BNE	ZAD65
			TST	>M00A4
			BNE	ZAD65
ZADB6			CMPA	#$02
			BEQ	ZADDE
			TIM	#%00001000,M009B
			BEQ	ZAD65
			LDAB	#$01
ZADC1			LDX	M00A1
			INX
			STX	M00A1
			TST	>M00A3
			BNE	ZADE7
			CPX	#$0100
			BCC	ZADD3
			JMP	ZAE88
ZADD3			LDAA	#$01
			STAA	M00A3
ZADD7			CLR	>M00A1
			CLR	>M00A2
			RTS
ZADDE			TIM	#%00010000,M009B
			BEQ	ZAD65
			LDAB	#$02
			BRA	ZADC1
ZADE7			CPX	#$0002
			BCC	ZADD7
			JMP	ZAE88
JADEF			TST	>M00A4
			BNE	ZAE62
			CMPB	#$09
			BEQ	ZAE01
			TIM	#%01000000,M009B
			BEQ	ZAE62
			LDAB	#$08
			BRA	ZAE08
ZAE01			TIM	#%00100000,M009B
			BEQ	ZAE62
			LDAB	#$09
ZAE08			LDAA	M7772
			BNE	ZAE2F
			LDAA	M7788
			CMPA	#$02
			BNE	ZAE2F
			LDAA	M7774
			CMPA	#$15
			BNE	ZAE24
			LDAA	M7789
			CMPA	#$0C
			BNE	ZAE2F
			BRA	ZADC1
ZAE24			CMPA	#$1C
			BNE	ZAE2F
			LDAA	M7789
			CMPA	#$02
			BEQ	ZADC1
ZAE2F			LDX	M00A1
			INX
			STX	M00A1
			TST	>M00A3
			BNE	ZAE49
			CPX	#$0100
			BCS	ZAE88
			LDAA	#$01
			STAA	M00A3
ZAE42			CLR	>M00A1
			CLR	>M00A2
			RTS
ZAE49			CPX	#M0045
			BCS	ZAE88
			BRA	ZAE42
ZAE50			CMPB	#$0B
			BEQ	ZAE5D
			TIM	#%00000100,M009B
			BEQ	ZAE62
			LDAB	#$0A
			BRA	ZAE67
ZAE5D			TIM	#%00000010,M009B
			BNE	ZAE65
ZAE62			JMP	ZAD65
ZAE65			LDAB	#$0B
ZAE67			LDX	M00A1
			INX
			STX	M00A1
			TST	>M00A3
			BNE	ZAE81
			CPX	#$0100
			BCS	ZAE88
			LDAA	#$01
			STAA	M00A3
ZAE7A			CLR	>M00A1
			CLR	>M00A2
			RTS
ZAE81			CPX	#$0004
			BCS	ZAE88
			BRA	ZAE7A
ZAE88			CLRB
			RTS

F_AE8A			STX	M00A7
F_AE8C			LDX	M00A9
			LDAA	,X
			INX
			STX	M00A9
			LDX	M00A7
			STAA	,X
			INX
			STX	M00A7
			DECB
			BNE	F_AE8C
			RTS
LO_CALL_06		STX	M00A7
			LDAB	#$06
			STAB	XROM
			JSR	XROM_CALL
			RTS
LO_CALL_00		STX	M00A7
			CLRB
			STAB	XROM
			JSR	XROM_CALL
			RTS
LO_CALL_08		LDAB	#$08
			STAB	XROM
			JSR	XROM_CALL
			RTS
LO_CALL_0A		LDAB	#$0A
			STAB	XROM
			JSR	XROM_CALL
			RTS
LO_CALL_09		LDAB	#$09
			STAB	XROM
			JSR	XROM_CALL
			RTS
LO_CALL_07		STX	M00A7
			LDAB	#$07
			STAB	XROM
			JSR	XROM_CALL
			RTS

F_AED3			STX	M00A7
			LDAB	#$05
			STAB	XROM
			JSR	XROM_CALL
			RTS

F_AEDD			LDAB	M7773
F_AEE0			CMPB	#$A0
			BCC	ZAEF1
			CMPB	#$20
			BCC	ZAEF5
			LDAA	#$4E
			MUL
			ADDD	#USER_VOICE
ZAEEE			XGDX
			BRA	ZAEF4
ZAEF1			LDX	#INIT_VOICE
ZAEF4			RTS
ZAEF5			SUBB	#$20
			LDAA	#$4E
			MUL
			ADDD	#$D1C0
			BRA	ZAEEE

F_AEFF			LDAB	M7779
			CMPB	#$18
			BCC	ZAF0F
			LDAA	#$4C
			MUL
			ADDD	#USER_PFM
			XGDX
			BRA	ZAF12
ZAF0F			LDX	#D_MODE_SINGLE
ZAF12			RTS

D_MODE_SINGLE		FCB	$68,$00,$20,$00,$7F,$07,$18,$63,$60,$00,$41,$00,$7F
			FCB	$07,$18,$63,$60,$00,$62,$00,$7F,$07,$18,$63,$60,$00
			FCB	$63,$00,$7F,$07,$18,$63,$60,$00,$64,$00,$7F,$07,$18
			FCB	$63,$60,$00,$65,$00,$7F,$07,$18,$63,$60,$00,$66,$00
			FCB	$7F,$07,$18,$63,$60,$00,$67,$00,$7F,$07,$18,$63,$00
			FCB	$00
			FCC	"SINGLE    "

F_AF5F			LDAB	M777B
F_AF62			LDAA	#$0D
F_AF64			LDX	#MA350
			ABX
			LDAB	,X
			MUL
			BSR	F_AF6F
			ABX
			RTS

F_AF6F			XGDX
			LDAB	M778B
			LDAA	#$6E
			MUL
			ADDD	#M6A67
			XGDX
			RTS

F_AF7B			LDAA	M7772
			ANDA	#$07
			BEQ	ZAF92
			CMPA	#$03
			BEQ	ZAF92
			BCS	ZAF8D
			CMPA	#$07
			BEQ	ZAF92
			DECA
ZAF8D			ADDB	#$05
			DECA
			BNE	ZAF8D
ZAF92			CMPB	#$1E
			BCS	ZAF97
			CLRB
ZAF97			CLR	>M00AE

			JSR	JMPOFFB
			FCB	ZAFF9 - *
			FCB	JB00C - *
			FCB	ZAFDF - *
			FCB	F_B082 - *
			FCB	F_B09A - *
			FCB	JAFE0 - *
			FCB	JB00C - *
			FCB	JB066 - *
			FCB	JB016 - *
			FCB	JB09E - *
			FCB	JAFF0 - *
			FCB	JB00C - *
			FCB	JB06E - *
			FCB	F_B084 - *
			FCB	JAFD3 - *
			FCB	ZAFF9 - *
			FCB	JB00C - *
			FCB	ZAFDF - *
			FCB	JAFC7 - *
			FCB	JAFC1 - *
			FCB	ZAFF9 - *
			FCB	JB00C - *
			FCB	JAFCD - *
			FCB	JAFBE - *
			FCB	JAFC4 - *
			FCB	JAFBB - *
			FCB	JB00C - *
			FCB	JAFD0 - *
			FCB	JAFCA - *
			FCB	F_AFD9 - *

JAFBB			JMP	ZB127
JAFBE			JMP	ZB1AE
JAFC1			JMP	F_B164
JAFC4			JMP	ZB168
JAFC7			JMP	HI_CALL_14
JAFCA			JMP	ZB14E
JAFCD			JMP	ZB133
JAFD0			JMP	ZB136
JAFD3			JSR	F_C94D
			JMP	ZB179

F_AFD9			JSR	F_C94D
			JMP	ZB0C0
ZAFDF			RTS
JAFE0			TST	M7793
			BNE	ZB00B
			LDAA	M777B
			STAA	M777C
			CLR	>M0059
			BRA	ZAFF9
JAFF0			LDAA	M7773
			STAA	M777F
			CLR	>M00A5
ZAFF9			LDAA	M756D
			ANDA	#$01
			INCA
			ASLA
			ASLA
			ASLA
			ORAA	M7772
			STAA	M7772
ZB008			JSR	F_E10E
ZB00B			RTS
JB00C			LDAA	#$07
			ANDA	M7772
			STAA	M7772
			BRA	ZB008
JB016			LDAA	M7792
			BEQ	ZAFDF
			TST	M7793
			BNE	ZB045
			LDAA	#$07
			ANDA	M7772
			STAA	M7772
			LDAA	#$01
			STAA	M7793
			JSR	F_E10E
			TST	M756E
			BNE	ZB042
			LDAB	#$01
			STAB	M756E
			JSR	F_B774
			CLR	M756E
			BRA	ZB00B
ZB042			JMP	F_B774
ZB045			CLR	M7793
			JSR	F_E10E
			TST	M756E
			BNE	ZB05D
			LDAB	#$01
			STAB	M756E
			JSR	F_C2BC
			CLR	M756E
			BRA	ZB060
ZB05D			JSR	F_C2BC
ZB060			LDX	M7781
			JMP	F_E10C
JB066			TST	M7793
			BNE	ZB0BF
			JSR	F_B115
JB06E			CLR	M7772
			LDAA	#$FF
			STAA	M7790
			CLR	>M009A
			JSR	F_E10E
			LDAB	M7775
			JMP	F_B1DD

F_B082			BSR	F_B0EA
F_B084			LDAA	#$01
			STAA	M7772
			LDAA	#$FF
			STAA	M7790
			CLR	>M009A
			JSR	F_E10E
			LDAB	M7776
			JMP	F_B1DD

F_B09A			BSR	F_B0EA
			BRA	ZB0A5
JB09E			TST	M7793
			BNE	ZB0BF
			BSR	F_B115
ZB0A5			LDAA	#$02
			STAA	M7772
			CLR	M778C
			CLR	M7790
			LDD	#$0101
			STD	M776E
			STD	M7770
			JSR	F_E10F
			JSR	F_E10E
ZB0BF			RTS
ZB0C0			LDAA	#$02
			STAA	M7772
			CLR	M778C
			CLR	M7790
			JSR	F_E10E
			LDX	#M69C1
			TST	M756E
			BNE	ZB0E3
			LDAB	#$01
			STAB	M756E
			JSR	F_B7A2
			CLR	M756E
			BRA	ZB0E6
ZB0E3			JSR	F_B7A2
ZB0E6			JSR	F_C7C2
			RTS

F_B0EA			LDAA	M7774
			CMPA	#$1F
			BCC	ZB0F5
			CMPA	#$14
			BCC	ZB0F7
ZB0F5			LDAA	#$14
ZB0F7			STAA	M7775
			CLR	>M00A6
			CLR	M7788
			CLR	M778C
			CMPA	#$19
			BCS	ZB114
			CMPA	#$1C
			BCC	ZB114
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			JSR	F_91FE
ZB114			RTS

F_B115			LDAA	M7774
			CMPA	#$0B
			BCS	ZB11D
			CLRA
ZB11D			STAA	M7776
			CLR	M7788
			CLR	M778C
			RTS
ZB127			LDAA	M7779
			STAA	M777A
			CLR	>M00A5
			JMP	ZAFF9
ZB133			JSR	F_B1C6
ZB136			LDAA	#$04
			STAA	M7772
			LDAA	#$FF
			STAA	M7790
			CLR	>M009A
			JSR	F_E10E
			LDAB	M7777
			JMP	F_B1DD
HI_CALL_14		BSR	F_B1AF
ZB14E			LDAA	#$05
			STAA	M7772
			LDAA	#$FF
			STAA	M7790
			CLR	>M009A
			JSR	F_E10E
			LDAB	M7778
			JMP	F_B1DD

F_B164			BSR	F_B1AF
			BRA	ZB16A
ZB168			BSR	F_B1C6
ZB16A			LDAA	#$06
			STAA	M7772
			CLR	M778C
			CLR	M7790
			JSR	F_E10E
			RTS
ZB179			LDAA	#$06
			STAA	M7772
			CLR	M778C
			CLR	M7790
			JSR	F_E10E
			LDX	#M6A67
			STX	M00A9
			LDX	#M69C1
			JSR	LO_CALL_06
			TST	M756E
			BNE	ZB1A4
			LDAB	#$01
			STAB	M756E
			JSR	F_B805
			CLR	M756E
			BRA	ZB1A7
ZB1A4			JSR	F_B805
ZB1A7			JSR	ME383_via_cvec_d38d
			JSR	F_C7C2
			RTS
ZB1AE			RTS

F_B1AF			LDAA	M7774
			CMPA	#$3F
			BCC	ZB1BA
			CMPA	#$3C
			BCC	ZB1BC
ZB1BA			LDAA	#$3C
ZB1BC			STAA	M7777
			CLR	M7788
			CLR	M778C
			RTS

F_B1C6			LDAA	M7774
			CMPA	#$36
			BCC	ZB1D1
			CMPA	#$28
			BCC	ZB1D3
ZB1D1			LDAA	#$28
ZB1D3			STAA	M7778
			CLR	M7788
			CLR	M778C
			RTS

F_B1DD			PSHB
			JSR	F_B6BB
			PULB
			LDAA	#$01
			STAA	M7787
			TST	M7788
			BEQ	ZB1EF
			JMP	ZB339
ZB1EF			TBA

			JSR	JMPOFF1
			FCB	JB227 - *
			FCB	$01
			FCB	JB242 - *
			FCB	$02
			FCB	ZB2B4 - *
			FCB	$05
			FCB	JB26F - *
			FCB	$07
			FCB	ZB2B4 - *
			FCB	$08
			FCB	JB26F - *
			FCB	$09
			FCB	ZB2B4 - *
			FCB	$0B
			FCB	ZB223 - *
			FCB	$14
			FCB	JB2B8 - *
			FCB	$15
			FCB	ZB2B4 - *
			FCB	$16
			FCB	JB29D - *
			FCB	$18
			FCB	ZB2B4 - *
			FCB	$1F
			FCB	JB2A1 - *
			FCB	$20
			FCB	ZB223 - *
			FCB	$28
			FCB	JB2D7 - *
			FCB	$33
			FCB	JB30A - *
			FCB	$34
			FCB	JB2D7 - *
			FCB	$35
			FCB	JB224 - *
			FCB	$36
			FCB	ZB223 - *
			FCB	$3C
			FCB	JB2B2 - *
			FCB	$3D
			FCB	ZB2B4 - *
			FCB	$3E
			FCB	JB299 - *
			FCB	$3F
			FCB	ZB223 - *
			FCB	$46
			FCB	ZB2B4 - *
			FCB	$00

ZB223			RTS
JB224			JMP	ZB326
JB227			STAB	M7774
			LDAB	M778C
			BEQ	ZB23F
			DECB
ZB230			STAB	M777B
ZB233			LDX	#M776E
			ABX
			STX	M7781
			LDAB	#$01
			JMP	ZB2CB
ZB23F			CLRB
			BRA	ZB245
JB242			STAB	M7774
ZB245			ASLB
			LDX	#MB61E
ZB249			ABX
			LDD	,X
ZB24C			STAB	M7783
			TAB
			CMPB	#$6E
			BCS	ZB256
			ANDB	#$7F
ZB256			STAB	M7787
			JSR	F_AF6F
			STX	M7784
			ABX
			TSTA
			BPL	ZB266
			JSR	F_B690
ZB266			STX	M7781
			CLR	>M00A5
			JMP	ZB560
JB26F			STAB	M7774
			LDAB	M778C
			CMPB	#$04
			BCS	F_B284
			CLRB
			JSR	F_B284
			LDAB	M778C
			SUBB	#$04
			BRA	ZB230

F_B284			STAB	M777B
			JSR	F_E110
			LDAB	M7774
			CMPB	#$08
			BEQ	ZB295
			SUBB	#$03
			BRA	ZB245
ZB295			LDAB	#$04
			BRA	ZB245
JB299			LDAA	#$02
			BRA	ZB2BA
JB29D			SUBA	#$14
			BRA	ZB2BA
JB2A1			STAB	M7774
			LDX	#M7740
			LDAB	M778C
			ABX
			STX	M7781
			LDAB	#$7F
			BRA	ZB2CB
JB2B2			BRA	ZB2B4
ZB2B4			LDAA	#$01
			BRA	ZB2BA
JB2B8			SUBA	#$14
ZB2BA			STAB	M7774
ZB2BD			LDAB	#$03
			MUL
			LDX	#MB5E5
			ABX
			LDD	,X
			STD	M7781
			LDAB	$02,X
ZB2CB			STAB	M7783
			CLR	M777E
			CLR	>M00A5
			JMP	ZB560
JB2D7			LDAA	M778C
			STAA	M7786
ZB2DD			STAB	M7774
			SUBB	#$28
ZB2E2			ASLB
			LDX	#MB672
			ABX
			LDD	,X
ZB2E9			STAB	M7783
			TAB
			CMPB	#$6E
			BCS	ZB2F3
			ANDB	#$7F
ZB2F3			STAB	M7787
			LDX	#M6DD7
			ABX
			TSTA
			BMI	ZB300
			JMP	ZB266
ZB300			LDAB	M7786
			LDAA	#$0C
			MUL
			ABX
			JMP	ZB266
JB30A			LDAA	M778C
			BEQ	ZB2DD
			CMPA	#$01
			BNE	ZB31A
			STAB	M7774
			LDAB	#$0E
			BRA	ZB2E2
ZB31A			SUBA	#$02
			STAA	M7786
			STAB	M7774
			LDAB	#$0D
			BRA	ZB2E2
ZB326			STAB	M7774
			LDAA	M778C
			CMPA	#$0A
			BCS	ZB333
			JMP	ZB223
ZB333			ADDA	#$64
			LDAB	#$7F
			BRA	ZB2E9

ZB339			JSR	JMPOFF1
			FCB	ZB37F - *
			FCB	$02
			FCB	JB380 - *
			FCB	$03
			FCB	JB38A - *
			FCB	$04
			FCB	JB3EC - *
			FCB	$05
			FCB	ZB37F - *
			FCB	$07
			FCB	JB43F - *
			FCB	$08
			FCB	ZB37F - *
			FCB	$09
			FCB	JB37C - *
			FCB	$0A
			FCB	JB379 - *
			FCB	$0B
			FCB	ZB37F - *
			FCB	$15
			FCB	JB376 - *
			FCB	$16
			FCB	ZB37F - *
			FCB	$18
			FCB	JB373 - *
			FCB	$19
			FCB	JB367 - *
			FCB	$1A
			FCB	JB36A - *
			FCB	$1B
			FCB	JB36D - *
			FCB	$1C
			FCB	JB370 - *
			FCB	$1D
			FCB	ZB37F - *
			FCB	$1F
			FCB	JB364 - *
			FCB	$20
			FCB	ZB37F - *
			FCB	$00

JB364			JMP	ZB551
JB367			JMP	ZB4EC
JB36A			JMP	ZB4F7
JB36D			JMP	ZB502
JB370			JMP	ZB51F
JB373			JMP	ZB4EA
JB376			JMP	ZB4BE
JB379			JMP	ZB48E
JB37C			JMP	ZB46E
ZB37F			RTS
JB380			LDAB	M7789
ZB383			ASLB
			LDX	#MB628
			JMP	ZB249
JB38A			LDAB	M7789
			BNE	ZB39F
			LDAB	M778C
			BEQ	F_B3C3
			CLRB
			JSR	F_B3C3
			LDAB	M778C
			DECB
			JMP	ZB230
ZB39F			CMPB	#$01
			BEQ	ZB3C7
			LDAB	M778C
			CMPB	#$04
			BCS	F_B3B6
			CLRB
			JSR	F_B3B6
			LDAB	M778C
			SUBB	#$04
			JMP	ZB230

F_B3B6			STAB	M777B
			JSR	F_E110
			LDAB	M7789
			ADDB	#$07
			BRA	ZB383

F_B3C3			LDAB	#$06
			BRA	ZB383
ZB3C7			LDAB	M778C
			BEQ	ZB3E8
			CMPB	#$05
			BCS	F_B3DC
			CLRB
			JSR	F_B3DC
			LDAB	M778C
			SUBB	#$05
			JMP	ZB230

F_B3DC			SUBB	#$01
			STAB	M777B
			JSR	F_E110
			LDAB	#$08
			BRA	ZB383
ZB3E8			LDAB	#$07
			BRA	ZB383
JB3EC			JSR	F_B6A8
			STAA	M777B
			PSHB
			JSR	F_E110
			PULA
			TSTA
			BEQ	ZB426
			LDAB	M778C
			BEQ	ZB43B
			CMPB	#$02
			BCS	F_B40F
			CLRB
			JSR	F_B40F
			LDAB	M778C
			SUBB	#$02
			JMP	ZB233

F_B40F			CMPA	#$02
			BNE	F_B436
			JSR	F_AF5F
			LDAA	#$D9
			TIM	#%00111100,$0B,X
			BNE	ZB421
			LDAB	#$07
			BRA	ZB423
ZB421			LDAB	#$0F
ZB423			JMP	ZB24C
ZB426			LDAB	M778C
			BEQ	F_B436
			CLRB
			JSR	F_B436
			LDAB	M778C
			DECB
			JMP	ZB233

F_B436			ADDA	#$0B
			TAB
			BRA	ZB46B
ZB43B			LDAB	#$0D
			BRA	ZB46B
JB43F			LDAB	M778C
			LDAA	M7789
			CMPA	#$05
			BNE	ZB450
			TSTB
			BNE	ZB450
			INCB
			STAB	M778C
ZB450			CMPB	#$04
			BCS	F_B460
			CLRB
			JSR	F_B460
			LDAB	M778C
			SUBB	#$04
			JMP	ZB230

F_B460			STAB	M777B
			JSR	F_E110
			LDAB	M7789
			ADDB	#$0E
ZB46B			JMP	ZB383
ZB46E			LDAB	M778C
			CMPB	#$04
			BCS	F_B481
			CLRB
			JSR	F_B481
			LDAB	M778C
			SUBB	#$04
			JMP	ZB230

F_B481			STAB	M777B
			JSR	F_E110
			LDAB	M7789
			ADDB	#$14
			BRA	ZB46B
ZB48E			LDAB	M7789
			CMPB	#$0F
			BCC	ZB4AD
			CMPB	#$02
			BNE	ZB4A9
			JSR	F_AF6F
			TST	$3F,X
			BNE	ZB4A5
			LDAA	#$01
			JMP	ZB2BD
ZB4A5			LDAB	#$18
			BRA	ZB46B
ZB4A9			ADDB	#$16
			BRA	ZB46B
ZB4AD			LDAA	M778C
			CMPA	#$0A
			BCS	ZB4B7
			JMP	ZB37F
ZB4B7			ADDA	#$4D
			LDAB	#$7F
			JMP	ZB24C
ZB4BE			LDAA	M7788
			CMPA	#$02
			BCC	ZB4D5
			LDAA	M7789
			CMPA	#$08
			BCC	ZB4D0
			ADDA	#$04
			BRA	ZB4D2
ZB4D0			LDAA	#$01
ZB4D2			JMP	ZB2BD
ZB4D5			LDAA	M7789
			CMPA	#$0C
			BEQ	ZB4DF
			JMP	ZB37F
ZB4DF			LDAB	M778A
			LDX	#M7571
			ABX
			LDAB	#$B7
			BRA	ZB54B
ZB4EA			BRA	ZB4D0
ZB4EC			LDAA	M7789
			CMPA	#$04
			BCC	ZB4D0
			ADDA	#$0C
			BRA	ZB4D2
ZB4F7			LDAA	M7789
			CMPA	#$03
			BCC	ZB4D0
			ADDA	#$10
			BRA	ZB4D2
ZB502			LDAA	M7788
			CMPA	#$01
			BEQ	ZB4D0
			LDAA	M7789
			CMPA	#$0C
			BCS	ZB511
			CLRA
ZB511			LDAB	#$04
			MUL
			ADDB	M778C
			LDX	#M75F8
			ABX
			LDAB	#$31
			BRA	ZB54B
ZB51F			LDAA	M7788
			CMPA	#$01
			BEQ	ZB52F
			LDAA	M7789
			BEQ	ZB539
			CMPA	#$02
			BEQ	ZB534
ZB52F			JSR	HI_CALL_03
			BRA	ZB4D0
ZB534			LDX	#M7640
			BRA	ZB53C
ZB539			LDX	#M7628
ZB53C			LDAB	M778A
			ASLB
			ABX
			LDAB	#$6C
			TST	M778C
			BEQ	ZB54B
			LDAB	#$3F
			INX
ZB54B			STX	M7781
			JMP	ZB2CB
ZB551			LDX	#M7740
			LDAB	M778C
			ABX
			STX	M7781
			LDAB	#$7F
			JMP	ZB2CB
ZB560			LDX	M7781

F_B563			LDAA	M7783
			CMPA	,X
			BCC	ZB56C
			CLR	,X
ZB56C			LDAA	M7774
			CMPA	#$1F
			BEQ	ZB5A3
			CMPA	#$35
			BEQ	ZB5A3
			CMPA	#$0A
			BEQ	ZB595
			CMPA	#$07
			BEQ	ZB585
			CMPA	#$1C
			BEQ	ZB5C4
			BRA	ZB5AD
ZB585			LDAB	M7788
			CMPB	#$01
			BNE	ZB5AD
			LDAA	M7789
			CMPA	#$04
			BEQ	ZB5B4
			BRA	ZB5AD
ZB595			LDAB	M7788
			CMPB	#$01
			BNE	ZB5AD
			LDAA	M7789
			CMPA	#$0F
			BNE	ZB5AD
ZB5A3			LDAA	#$1F
			CMPA	,X
			BCS	ZB5AD
			LDAA	#$24
			STAA	,X
ZB5AD			LDX	M7781
			JSR	F_E10C
			RTS
ZB5B4			LDAA	M778C
			CMPA	#$04
			BCC	ZB5AD
			TST	,X
			BNE	ZB5AD
			OIM	#%00000001,$00,X
			BRA	ZB5AD
ZB5C4			LDAB	M7788
			CMPB	#$02
			BNE	ZB5AD
			LDAB	M7789
			BEQ	ZB5D4
			CMPB	#$02
			BNE	ZB5AD
ZB5D4			TST	M778C
			BNE	ZB5AD
			LDAA	#$0C
			CMPA	,X
			BCS	ZB5AD
			LDAA	#$0D
			STAA	,X
			BRA	ZB5AD
MB5E5			FDB	M7565
			FCB	$7F
			FDB	M7570
			FCB	$01
			FDB	M756D
			FCB	$01
			FDB	M756E
			FCB	$01
			FDB	M7566
			FCB	$10
			FDB	M7567
			FCB	$0F
			FDB	M7568
			FCB	$02
			FDB	M7569
			FCB	$11
			FDB	M756F
			FCB	$01
			FDB	M756A
			FCB	$11
			FDB	M756B
			FCB	$02
			FDB	M756C
			FCB	$01
			FDB	M75F1
			FCB	$7F
			FDB	M75F2
			FCB	$30
			FDB	M75F3
			FCB	$07
			FDB	M75F4
			FCB	$63
			FDB	M75F5
			FCB	$02
			FDB	M75F6
			FCB	$01
			FDB	M75F7
			FCB	$63

MB61E			FDB	$3407,$3507,$DA07,$8C06,$8A63

MB628			FDB	$3B03,$3663,$3763,$3863,$3963,$3A01,$3C07,$3D03
			FDB	$8801,$8707,$8907,$D807,$8B3F,$D701,$801F,$811F
			FDB	$840F,$821F,$830F,$DB03,$8603,$8563,$3F01,$400C
			FDB	$4101,$4263,$4363,$6C63,$6D63,$4763,$4863,$4963
			FDB	$4A63,$4B64,$4C63,$3E30,$6B07

MB672			FDB	$6101,$8008,$829F,$8310,$847F,$857F,$860E,$8730
			FDB	$8863,$8903,$8A03,$600C,$6203,$8B01,$630B

F_B690			LDAB	M777B
			PSHX
			LDX	#MA350
			ABX
			LDAB	,X
			PULX
			CMPA	#$D7
			BCS	ZB6A3
			LDAA	#$05
			BRA	ZB6A5
ZB6A3			LDAA	#$0D
ZB6A5			MUL
			ABX
			RTS

F_B6A8			LDAB	M7789
			CLRA
ZB6AC			SUBB	#$03
			BMI	ZB6B3
			INCA
			BRA	ZB6AC
ZB6B3			ADDB	#$03
			CMPA	#$04
			BCS	ZB6BA
			CLRA
ZB6BA			RTS

F_B6BB			LDAA	M778C
			LDAB	M7788
			BEQ	ZB6CA
			CMPB	#$01
			BEQ	ZB6EE
			JMP	ZB724
ZB6CA			LDAB	M7774

			JSR	JMPOFF1
			FCB	ZB742 - *
			FCB	$01
			FCB	JB773 - *
			FCB	$05
			FCB	ZB752 - *
			FCB	$07
			FCB	JB773 - *
			FCB	$08
			FCB	ZB752 - *
			FCB	$09
			FCB	JB773 - *
			FCB	$1F
			FCB	JB76A - *
			FCB	$20
			FCB	JB773 - *
			FCB	$29
			FCB	ZB752 - *
			FCB	$33
			FCB	JB762 - *
			FCB	$34
			FCB	JB773 - *
			FCB	$35
			FCB	JB762 - *
			FCB	$36
			FCB	JB773 - *
			FCB	$3C
			FCB	ZB752 - *
			FCB	$3D
			FCB	JB773 - *
			FCB	$00

ZB6EE			LDAB	M7774

			JSR	JMPOFF1
			FCB	JB773 - *
			FCB	$03
			FCB	JB706 - *
			FCB	$04
			FCB	JB711 - *
			FCB	$05
			FCB	JB773 - *
			FCB	$07
			FCB	ZB752 - *
			FCB	$08
			FCB	JB773 - *
			FCB	$09
			FCB	ZB752 - *
			FCB	$0A
			FCB	JB762 - *
			FCB	$0B
			FCB	JB773 - *
			FCB	$00

JB706			LDAB	M7789
			BEQ	ZB742
			CMPB	#$02
			BCS	ZB75A
			BRA	ZB752
JB711			LDAB	M7789
			BEQ	ZB742
			CMPB	#$03
			BEQ	ZB742
			CMPB	#$06
			BEQ	ZB742
			CMPB	#$09
			BEQ	ZB742
			BRA	ZB74A
ZB724			LDAB	M7774

			JSR	JMPOFF1
			FCB	JB773 - *
			FCB	$1B
			FCB	JB73A - *
			FCB	$1C
			FCB	JB732 - *
			FCB	$1D
			FCB	JB773 - *
			FCB	$00

JB732			CMPA	#$01
			BLS	ZB770
			LDAA	#$01
			BRA	ZB770
JB73A			CMPA	#$03
			BLS	ZB770
			LDAA	#$03
			BRA	ZB770
ZB742			CMPA	#$04
			BLS	ZB770
			LDAA	#$04
			BRA	ZB770
ZB74A			CMPA	#$05
			BLS	ZB770
			LDAA	#$05
			BRA	ZB770
ZB752			CMPA	#$07
			BLS	ZB770
			LDAA	#$07
			BRA	ZB770
ZB75A			CMPA	#$08
			BLS	ZB770
			LDAA	#$08
			BRA	ZB770
JB762			CMPA	#$09
			BLS	ZB770
			LDAA	#$09
			BRA	ZB770
JB76A			CMPA	#$0F
			BLS	ZB770
			LDAA	#$0F
ZB770			STAA	M778C
JB773			RTS

F_B774			AIM	#~ECMI,TCSR3
			LDX	#M6A67
			STX	M00A9
			LDX	#M6A19
			JSR	LO_CALL_06
			BRA	ZB79F

F_B784			JSR	F_E0A4
F_B787			CMPB	M7773
			BNE	F_B796
			TST	M7792
			BNE	F_B796
			JSR	F_E178
			BRA	ZB7C2

F_B796			AIM	#~ECMI,TCSR3
			JSR	HI_CALL_19
			CLR	M7793
ZB79F			JSR	F_AEDD

F_B7A2			STX	M00A9
			AIM	#~ECMI,TCSR3
			LDX	#M6A67
			JSR	LO_CALL_00
			JSR	LO_CALL_08
			JSR	F_E178
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_91FE
			OIM	#ECMI,TCSR3
ZB7C2			RTS

F_B7C3			PSHB
			ADDB	#$20
			JSR	F_E0A4
			PULB
			CMPB	M7779
			BNE	F_B7D6
			TST	M7791
			BNE	F_B7D6
			BRA	ZB804

F_B7D6			AIM	#~ECMI,TCSR3
			STAB	M7779
			CLR	M7791
			JSR	F_AEFF
			STX	M00A9
			AIM	#~ECMI,TCSR3
			LDX	#M6DD7
			JSR	F_AED3
HI_CALL_13		JSR	ME383_via_cvec_d38d
			JSR	LO_CALL_0A
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C7C2
			OIM	#ECMI,TCSR3
			BSR	F_B805
ZB804			RTS

F_B805			AIM	#~ECMI,TCSR3
			BSR	F_B820
			JSR	LO_CALL_08
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			JSR	F_91FE
			JSR	HI_CALL_15
			JSR	HI_CALL_16
			OIM	#ECMI,TCSR3
			RTS

F_B820			CLRB
ZB821			PSHB
			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			LDAB	$02,X
			JSR	F_AEE0
			STX	M00A9
			PULA
			PSHA
			JSR	F_9A2F
			JSR	LO_CALL_00
			PULB
			INCB
			CMPB	#$08
			BNE	ZB821
			RTS

F_B83F			LDAB	M7795
			STAB	M7773
			CLR	M7792
			CLR	M7793
			LDX	#M6A67
			STX	M00A9
			JSR	F_AEDD
			JSR	LO_CALL_06
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			JSR	F_91FE
			JMP	ZE113

F_B862			LDAA	M777F
			CMPA	#$20
			BCS	ZB86A
			CLRA
ZB86A			STAA	M00A9
			LDAA	#$1F
ZB86E			STAA	M00A7
			DECB
			TST	M7795
			BMI	ZB87E
			LDAA	M7795
			JSR	F_8D0C
			BRA	ZB880
ZB87E			LDAA	M00A9
ZB880			STAA	M7795
			RTS

F_B884			LDAA	M777A
			STAA	M00A9
			LDAA	#$17
			BRA	ZB86E

F_B88D			LDAB	M7795
			STAB	M7779
			CLR	M7791
			LDX	#M6DD7
			STX	M00A9
			JSR	F_AEFF
			JSR	LO_CALL_07
			JSR	HI_CALL_00
			JMP	HI_CALL_01

F_B8A7			LDAB	M7794
			JSR	F_AF62
			STX	M00A7
			LDAB	M777C
			JSR	F_AF62
			STX	M00A9
			LDAB	#$07
			JSR	F_AE8C
			LDAB	#$01
			STAB	M7792
			LDX	#F_9E95
			JSR	F_92DB
			LDX	#F_9EB9
			JSR	F_92DB
			LDX	#F_9ECC
			JSR	F_92DB
			LDX	#F_9EEC
			JSR	F_92DB
			LDX	#F_9F00
			JSR	F_92DB
			JSR	F_E114
			RTS

F_B8E3			DECB
			TST	>M0059
			BNE	ZB8F8
			LDAA	#$03
			STAA	M00A7
			LDAA	M777C
			JSR	F_8D0C
			STAA	M777C
			BRA	ZB90D
ZB8F8			TST	M7794
			BMI	ZB909
			LDAA	#$03
			STAA	M00A7
			LDAA	M7794
			JSR	F_8D0C
			BRA	ZB90A
ZB909			CLRA
ZB90A			STAA	M7794
ZB90D			RTS

F_B90E			AIM	#~ECMI,TCSR3
			LDAB	#$6E
			LDX	#M6A67
			STX	M00A9
			LDX	#M6AD5
			JSR	F_AE8A
			JSR	LO_CALL_08
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			JSR	F_91FE
			JSR	F_C7C2
			OIM	#ECMI,TCSR3
			RTS

F_B931			TST	M7788
			BEQ	ZB939
			JMP	ZBA42
ZB939			TBA
			LDAB	M7774

			JSR	JMPOFF1
			FCB	JB971 - *
			FCB	$02
			FCB	JB97B - *
			FCB	$04
			FCB	JB974 - *
			FCB	$05
			FCB	JB971 - *
			FCB	$07
			FCB	JB9B7 - *
			FCB	$08
			FCB	JB971 - *
			FCB	$09
			FCB	JB9BE - *
			FCB	$0A
			FCB	JB9BB - *
			FCB	$0B
			FCB	JB971 - *
			FCB	$15
			FCB	JB9C2 - *
			FCB	$16
			FCB	JB971 - *
			FCB	$18
			FCB	JB9C9 - *
			FCB	$19
			FCB	JB9D0 - *
			FCB	$1A
			FCB	JB9DE - *
			FCB	$1B
			FCB	JB9D0 - *
			FCB	$1C
			FCB	JB9F0 - *
			FCB	$1D
			FCB	JB9F7 - *
			FCB	$1F
			FCB	JB971 - *
			FCB	$3C
			FCB	JBA10 - *
			FCB	$3D
			FCB	JBA19 - *
			FCB	$3E
			FCB	JB971 - *
			FCB	$46
			FCB	JB96E - *
			FCB	$47
			FCB	JB971 - *
			FCB	$00

JB96E			JMP	ZBBB1
JB971			TAB
			CLC
			RTS
JB974			PSHB
			LDAB	#$01
			STAB	M778C
			PULB
JB97B			SUBB	#$02
ZB97D			CMPA	#$01
			BNE	ZB9B5
			LDX	#MBBE4
			ABX
			LDAB	,X
			STAB	M778D
			STAA	M7788
			STAA	M00A4
			CLR	M7789
			LDAB	M7774
			CMPB	#$04
			BNE	ZB9A6
			JSR	F_AF6F
			TST	$66,X
			BNE	ZB9A3
			INC	M7789
ZB9A3			LDAB	M7774
ZB9A6			JSR	F_B1DD
			AIM	#~ECMI,TCSR3
			JSR	HI_CALL_15
			JSR	HI_CALL_16
			OIM	#ECMI,TCSR3
ZB9B5			SEC
			RTS
JB9B7			LDAB	#$03
			BRA	ZB97D
JB9BB			CLR	M778C
JB9BE			SUBB	#$05
			BRA	ZB97D
JB9C2			CLR	M777E
			LDAB	#$06
			BRA	ZB97D
JB9C9			CLR	M777E
			LDAB	#$07
			BRA	ZB97D
JB9D0			SUBB	#$11
			PSHB
			PSHA
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			PULA
			PULB
			BRA	ZB97D
JB9DE			SUBB	#$11
			CMPA	#$01
			BNE	ZB9B5
			STAA	M7788
			PSHB
			JSR	F_B90E
			PULB
			LDAA	#$01
			BRA	ZB97D
JB9F0			CLR	M778F
			SUBB	#$11
			BRA	ZB97D
JB9F7			TST	>M00A5
			BEQ	ZBA08
			CLR	>M00A5
			CMPA	#$01
			BNE	ZBA0E
			JSR	F_C274
			BRA	ZBA0E
ZBA08			CMPA	#$01
			BNE	ZBA0E
			STAA	M00A5
ZBA0E			SEC
			RTS
JBA10			CMPA	#$01
			BNE	ZB9B5
			JSR	F_C259
			BRA	ZB9B5
JBA19			TST	>M00A5
			BEQ	ZBA2A
			CLR	>M00A5
			CMPA	#$01
			BNE	ZB9B5
			JSR	F_C33D
			BRA	ZB9B5
ZBA2A			CMPA	#$01
			BEQ	ZBA3D
			LDAA	M777E
			INCA
			CMPA	#$05
			BCS	ZBA37
			CLRA
ZBA37			STAA	M777E
			JMP	ZB9B5
ZBA3D			STAA	M00A5
			JMP	ZB9B5
ZBA42			TBA
			CLR	>M00A4
			LDAB	M7774

			JSR	JMPOFF1
			FCB	ZBA5C - *
			FCB	$15
			FCB	JBA5F - *
			FCB	$16
			FCB	ZBA5C - *
			FCB	$18
			FCB	JBADD - *
			FCB	$19
			FCB	ZBA5C - *
			FCB	$1B
			FCB	JBB12 - *
			FCB	$1C
			FCB	JBB34 - *
			FCB	$1D
			FCB	ZBA5C - *
			FCB	$00

ZBA5C			TAB
			CLC
			RTS
JBA5F			LDAB	M7789
			CMPB	#$08
			BEQ	ZBAC3
			BCS	ZBA5C
			CMPB	#$0D
			BCC	ZBA5C
			CMPB	#$09
			BEQ	ZBABA
			CMPB	#$0A
			BNE	ZBA8B
			CMPA	#$01
			BEQ	ZBA86
			LDAA	M777E
			INCA
			CMPA	#$05
			BCS	ZBA81
			CLRA
ZBA81			STAA	M777E
			BRA	ZBADB
ZBA86			JSR	F_BBF0
			BRA	ZBADB
ZBA8B			CMPB	#$0B
			BNE	ZBAAC
			TST	>M00A5
			BEQ	ZBAA4
			CLR	>M00A5
			CMPA	#$01
			BNE	ZBADB
			JSR	F_C245
			INC	M7789
			JMP	ZBBA6
ZBAA4			CMPA	#$01
			BNE	ZBADB
			STAA	M00A5
			BRA	ZBADB
ZBAAC			LDAB	M7788
			CMPB	#$02
			BEQ	ZBA5C
			CMPA	#$01
			BNE	ZBADB
			JMP	ZBB7A
ZBABA			CMPA	#$01
			BNE	ZBADB
			JSR	ME245_via_cvec_d38f
			BRA	ZBADB
ZBAC3			CMPA	#$01
			BEQ	ZBAD5
			LDAA	M777E
			INCA
			CMPA	#$05
			BCS	ZBAD0
			CLRA
ZBAD0			STAA	M777E
			BRA	ZBADB
ZBAD5			JSR	F_E115
			JSR	F_BC18
ZBADB			SEC
			RTS
JBADD			CMPA	#$01
			BNE	ZBAEA
			LDAB	#$01
			STAB	XROM
			JSR	XROM_CALL
			BRA	ZBB10
ZBAEA			LDAA	M7789
			BEQ	ZBB01
			CMPA	#$08
			BCS	ZBB10
			LDAA	M777E
			INCA
			CMPA	#$05
			BCS	ZBAFC
			CLRA
ZBAFC			STAA	M777E
			BRA	ZBB10
ZBB01			LDAA	M777E
			INCA
			ANDA	#$01
			STAA	M777E
			LDX	M7781
			JSR	F_E10C
ZBB10			SEC
			RTS
JBB12			LDAB	M7788
			CMPB	#$01
			BEQ	ZBB1C
			JMP	ZBA5C
ZBB1C			CMPA	#$01
			BEQ	ZBB28
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			BRA	ZBBA0
ZBB28			JSR	HI_CALL_00
			JSR	HI_CALL_01
			JSR	F_ED75
			CLRB
			BRA	ZBB7C
JBB34			LDAB	M7789
			BEQ	ZBB63
			CMPB	#$02
			BEQ	ZBB63
			LDAB	M7788
			CMPB	#$02
			BEQ	ZBB4C
			CMPA	#$01
			BNE	ZBBA0
			LDAB	#$0A
			BRA	ZBB7C
ZBB4C			CMPA	#$01
			BNE	ZBB96
			JSR	F_C345
			JSR	HI_CALL_03
			LDAA	#$01
			STAA	M7788
			DEC	M7789
			CLR	M778A
			BRA	ZBBA6
ZBB63			LDAB	M7788
			CMPB	#$01
			BEQ	ZBB6D
			JMP	ZBA5C
ZBB6D			CMPA	#$01
			BNE	ZBBA0
			TST	M7789
			BNE	ZBB7A
			LDAB	#$0B
			BRA	ZBB7C
ZBB7A			LDAB	#$7F
ZBB7C			STAB	M778E
			LDAA	#$01
			STAA	M00A4
			LDAA	#$02
			STAA	M7788
			CLR	M778A
			CLR	M778C
			LDAB	M7774
			JSR	F_B1DD
ZBB94			SEC
			RTS
ZBB96			LDAA	#$01
			STAA	M7788
			CLR	M778A
			BRA	ZBBA6
ZBBA0			CLR	M7788
			CLR	M7789
ZBBA6			CLR	M778C
			LDAB	M7774
			JSR	F_B1DD
			BRA	ZBB94
ZBBB1			CMPA	#$01
			BNE	F_BBBC
			LDAB	#$02
			STAB	XROM
			JSR	XROM_CALL

F_BBBC			CLR	>M00A6
			LDX	#S_GOOD_MORNING
			STX	M00A9
			LDAB	#$10
			LDX	#M7740
			JSR	F_AE8A
			LDAA	#$01
			STAA	M00CC
			LDAB	M7779
			JSR	F_B7D6
			JSR	F_B09A
			LDAB	M7773
			JSR	F_E0A4
			JSR	F_B796
			SEC
			RTS
MBBE4			FCB	$05,$03,$0B,$05,$01,$0F,$0C,$0A,$03,$02,$0B,$03

F_BBF0			LDAB	M777E
			CMPB	#$05
			BCS	ZBBF8
			CLRB
ZBBF8			PSHB
			ASLB
			LDX	#MBC0E
			ABX
			LDX	,X
			JSR	,X
			PULB
			TSTB
			BEQ	ZBC0D
			CMPB	#$04
			BEQ	ZBC0D
			JSR	F_F052
ZBC0D			RTS

MBC0E			FDB	ME633_via_cvec_bc0e
			FDB	ME4C1_via_cvec_bc10
			FDB	ME543_via_cvec_bc12
			FDB	ME5BE_via_cvec_bc14
			FDB	ME629_via_cvec_bc16

F_BC18			TST	M777E
			BEQ	ZBC26
			LDAB	#$03
			STAB	XROM
			JSR	XROM_CALL
			BRA	ZBC29
ZBC26			JSR	F_E11D
ZBC29			RTS

F_BC2A			LDX	M7781
			JSR	F_E0E9
			TST	M7793
			BEQ	ZBC3F
			LDAA	M7772
			CMPA	#$01
			BNE	ZBC3F
			JMP	ZBDE5
ZBC3F			PSHB
			LDAB	M7772
			CMPB	#$05
			BNE	ZBC8E
			LDAB	M7774
			CMPB	#$29
			BNE	ZBC6A
			LDX	#M6DD7
			CLRA
			LDAB	#$0C
ZBC54			ADDA	,X
			ABX
			CPX	#M6E37
			BNE	ZBC54
			CMPA	#$08
			BHI	ZBC8B
			BCS	ZBCB0
			PULB
			PSHB
			CMPB	#$02
			BEQ	ZBCB0
			BRA	ZBC8B
ZBC6A			CMPB	#$2A
			BCS	ZBCB0
			CMPB	#$34
			BCC	ZBCB0
			CMPB	#$33
			BNE	ZBC7D
			LDAB	M778C
			CMPB	#$02
			BCS	ZBCB0
ZBC7D			LDAA	M7786
			LDAB	#$0C
			MUL
			LDX	#M6DD7
			ABX
			TST	,X
			BNE	ZBCB0
ZBC8B			JMP	ZBDE6
ZBC8E			CMPB	#$01
			BNE	ZBCB0
			LDAB	M7787
			CMPB	#$0B
			BNE	ZBCA2
			LDAB	M778C
			CMPB	#$02
			BCS	ZBCB3
			BRA	ZBCB0
ZBCA2			CMPB	#$59
			BNE	ZBCB0
			LDAB	M778C
			CMPB	#$02
			BCC	ZBCB0
			JMP	ZBDE8
ZBCB0			CLRA
			BRA	ZBCEB
ZBCB3			LDAB	M777B
			LDAA	#$05
			JSR	F_AF64
			LDAA	$57,X
			PULB
			PSHA
			LDX	M7781
			DECB
			BEQ	ZBCF3
			LDAA	,X
			BNE	ZBCCC
			JMP	ZBDE6
ZBCCC			CMPA	#$05
			BCS	ZBCD3
			JMP	ZBD90
ZBCD3			LDAB	M777B
			LDAA	#$05
			JSR	F_AF64
			LDAA	$59,X
			CMPA	#$08
			BCS	ZBCE5
			LDAA	#$07
			STAA	$59,X
ZBCE5			LDX	M7781
			JMP	ZBD8C
ZBCEB			PULB
			PSHA
			LDX	M7781
			DECB
			BNE	ZBD4C
ZBCF3			LDAB	M7774
			CMPB	#$1C
			BEQ	ZBD0A
			CMPB	#$2A
			BNE	ZBD2D
			LDAA	,X
			CMPA	M7783
			BNE	ZBD37
			PULB
			CLRA
			JMP	F_BE61
ZBD0A			LDAB	M7788
			CMPB	#$02
			BNE	ZBD2D
			TST	M778C
			BEQ	ZBD2D
			LDAA	,X
			CMPA	M7783
			BNE	ZBD37
			DEX
			LDAA	,X
			CMPA	#$6C
			BCC	ZBD34
			INCA
			STAA	,X
			INX
			CLRA
			PULB
			JMP	F_BE61
ZBD2D			LDAA	,X
			CMPA	M7783
			BNE	ZBD37
ZBD34			JMP	ZBDE6
ZBD37			PULB
			TSTB
			BEQ	ZBD48
			ADDA	#$04
			CMPA	M7783
			BLS	ZBD45
			JMP	ZBDE5
ZBD45			JMP	F_BE61
ZBD48			INCA
			JMP	F_BE61
ZBD4C			LDAB	M7774
			CMPB	#$1C
			BEQ	ZBD62
			CMPB	#$2A
			BNE	ZBD8C
			LDAA	,X
			BNE	ZBD90
			PULB
			LDAA	M7783
			JMP	F_BE61
ZBD62			LDAB	M7788
			CMPB	#$02
			BNE	ZBD8C
			TST	M778C
			BEQ	ZBD84
			LDAA	,X
			BNE	ZBD90
			DEX
			LDAA	,X
			CMPA	#$0D
			BLS	ZBDE6
			DECA
			STAA	,X
			INX
			LDAA	M7783
			PULB
			JMP	F_BE61
ZBD84			LDAA	,X
			CMPA	#$0D
			BLS	ZBDE6
			BRA	ZBD90
ZBD8C			LDAA	,X
			BEQ	ZBDE6
ZBD90			PULB
			TSTB
			BEQ	ZBD9B
			SUBA	#$04
			BMI	ZBDE5
			JMP	F_BE61
ZBD9B			DECA
			LDAB	M7774
			CMPB	#$35
			BEQ	ZBDDE
			CMPB	#$0A
			BEQ	ZBDC6
			CMPB	#$07
			BNE	ZBDD4
			LDAB	M7788
			CMPB	#$01
			BNE	ZBDD4
			LDAB	M7789
			CMPB	#$04
			BNE	ZBDD4
			LDAB	M778C
			CMPB	#$04
			BCC	ZBDD4
			TSTA
			BEQ	ZBDE5
			JMP	F_BE61
ZBDC6			LDAB	M7788
			CMPB	#$01
			BNE	ZBDD4
			LDAB	M7789
			CMPB	#$0F
			BEQ	ZBDDE
ZBDD4			CPX	#M7740
			BCS	ZBDE2
			CPX	#M7750
			BCC	ZBDE2
ZBDDE			CMPA	#$20
			BCS	ZBDE5
ZBDE2			JMP	F_BE61
ZBDE5			RTS
ZBDE6			PULA
			RTS
ZBDE8			PULB
			LDX	M7781
			DECB
			BNE	ZBE2B
			LDAA	,X
			CMPA	M7783
			BEQ	ZBDF9
			INCA
			BRA	ZBE28
ZBDF9			PSHX
			DEX
			DEX
			LDAA	,X
			BEQ	ZBE5F
			PSHA
			JSR	F_AF5F
			LDAA	$0B,X
			CMPA	#$3F
			BCC	ZBE5E
			PULB
			TSTB
			BEQ	ZBE16
			ADDA	#$04
			CMPA	#$3F
			BHI	ZBE5F
			BRA	ZBE17
ZBE16			INCA
ZBE17			STAA	$0B,X
			PULX
			CMPA	#$04
			BCC	ZBE22
			LDAA	#$07
			BRA	ZBE24
ZBE22			LDAA	#$0F
ZBE24			STAA	M7783
			CLRA
ZBE28			JMP	F_BE61
ZBE2B			LDAA	,X
			BEQ	ZBE32
			DECA
			BRA	ZBE5C
ZBE32			PSHX
			DEX
			DEX
			LDAA	,X
			BEQ	ZBE5F
			PSHA
			JSR	F_AF5F
			LDAA	$0B,X
			BEQ	ZBE5E
			PULB
			TSTB
			BEQ	ZBE4B
			SUBA	#$04
			BMI	ZBE5F
			BRA	ZBE4C
ZBE4B			DECA
ZBE4C			STAA	$0B,X
			PULX
			CMPA	#$04
			BCC	ZBE57
			LDAA	#$07
			BRA	ZBE59
ZBE57			LDAA	#$0F
ZBE59			STAA	M7783
ZBE5C			BRA	F_BE61
ZBE5E			PULA
ZBE5F			PULX
			RTS

F_BE61			JMP	ZBEBF
			LDAB	M7774
			CMPB	#$15
			BNE	ZBE7B
			LDAB	M7788
			CMPB	#$01
			BNE	ZBEBF
			LDAB	M7789
			CMPB	#$02
			BCS	ZBE87
			BRA	ZBEBF
ZBE7B			CMPB	#$29
			BEQ	ZBE87
			CMPB	#$2E
			BCC	ZBEBF
			CMPB	#$2B
			BCS	ZBEBF
ZBE87			PSHX
			LDX	#M7CE3
			LDAB	#$08
ZBE8D			TIM	#%00000010,$01,X
			BNE	ZBEBC
			INX
			INX
			DECB
			BNE	ZBE8D
			LDAB	M7772
			ANDB	#$04
			BEQ	ZBEA2
			LDAB	#$08
			BRA	ZBEA4
ZBEA2			LDAB	#$01
ZBEA4			LDX	#M7F39
ZBEA7			PSHB
			LDAB	M006C
ZBEAA			TIM	#%00000010,$01,X
			BNE	ZBEBB
			INX
			INX
			DECB
			BNE	ZBEAA
			PULB
			DECB
			BNE	ZBEA7
			PULX
			BRA	ZBEBF
ZBEBB			PULB
ZBEBC			PULX
			BRA	ZBF10
ZBEBF			STAA	,X
			JSR	F_B563
			LDAB	M7788
			BEQ	ZBECC
			JMP	ZBF4F
ZBECC			LDAB	M7774

			JSR	JMPOFF1
			FCB	JBF19 - *
			FCB	$01
			FCB	JBF1C - *
			FCB	$02
			FCB	ZBF10 - *
			FCB	$05
			FCB	JBF13 - *
			FCB	$06
			FCB	JBF16 - *
			FCB	$07
			FCB	ZBF10 - *
			FCB	$08
			FCB	JBF22 - *
			FCB	$09
			FCB	ZBF10 - *
			FCB	$14
			FCB	JBF1F - *
			FCB	$15
			FCB	ZBF10 - *
			FCB	$16
			FCB	JBF31 - *
			FCB	$18
			FCB	ZBF10 - *
			FCB	$19
			FCB	JBF25 - *
			FCB	$1D
			FCB	JBF31 - *
			FCB	$20
			FCB	ZBF10 - *
			FCB	$28
			FCB	JBF2B - *
			FCB	$29
			FCB	JBF2E - *
			FCB	$2A
			FCB	JBF34 - *
			FCB	$2B
			FCB	JBF37 - *
			FCB	$2C
			FCB	JBF3A - *
			FCB	$2E
			FCB	JBF28 - *
			FCB	$2F
			FCB	JBF3D - *
			FCB	$30
			FCB	JBF40 - *
			FCB	$31
			FCB	JBF43 - *
			FCB	$32
			FCB	JBF46 - *
			FCB	$33
			FCB	JBF49 - *
			FCB	$34
			FCB	JBF4C - *
			FCB	$35
			FCB	JBF28 - *
			FCB	$36
			FCB	ZBF10 - *
			FCB	$3C
			FCB	JBF31 - *
			FCB	$3F
			FCB	ZBF10 - *
			FCB	$00

ZBF10			JMP	ZC0ED
JBF13			JMP	ZC05A
JBF16			JMP	ZC002
JBF19			JMP	ZC177
JBF1C			JMP	ZC187
JBF1F			JMP	ZC1E0
JBF22			JMP	ZC1C8
JBF25			JMP	ZC207
JBF28			JMP	ZC16F
JBF2B			JMP	ZC16C
JBF2E			JMP	ZC169
JBF31			JMP	ZC0E4
JBF34			JMP	ZC0EF
JBF37			JMP	ZC0FE
JBF3A			JMP	ZC125
JBF3D			JMP	ZC12D
JBF40			JMP	ZC135
JBF43			JMP	ZC146
JBF46			JMP	ZC14B
JBF49			JMP	ZC150
JBF4C			JMP	ZC155
ZBF4F			LDAB	M7774

			JSR	JMPOFF1
			FCB	JBF77 - *
			FCB	$02
			FCB	JBF7D - *
			FCB	$03
			FCB	JBFB7 - *
			FCB	$04
			FCB	JC015 - *
			FCB	$05
			FCB	JBF77 - *
			FCB	$07
			FCB	JBF86 - *
			FCB	$08
			FCB	JBF77 - *
			FCB	$09
			FCB	JBF80 - *
			FCB	$0A
			FCB	JBF83 - *
			FCB	$0B
			FCB	JBF77 - *
			FCB	$15
			FCB	JBF7A - *
			FCB	$16
			FCB	JBF77 - *
			FCB	$19
			FCB	JBF89 - *
			FCB	$1A
			FCB	JBF96 - *
			FCB	$1B
			FCB	JBFA6 - *
			FCB	$1C
			FCB	JBFB1 - *
			FCB	$1D
			FCB	JBF77 - *
			FCB	$00

JBF77			JMP	ZC0ED
JBF7A			JMP	ZC1EE
JBF7D			JMP	ZC18F
JBF80			JMP	ZC09C
JBF83			JMP	ZC0B1
JBF86			JMP	ZC073
JBF89			LDAB	M7789
			CMPB	#$01
			BNE	ZBF93
			JMP	ZC207
ZBF93			JMP	ZC0E4
JBF96			JSR	HI_CALL_11
			LDAB	M7789
			CMPB	#$02
			BNE	ZBFA3
			JMP	ZC0E4
ZBFA3			JMP	ZC207
JBFA6			LDAA	M776B
			ANDA	#%11110111
			STAA	M776B
			JMP	ZC207
JBFB1			JSR	HI_CALL_03
			JMP	ZC0E4
JBFB7			LDAB	M7789
			BNE	ZBFCA
			TST	M778C
			BNE	ZBFF0
			LDX	#F_9D91
			JSR	F_92E3
			JMP	ZC1D8
ZBFCA			CMPB	#$01
			BNE	ZBFE9
			LDAB	M778C
			BEQ	ZBFE0
			CMPB	#$05
			BCC	ZBFF0
			LDX	#F_9EB9
			JSR	F_92DB
			JMP	ZC1D8
ZBFE0			LDX	#F_9D91
			JSR	F_92E3
			JMP	ZC1D8
ZBFE9			LDAB	M778C
			CMPB	#$04
			BCS	ZBFF3
ZBFF0			JMP	ZC0E4
ZBFF3			LDX	#F_9D68
			JSR	F_92DB
			LDX	#F_9FEC
			JSR	F_92DB
			JMP	ZC1D8
ZC002			LDAB	M778C
			CMPB	#$04
			BCS	ZC00C
			JMP	ZC0E4
ZC00C			LDX	#F_9DD7
			JSR	F_92DB
			JMP	ZC1D8
JC015			LDAB	M7789
			BEQ	ZC02F
			CMPB	#$03
			BEQ	ZC02F
			CMPB	#$06
			BEQ	ZC02F
			CMPB	#$09
			BEQ	ZC02F
			LDAB	M778C
			CMPB	#$02
			BCS	ZC037
			BRA	ZC034
ZC02F			TST	M778C
			BEQ	ZC037
ZC034			JMP	ZC0E4
ZC037			LDAB	M7787
			CMPB	#$0B
			BNE	ZC052
			ANDA	#$3C
			BNE	ZC052
			LDAB	M777B
			LDAA	#$05
			JSR	F_AF64
			LDAA	#$07
			CMPA	$59,X
			BCC	ZC052
			STAA	$59,X
ZC052			LDX	#F_9E95
			JSR	F_92DB
			BRA	ZC064
ZC05A			LDAB	M778C
			CMPB	#$04
			BCS	ZC064
			JMP	ZC0E4
ZC064			LDX	#F_9DD7
			JSR	F_92DB
			LDX	#F_9E58
			JSR	F_92DB
			JMP	ZC1BE
ZC073			LDAB	M778C
			CMPB	#$04
			BCS	ZC07D
			JMP	ZC0E4
ZC07D			LDAB	M7789
			CMPB	#$06
			BCC	ZC0ED

			JSR	JMPOFFB
			FCB	JC08D - *
			FCB	JC090 - *
			FCB	JC093 - *
			FCB	JC096 - *
			FCB	JC093 - *
			FCB	JC099 - *

JC08D			JMP	ZC1AF
JC090			JMP	ZC1B4
JC093			JMP	ZC1B9
JC096			JMP	ZC1BE
JC099			JMP	ZC1C3
ZC09C			LDAB	M778C
			CMPB	#$04
			BCS	ZC0A6
			JMP	ZC0E4
ZC0A6			TST	M7789
			BEQ	ZC0AE
			JMP	ZC1D2
ZC0AE			JMP	ZC1AF
ZC0B1			LDAB	M7789

			JSR	JMPOFF1
			FCB	JC0D5 - *
			FCB	$01
			FCB	JC0D8 - *
			FCB	$02
			FCB	JC0D2 - *
			FCB	$03
			FCB	JC0DB - *
			FCB	$04
			FCB	JC0DE - *
			FCB	$05
			FCB	ZC18F - *
			FCB	$0B
			FCB	JC0D8 - *
			FCB	$0C
			FCB	JC0DE - *
			FCB	$0D
			FCB	JC0E1 - *
			FCB	$0E
			FCB	JC0CF - *
			FCB	$0F
			FCB	JC0D2 - *
			FCB	$10
			FCB	ZC0ED - *
			FCB	$00

JC0CF			JMP	ZC1C3
JC0D2			JMP	ZC1D8
JC0D5			JMP	ZC207
JC0D8			JMP	ZC229
JC0DB			JMP	ZC221
JC0DE			JMP	ZC237
JC0E1			JMP	ZC1E6
ZC0E4			LDX	M7781
			JSR	F_E10C
			SEC
			BRA	ZC0EE
ZC0ED			CLC
ZC0EE			RTS
ZC0EF			LDAB	M778C
			STAB	M0073
			LDX	M7781
			LDAB	,X
			JSR	F_D06A
			BRA	ZC16F
ZC0FE			TST	M6E38
			BEQ	ZC10E
			JSR	F_C7C2
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			BRA	ZC120
ZC10E			LDAB	M778C
			JSR	F_D099
			LDAB	M778C
			JSR	F_C832
			AIM	#%11110111,TCSR1
			JSR	F_995A
ZC120			OIM	#%00001000,TCSR1
			BRA	ZC16F
ZC125			LDAB	M778C
			JSR	F_D099
			BRA	ZC16F
ZC12D			LDX	#F_A01B
			JSR	F_92E3
			BRA	ZC16F
ZC135			LDAB	M778C
			JSR	F_C81C
			AIM	#~ECMI,TCSR3
			JSR	F_EC17
			OIM	#ECMI,TCSR3
			BRA	ZC16F
ZC146			JSR	F_95E5
			BRA	ZC16F
ZC14B			JSR	F_B805
			BRA	ZC16F
ZC150			JSR	HI_CALL_03
			BRA	ZC16F
ZC155			JSR	HI_CALL_00
			JSR	HI_CALL_01
			AIM	#~ECMI,TCSR3
			JSR	HI_CALL_15
			JSR	HI_CALL_16
			OIM	#ECMI,TCSR3
			BRA	ZC16F
ZC169			JSR	F_C7C2
ZC16C			JSR	F_B805
ZC16F			LDAA	#$01
			STAA	M7791
			JMP	ZC0E4
ZC177			TST	M778C
			BNE	ZC184
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			BRA	ZC187
ZC184			JMP	ZC0E4
ZC187			LDX	#F_9A41
			JSR	F_92E3
			BRA	ZC1D2
ZC18F			JSR	F_9A87
			LDX	#F_9B02
			JSR	F_92E3
			LDX	#F_9C35
			JSR	F_92E3
			LDX	#F_9AC2
			JSR	F_92E3
			JSR	F_9C76
			LDX	#F_9D12
			JSR	F_92E3
			BRA	ZC1D8
ZC1AF			LDX	#F_9E95
			BRA	ZC1D5
ZC1B4			LDX	#F_9EB9
			BRA	ZC1D5
ZC1B9			LDX	#F_9EEC
			BRA	ZC1D5
ZC1BE			LDX	#F_9ECC
			BRA	ZC1D5
ZC1C3			LDX	#F_9E6D
			BRA	ZC1D5
ZC1C8			LDAB	M778C
			CMPB	#$04
			BCS	ZC1D2
			JMP	ZC0E4
ZC1D2			LDX	#F_9F00
ZC1D5			JSR	F_92DB
ZC1D8			LDAA	#$01
			STAA	M7792
ZC1DD			JMP	ZC0E4
ZC1E0			JSR	HI_CALL_18
			JMP	ZC0E4
ZC1E6			LDX	#F_A01B
			JSR	F_92E3
			BRA	ZC1D8
ZC1EE			LDAB	M7789
			BNE	ZC1F8
			JSR	F_E6BD
			BRA	ZC207
ZC1F8			CMPB	#$01
			BEQ	ZC207
			CMPB	#$07
			BHI	ZC1DD
			BEQ	ZC207
			JSR	F_E6BD
			BRA	ZC1DD
ZC207			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			LDAB	M7774
			CMPB	#$0A
			BNE	ZC1DD
			TST	M7789
			BNE	ZC1DD
			JSR	F_E0F3
			BRA	ZC1D8
ZC221			LDX	#F_A049
			JSR	F_92E3
			BRA	ZC1D8
ZC229			LDX	#F_A0D1
			JSR	F_92E3
			LDX	#F_A0F1
			JSR	F_92E3
			BRA	ZC1D8
ZC237			LDX	#F_A100
			JSR	F_92E3
			LDX	#F_A110
			JSR	F_92E3
			BRA	ZC1D8

F_C245			CLRB
			LDX	#M7571
ZC249			STAB	,X
			INCB
			INX
			CPX	#M75F1
			BNE	ZC249
			RTS

F_C253			LDAA	PORT2
			COMA
			ANDA	#$E0
			RTS

F_C259			LDAB	M778C
			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			LDAB	$02,X
			PSHB
			JSR	F_B164
			JSR	F_AFD9
			PULB
			JSR	F_B787
			JSR	F_B084
			RTS

F_C274			CMPB	#$1E
			BEQ	ZC286
			JSR	HI_CALL_1A
			JSR	F_E111
			CLRA
			STAA	M777B
ZC282			JSR	F_B082
			RTS
ZC286			JSR	F_C291
			JSR	F_E112
			JSR	F_E10F
			BRA	ZC282

F_C291			LDAA	M7780
			STAA	M7773
			CLR	M7793
			LDAA	#$01
			STAA	M7792
			LDD	#$0101
			STD	M776E
			STD	M7770
			TST	M756E
			BNE	ZC2B9
			LDAB	#$01
			STAB	M756E
			BSR	F_C2BC
			CLR	M756E
			BRA	ZC2BB
ZC2B9			BSR	F_C2BC
ZC2BB			RTS

F_C2BC			LDX	#M6A19
			JMP	F_B7A2

HI_CALL_1A		LDAB	M7773
			JSR	HI_CALL_19
			CLR	M7793
			LDAA	#$01
			STAA	M7792
			LDD	#$0101
			STD	M776E
			STD	M7770
			LDX	#INIT_VOICE
			TST	M756E
			BNE	ZC2EE
			LDAB	#$01
			STAB	M756E
			JSR	F_B7A2
			CLR	M756E
			BRA	ZC2F1
ZC2EE			JSR	F_B7A2
ZC2F1			RTS
HI_CALL_19		TST	M7792
			BEQ	ZC314
			LDAA	M7773
			STAA	M7780
			STAB	M7773
			CLR	M7792
			TST	M7793
			BNE	ZC313
			LDX	#M6A67
			STX	M00A9
			LDX	#M6A19
			JSR	LO_CALL_06
ZC313			RTS
ZC314			STAB	M7773
			BRA	ZC313
HI_CALL_1B		LDAB	M7773
			JSR	HI_CALL_19
			CLR	M7793
			JSR	F_AEDD
			STX	M00A9
			LDX	#M6A67
			JSR	LO_CALL_00
			JSR	LO_CALL_08
			JSR	HI_CALL_05
			LDD	#$0101
			STD	M776E
			STD	M7770
			RTS

F_C33D			LDAB	#$04
			STAB	XROM
			JSR	XROM_CALL
			RTS

F_C345			LDAA	M778F
HI_CALL_02		LDAB	M778A
			JSR	F_969B
			LDAA	M7789
			CMPA	#$03
			BEQ	ZC365
			LDX	#M7F9A
			STX	M00A9
			LDAB	#$18
			LDX	#M7628
			JSR	F_AE8A
			JMP	ZC406
ZC365			LDX	#M7F9A
			STX	M00A9
			LDX	#M7640
			STX	M00A7
			LDAB	#$0C
ZC371			PSHB
			LDX	M00A9
			LDD	,X
			PSHA
			LDAA	M778A
			CMPA	#$09
			PULA
			BCS	ZC389
			BNE	ZC385
			SUBA	#$1E
			BRA	ZC38B
ZC385			SUBA	#$0F
			BRA	ZC38B
ZC389			SUBA	#$3C
ZC38B			INX
			INX
			STX	M00A9
			LDX	M00A7
			STD	,X
			INX
			INX
			STX	M00A7
			PULB
			DECB
			BNE	ZC371
			CLRB
ZC39C			PSHB
			LDAA	#$18
			MUL
			LDX	#M7640
			ABX
			STX	M00A9
			LDAB	#$18
			ABX
			STX	M00A7
			PULB
			PSHB
			CMPB	#$09
			BNE	ZC3B5
			LDAB	#$08
			BRA	ZC3B7
ZC3B5			LDAB	#$0C
ZC3B7			PSHB
			LDX	M00A9
			LDD	,X
			PSHA
			LDAA	M778A
			CMPA	#$09
			PULA
			BCS	ZC3CF
			BNE	ZC3CB
			ADDA	#$06
			BRA	ZC3D1
ZC3CB			ADDA	#$03
			BRA	ZC3D1
ZC3CF			ADDA	#$0C
ZC3D1			INX
			INX
			STX	M00A9
			LDX	M00A7
			STD	,X
			INX
			INX
			STX	M00A7
			PULB
			DECB
			BNE	ZC3B7
			PULB
			INCB
			CMPB	#$0A
			BNE	ZC39C
			CLRB
			LDX	#M7640
ZC3EB			LDAA	,X
ZC3ED			CMPA	#$0D
			BCC	ZC3F5
			ADDA	#$0C
			BRA	ZC3ED
ZC3F5			CMPA	#$6D
			BCS	ZC3FD
			SUBA	#$0C
			BRA	ZC3F5
ZC3FD			STAA	,X
			INX
			INX
			INCB
			CMPB	#$80
			BNE	ZC3EB
ZC406			RTS

F_C407			LDAA	M7772
			ANDA	#$04
			BEQ	ZC41F
			LDAA	M6E37
ZC411			CMPA	#$0B
			BCS	ZC43D
			BEQ	ZC41B
			LDAA	#$03
			BRA	ZC442
ZC41B			LDAA	#$06
			BRA	ZC442
ZC41F			LDAA	M7774
			CMPA	#$1C
			BNE	ZC441
			LDAA	M7788
			CMPA	#$02
			BNE	ZC441
			LDAA	M7789
			BEQ	ZC43D
			CMPA	#$02
			BEQ	ZC43D
			LDAA	M778A
			ADDA	#$02
			BRA	ZC411
ZC43D			LDAA	#$0C
			BRA	ZC442
ZC441			CLRA
ZC442			STAA	M7F99
			RTS

LCD_INIT		LDAA	#$38			; LCD Mode Set
			LDX	#$0000
ZC44B			DEX
			BNE	ZC44B
			STAA	LCD_CMD
			LDX	#10000
ZC454			DEX
			BNE	ZC454
			STAA	LCD_CMD
			LDX	#10000
ZC45D			DEX
			BNE	ZC45D
			STAA	LCD_CMD
			JSR	LCD_WAIT
			STAA	LCD_CMD
			JSR	LCD_WAIT
			LDAA	#$0C
			STAA	LCD_CMD
			JSR	LCD_WAIT
			LDAA	#$01
			STAA	LCD_CMD
			JSR	LCD_WAIT
			LDAA	#$06
			STAA	LCD_CMD
			LDAA	#$20
			LDX	#LCD_COPY
ZC486			STAA	,X
			INX
			CPX	#LCD_BUFFER
			BNE	ZC486
			LDX	#M009B
ZC491			CLR	,X
			INX
			CPX	#M009D
			BNE	ZC491
			JSR	F_C253
			CMPA	#$60
			BNE	ZC4A4
			LDAB	#$01
			BRA	ZC4B2
ZC4A4			CMPA	#$A0
			BNE	ZC4AC
			LDAB	#$02
			BRA	ZC4B2
ZC4AC			CMPA	#$C0
			BNE	ZC4CA
			LDAB	#$03
ZC4B2			STAB	M00A6
			LSRA
			LSRA
			LSRA
			LSRA
			LSRA
			STAA	M009B
			LDX	#S_VERSION
			STX	M00A9
			LDAB	#$10
			LDX	#M7740
			JSR	F_AE8A
			BRA	ZC4EE
ZC4CA			JSR	HI_CALL_17
			CMPB	#$07
			BNE	ZC4D4
			JSR	HI_CALL_17
ZC4D4			CMPB	#$03
			BNE	ZC4EE
			LDAA	#$01
			STAA	M00AD
ZC4DC			LDX	#S_GOOD_MORNING
			STX	M00A9
			LDAB	#$10
			LDX	#M7740
			JSR	F_AE8A
			TST	>M00AD
			BNE	ZC544
ZC4EE			JSR	F_C8D9
			CLRB
ZC4F2			PSHB
			LSRB
			ANDB	#$03
			LDAA	#$80
ZC4F8			TSTB
			BEQ	ZC4FF
			DECB
			LSRA
			BRA	ZC4F8
ZC4FF			ORAA	#$08
			STAA	PORT6
			PULB
			CMPB	#$10
			BCS	ZC512
			LDX	#M7740
			PSHB
			SUBB	#$10
			ABX
			PULB
			BRA	ZC516
ZC512			LDX	#S_YAMAHA_TX81Z
			ABX
ZC516			LDAA	,X
			LDX	#LCD_BUFFER
			ABX
			STX	M00A7
			CMPA	#$20
			BCS	ZC4DC
			CMPA	#$80
			BCC	ZC4DC
			PSHB
			TAB
			JSR	PUTCHAR
			JSR	LCD_UPDATE
			PULB
			TST	>M00A6
			BNE	ZC53A
			LDX	#$A000
ZC537			DEX
			BNE	ZC537
ZC53A			INCB
			CMPB	#$20
			BNE	ZC4F2
			LDAB	#$FF
			JSR	F_F054
ZC544			JSR	F_C8D9
			RTS

F_C548			CLR	M7F99
			CLR	M7788
			CLR	M7789
			CLR	M778A
			CLR	M778C
			TST	M7793
			BEQ	ZC561
			LDAA	#$01
			STAA	M7792
ZC561			LDAA	M7790
			BEQ	ZC56B
			LDAA	#$FF
			STAA	M7790
ZC56B			LDAA	#$01
			STAA	M756D
			STAA	M756E
			LDAA	#$FF
			STAA	M7794
			STAA	M7795
			LDAA	M7772
			ANDA	#$07
			CMPA	#$03
			BEQ	ZC588
			CMPA	#$07
			BNE	ZC589
ZC588			CLRA
ZC589			STAA	M7772
			CLR	M777D
			LDAA	#$01
			STAA	M776C
			CLR	>M00EF
			JSR	F_C7C2
			LDAA	#$B1
			CMPA	M776D
			BCC	ZC5A4
			STAA	M776D
ZC5A4			CLR	M778B
			LDAA	M778F
			CMPA	#$0C
			BCS	ZC5AF
			CLRA
ZC5AF			STAA	M778F
			JSR	HI_CALL_09
			LDAA	M7779
			CMPA	#$18
			BCS	ZC5BF
			CLR	M7779
ZC5BF			LDAA	M7773
			CMPA	#$A0
			BCS	ZC5C9
			CLR	M7773
ZC5C9			LDAA	M7780
			CMPA	#$A0
			BCS	ZC5D3
			CLR	M7780
ZC5D3			LDAA	M777B
			ANDA	#$03
			STAA	M777B
			LDAA	M7776
			CMPA	#$0B
			BCS	ZC5E5
			CLR	M7776
ZC5E5			LDAA	M7775
			CMPA	#$1F
			BCC	ZC5F0
			CMPA	#$14
			BCC	ZC5F5
ZC5F0			LDAA	#$14
			STAA	M7775
ZC5F5			LDAA	M7778
			CMPA	#$36
			BCC	ZC600
			CMPA	#$28
			BCC	ZC605
ZC600			LDAA	#$28
			STAA	M7778
ZC605			LDAA	M7777
			CMPA	#$3F
			BCC	ZC610
			CMPA	#$3C
			BCC	ZC615
ZC610			LDAA	#$3C
			STAA	M7777
ZC615			JSR	LO_CALL_08
			LDAA	M7774
			TST	>M00A6
			BEQ	ZC629
			LDAA	#$04
			STAA	M7772
			LDAA	#$46
			BRA	ZC64A
ZC629			CMPA	#$46
			BCS	ZC630
			JSR	F_BBBC
ZC630			TST	>M00AD
			BEQ	ZC641
			LDAA	#$FF
			STAA	M7790
			CLR	M7772
			LDAA	#$1F
			BRA	ZC64A
ZC641			LDAA	M7774
			CMPA	#$1F
			BNE	ZC64A
			LDAA	#$14
ZC64A			STAA	M7774
			LDAA	M7772
			BNE	ZC65F
			LDAB	M7774
			CMPB	#$20
			BCC	ZC697
			CMPB	#$14
			BCC	ZC69C
			BRA	ZC697
ZC65F			CMPA	#$01
			BNE	ZC66D
			LDAB	M7774
			CMPB	#$0B
			BCS	ZC69C
			CLRB
			BRA	ZC699
ZC66D			CMPA	#$04
			BNE	ZC684
			LDAB	M7774
			CMPB	#$46
			BEQ	ZC69C
			CMPB	#$3F
			BCC	ZC680
			CMPB	#$3C
			BCC	ZC69C
ZC680			LDAB	#$3C
			BRA	ZC699
ZC684			CMPA	#$05
			BNE	ZC69F
			LDAB	M7774
			CMPB	#$36
			BCC	ZC693
			CMPB	#$28
			BCC	ZC69C
ZC693			LDAB	#$28
			BRA	ZC699
ZC697			LDAB	#$14
ZC699			STAB	M7774
ZC69C			JSR	F_B1DD
ZC69F			JSR	F_C95A
			JSR	F_C972
			RTS

S_YAMAHA_TX81Z		FCC	"* YAMAHA TX81Z *"
			FCB	$00

HI_CALL_09		LDAA	M756A
			CMPA	#$12
			BCS	ZC6C3
			LDAA	#$01
			STAA	M756A
ZC6C3			LDAA	M756B
			CMPA	#$03
			BCS	ZC6CD
			CLR	M756B
ZC6CD			LDAA	M7569
			CMPA	#$12
			BCS	ZC6D6
			LDAA	#$01
ZC6D6			STAA	M7569
			LDAA	M756C
			ANDA	#$01
			STAA	M756C
			LDAA	M756D
			ANDA	#$01
			STAA	M756D
			LDAA	M756E
			ANDA	#$01
			STAA	M756E
			LDAA	M756F
			ANDA	#$01
			STAA	M756F
			CLRB
ZC6FA			LDX	#M7740
			ABX
			LDAA	,X
			CMPA	#$20
			BCS	ZC708
			CMPA	#$80
			BCS	ZC70C
ZC708			LDAA	#$2A
			STAA	,X
ZC70C			INCB
			CMPB	#$10
			BNE	ZC6FA
			LDAA	M7565
			ANDA	#$7F
			STAA	M7565
			LDAA	M7568
			CMPA	#$03
			BCS	ZC721
			CLRA
ZC721			STAA	M7568
			LDAA	M7567
			ANDA	#$0F
			STAA	M7567
			LDAA	M7566
			CMPA	#$11
			BCS	ZC734
			CLRA
ZC734			STAA	M7566
			CLRB
ZC738			LDX	#M75F1
			ABX
			LDAA	,X
			PSHX
			LDX	#MC7BB
			ABX
			CMPA	,X
			PULX
			BLS	ZC74A
			CLR	,X
ZC74A			INCB
			CMPB	#$04
			BNE	ZC738
			CLRB
ZC750			LDX	#M75F5
			ABX
			LDAA	,X
			PSHX
			LDX	#MC7BF
			ABX
			CMPA	,X
			PULX
			BLS	ZC762
			CLR	,X
ZC762			INCB
			CMPB	#$03
			BNE	ZC750
			CLRB
ZC768			LDX	#M75F8
			ABX
			LDAA	,X
			CMPA	#$31
			BLS	ZC774
			CLR	,X
ZC774			INCB
			CMPB	#$30
			BNE	ZC768
			LDX	#M7571
ZC77C			LDAA	,X
			CMPA	#$B8
			BCS	ZC784
			CLR	,X
ZC784			INX
			CPX	#M75F1
			BNE	ZC77C
			CLRB
ZC78B			LDX	#M7628
			JSR	F_C7A1
			CMPB	#$0C
			BNE	ZC78B
			CLRB
ZC796			LDX	#M7640
			JSR	F_C7A1
			CMPB	#$80
			BNE	ZC796
			RTS

F_C7A1			PSHB
			ASLB
			ABX
			LDD	,X
			CMPA	#$0D
			BCC	ZC7AE
			LDAA	#$0D
			BRA	ZC7B4
ZC7AE			CMPA	#$6C
			BLS	ZC7B4
			LDAA	#$6C
ZC7B4			ANDB	#$3F
			STD	,X
			PULB
			INCB
			RTS

MC7BB			FCB	$7F,$30,$07,$63

MC7BF			FCB	$02,$01,$63

F_C7C2			LDAB	#$08
			LDX	#M7D8A
			LDAA	#$80
			BSR	F_C7F8
			LDAB	#$08
			LDX	#M7D5A
			CLRA
			BSR	F_C7F8
			LDAB	#$08
			LDX	#M7D62
			CLRA
			BSR	F_C7F8
			LDAB	#$08
			LDX	#M7D6A
			LDAA	#$FE
			BSR	F_C7F8
			LDAB	#$08
			LDX	#M0048
			LDAA	#$40
			BSR	F_C7F8
			LDAB	#$08
			LDX	#M0050
			CLRA
			BSR	F_C7F8
			BSR	F_C7FF
			RTS

F_C7F8			STAA	,X
			DEX
			DECB
			BNE	F_C7F8
			RTS

F_C7FF			LDAB	M7772
			ANDB	#$04
			BNE	ZC810
			LDAB	#$08
			LDX	#M7D72
			CLRA
			BSR	F_C7F8
			BRA	ZC812
ZC810			BSR	F_C813
ZC812			RTS

F_C813			CLRB
ZC814			BSR	F_C81C
			INCB
			CMPB	#$08
			BNE	ZC814
			RTS

F_C81C			PSHB
			LDX	#M6DD7
			LDAA	#$0C
			MUL
			ABX
			LDAA	$08,X
			JSR	F_908B
			COMA
			LDX	#M7D6B
			PULB
			ABX
			STAA	,X
			RTS

F_C832			LDX	#M7D83
			ABX
			LDAA	#$80
			STAA	,X
			LDX	#M7D53
			ABX
			CLRA
			STAA	,X
			LDX	#M7D5B
			ABX
			CLRA
			STAA	,X
			LDX	#M7D63
			ABX
			LDAA	#$FE
			STAA	,X
			LDX	#M0041
			ABX
			LDAA	#$40
			STAA	,X
			LDX	#M0049
			ABX
			CLRA
			STAA	,X
			JSR	F_C81C
			RTS
			PSHA
			PULA
			PSHA
			PULA
			RTS

;-------

PUTSTR_OFFSET		EQU	$C801		; not use in this bank

			INCLUDE	"inc/lcd.asm"

;-------

F_C8D5			LDAA	#$10
			BRA	ZC8DB
F_C8D9			LDAA	#$20
ZC8DB			LDX	#M7DCB
ZC8DE			PSHA
			LDAA	#$20
			DEX
			STAA	,X
			PULA
			DECA
			BNE	ZC8DE
			RTS

F_C8E9			TST	M7790
			BEQ	ZC8F3
			OIM	#%00010000,PORT6
			BRA	ZC8F6
ZC8F3			AIM	#%11101111,PORT6
ZC8F6			LDAB	M7772
			ANDB	#$07

			JSR	JMPOFFB
			FCB	JC907 - *
			FCB	JC920 - *
			FCB	JC939 - *
			FCB	JC906 - *
			FCB	ZC916 - *
			FCB	ZC92F - *
			FCB	JC939 - *
			FCB	JC906 - *

JC906			RTS
JC907			TST	M7793
			BEQ	ZC916
			TIM	#%00100000,M006E
			BEQ	ZC916
			AIM	#%01111111,PORT6
			BRA	ZC919
ZC916			OIM	#%10000000,PORT6
ZC919			AIM	#%10111111,PORT6
			AIM	#%11011111,PORT6
			RTS
JC920			TST	M7793
			BEQ	ZC92F
			TIM	#%00100000,M006E
			BEQ	ZC92F
			AIM	#%10111111,PORT6
			BRA	ZC932
ZC92F			OIM	#ECMI,PORT6
ZC932			AIM	#%01111111,PORT6
			AIM	#%11011111,PORT6
			RTS
JC939			AIM	#%01111111,PORT6
			AIM	#%10111111,PORT6
			TST	>M00AE
			BNE	ZC949
			OIM	#%00100000,PORT6
			BRA	ZC94C
ZC949			AIM	#%11011111,PORT6
ZC94C			RTS

F_C94D			SEI
			SPIN3
			LDAA	#$21
			STAA	M006E
			LDAA	#$02
			STAA	M00AE
			CLI
			RTS

F_C95A			AIM	#~ECMI,TCSR3
			JSR	HI_CALL_15
			OIM	#ECMI,TCSR3
			JSR	F_C407
			JSR	F_C8E9
			LDAB	#$0B
			STAB	>XROM
			JSR	XROM_CALL
			RTS

F_C972			TST	>M009A
			BNE	ZC9DF
			LDAB	M7772
			CMPB	#$02
			BCS	ZC99B
			CMPB	#$04
			BCS	ZC9DF
			CMPB	#$06
			BCS	ZC9A5
			BEQ	ZC993
			CMPB	#$09
			BEQ	ZC990
			CMPB	#$11
			BNE	ZC9DF
ZC990			JMP	ZCB00
ZC993			TST	M7795
			BPL	ZC9DF
			JMP	ZCAB2
ZC99B			TST	M7794
			BPL	ZC9DF
			TST	M7793
			BNE	ZC9DF
ZC9A5			LDAB	M7774
			LDAA	M7788
			CMPA	#$02
			BCS	ZC9B2
			JMP	ZCB0C

ZC9B2			JSR	JMPOFF1
			FCB	JC9E6 - *
			FCB	$01
			FCB	ZC9DF - *
			FCB	$03
			FCB	JCA00 - *
			FCB	$04
			FCB	JCA3F - *
			FCB	$05
			FCB	ZCA86 - *
			FCB	$07
			FCB	JCA7F - *
			FCB	$08
			FCB	ZCA86 - *
			FCB	$09
			FCB	JCA7F - *
			FCB	$0A
			FCB	JCA95 - *
			FCB	$0B
			FCB	ZC9DF - *
			FCB	$1F
			FCB	JCAAB - *
			FCB	$20
			FCB	ZC9DF - *
			FCB	$29
			FCB	ZCAB2 - *
			FCB	$30
			FCB	JC9E3 - *
			FCB	$31
			FCB	ZCAB2 - *
			FCB	$33
			FCB	JC9E0 - *
			FCB	$34
			FCB	ZC9DF - *
			FCB	$35
			FCB	ZCAA3 - *
			FCB	$36
			FCB	ZC9DF - *
			FCB	$3C
			FCB	ZCAB2 - *
			FCB	$3D
			FCB	ZC9DF - *
			FCB	$00

ZC9DF			RTS
JC9E0			JMP	ZCAEB
JC9E3			JMP	ZCADA
JC9E6			LDAA	M778C
			BNE	ZC9EF
			LDAA	#$C4
			BRA	ZC9F1
ZC9EF			ADDA	#$80
ZC9F1			JSR	LCD_WAIT
			STAA	LCD_CMD
			LDAA	#$0D
ZC9F9			JSR	LCD_WAIT
			STAA	LCD_CMD
			RTS
JCA00			CMPA	#$01
			BNE	ZC9DF
			LDAB	M7789
			BNE	ZCA10
			LDAA	M778C
			BEQ	ZCA3B
			BRA	ZC9EF
ZCA10			CMPB	#$01
			BEQ	ZCA27
ZCA14			LDAA	M778C
			CMPA	#$04
			BCS	ZCA1F
			SUBA	#$03
			BRA	ZC9EF
ZCA1F			LDAB	#$03
			MUL
			ADDB	#$C6
			TBA
			BRA	ZC9F1
ZCA27			LDAA	M778C
			BEQ	ZCA37
			CMPA	#$05
			BCS	ZCA34
			SUBA	#$04
			BRA	ZC9EF
ZCA34			DECA
			BRA	ZCA1F
ZCA37			LDAA	#$C4
			BRA	ZC9F1
ZCA3B			LDAA	#$CE
			BRA	ZC9F1
JCA3F			CMPA	#$01
			BNE	ZC9DF
			LDAB	M7789
			BEQ	ZCA54
			CMPB	#$03
			BEQ	ZCA54
			CMPB	#$06
			BEQ	ZCA54
			CMPB	#$09
			BNE	ZCA5D
ZCA54			LDAA	M778C
			BNE	ZC9EF
			LDAA	#$CD
			BRA	ZC9F1
ZCA5D			LDAA	M778C
			BEQ	ZCA37
			CMPA	#$02
			BCS	ZCA69
			DECA
			BRA	ZC9EF
ZCA69			LDAB	M777B
			LDAA	#$05
			JSR	F_AF64
			TST	$57,X
			BEQ	ZCA7A
			LDAA	#$CD
			JMP	ZC9F1
ZCA7A			LDAA	#$CF
			JMP	ZC9F1
JCA7F			CMPA	#$01
			BEQ	ZCA86
			JMP	ZC9DF
ZCA86			LDAA	M778C
			CMPA	#$04
			BCS	ZCA92
			SUBA	#$03
			JMP	ZC9EF
ZCA92			JMP	ZCA14
JCA95			CMPA	#$01
			BNE	ZCAA0
			LDAB	M7789
			CMPB	#$0F
			BEQ	ZCAA3
ZCAA0			JMP	ZC9DF
ZCAA3			LDAA	M778C
			ADDA	#$C6
ZCAA8			JMP	ZC9F1
JCAAB			LDAA	M778C
			ADDA	#$C0
			BRA	ZCAA8
ZCAB2			LDAA	M778C
ZCAB5			LDAB	#$04
			MUL
			TBA
			CMPA	#$10
			BCS	ZCABF
			SUBA	#$0F
ZCABF			ADDA	#$C2
			LDAB	M7772
			CMPB	#$06
			BEQ	ZCACF
			LDAB	M7774
			CMPB	#$3C
			BNE	ZCAA8
ZCACF			JSR	LCD_WAIT
			STAA	LCD_CMD
			LDAA	#$0E
			JMP	ZC9F9
ZCADA			LDAA	M778C
			LDAB	#$03
			MUL
			TBA
			CMPA	#$0C
			BCS	ZCAE7
			SUBA	#$0B
ZCAE7			ADDA	#$C4
			BRA	ZCAA8
ZCAEB			LDAA	M778C
			BEQ	ZCAFC
			CMPA	#$01
			BNE	ZCAF8
			LDAA	#$8F
			BRA	ZCAFE
ZCAF8			SUBA	#$02
			BRA	ZCAB5
ZCAFC			LDAA	#$8C
ZCAFE			BRA	ZCAA8
ZCB00			LDAB	M0059
			BEQ	ZCB06
			LDAB	#$04
ZCB06			ADDB	#$CA
			TBA
			JMP	ZC9F1
ZCB0C			CMPB	#$1B
			BNE	ZCB1D
			LDAA	M776B
			ANDA	#$08
			BNE	ZCB1A
			JMP	ZCAB2
ZCB1A			JMP	ZC9DF
ZCB1D			CMPB	#$1C
			BNE	ZCB1A
			LDAB	M7789
			ANDB	#$01
			BEQ	ZCB33
			LDAA	#$C0
			TST	M778C
			BEQ	ZCB3C
			LDAA	#$CF
			BRA	ZCB3C
ZCB33			LDAA	#$C6
			TST	M778C
			BEQ	ZCB3C
			ADDA	#$04
ZCB3C			JMP	ZC9F1

;-------

F_CB3F			TST	M776C
			BEQ	ZCB68
			TST	>M00CA
			BEQ	ZCB4E
			JSR	F_E66F
			BRA	ZCB68
ZCB4E			TST	>M00CB
			BEQ	ZCB56
			JSR	F_E6BD
ZCB56			LDX	M00B6
			CPX	M00BA
			BNE	ZCB6A
			LDAA	M00B3
			CMPA	#$01
			BCS	ZCBDC
			CLR	>M00B3
			OIM	#ECMI,TCSR3
ZCB68			BRA	ZCBDC
ZCB6A			LDD	#$0000
			STD	M00B0
			LDAA	,X
			CPX	#M7EE7
			BNE	ZCB79
			LDX	#M7E0B
ZCB79			INX
			STX	M00B6
			TSTA
			BPL	ZCBB3
			CMPA	#$FE
			BNE	ZCB8A
			LDAB	#$01
			STAB	M00AF
			CLR	>M00B2
ZCB8A			CMPA	#$F8
			BCC	ZCBDC
ZCB8E			STAA	M00BD
			CLR	>M00C4
			CMPA	#$F0
			BEQ	ZCBA6
			BCC	ZCBA4
			ANDA	#$0F
			TAB
			LDX	#M7F89
			ABX
			LDAA	,X
			STAA	M00DA
ZCBA4			BRA	F_CB3F
ZCBA6			AIM	#~ECMI,TCSR3
			LDAB	#$01
			STAB	M00B3
			BRA	F_CB3F
ZCBAF			LDAA	#$F7
			BRA	ZCB8E
ZCBB3			LDAB	M00BD
			CMPB	#$F0
			BCS	ZCBC3
			BHI	F_CB3F
			TST	M756C
			BEQ	ZCBAF
			JMP	ZD0C8
ZCBC3			LSRB
			LSRB
			LSRB
			LSRB
			ANDB	#$07

			JSR	JMPOFF1
			FCB	JCBE9 - *
			FCB	$01
			FCB	JCC40 - *
			FCB	$02
			FCB	ZCBDC - *
			FCB	$03
			FCB	JCBDD - *
			FCB	$04
			FCB	JCBE0 - *
			FCB	$05
			FCB	JCBE3 - *
			FCB	$06
			FCB	JCBE6 - *
			FCB	$07
			FCB	ZCBDC - *
			FCB	$00

ZCBDC			RTS
JCBDD			JMP	ZCDE3
JCBE0			JMP	ZCD33
JCBE3			JMP	ZCDCF
JCBE6			JMP	ZCCDC
JCBE9			TST	>M00C4
			BNE	ZCBF6
			INC	>M00C4
			STAA	M00BE
			JMP	F_CB3F
ZCBF6			CLR	>M00C4
ZCBF9			LDAB	M756B
			BEQ	ZCC07
			EORB	M00BE
			ANDB	#$01
			BEQ	ZCC07
			JMP	F_CB3F
ZCC07			AIM	#~ECMI,TCSR3
			AIM	#%11110111,TCSR1
			LDAB	M00BE
			STAB	M0051
			LDAA	M00DA
			CLRB
ZCC14			LSRA
			BCS	ZCC1B
			BEQ	ZCC37
			BRA	ZCC34
ZCC1B			PSHA
			PSHB
			JSR	F_EA9B
			JSR	F_ECDD
			LDAA	#$04
			STAA	M0058
			JSR	F_EDEA
			BVS	ZCC2F
			JSR	HI_CALL_1C
ZCC2F			JSR	F_EE1F
			PULB
			PULA
ZCC34			INCB
			BRA	ZCC14
ZCC37			OIM	#%00001000,TCSR1
			OIM	#ECMI,TCSR3
			JMP	F_CB3F
JCC40			TST	>M00C4
			BNE	ZCC4D
			INC	>M00C4
			STAA	M00BE
			JMP	F_CB3F
ZCC4D			CLR	>M00C4
			TSTA
			BEQ	ZCBF9
			LDAB	M756B
			BEQ	ZCC61
			EORB	M00BE
			ANDB	#$01
			BEQ	ZCC61
			JMP	F_CB3F
ZCC61			AIM	#~ECMI,TCSR3
			LDAB	M7772
			ANDB	#$03
			CMPB	#$02
			BNE	ZCC78
			LDAB	#$21
			STAB	M006E
			LDAB	#$01
			STAB	M00AE
			AIM	#%11011111,PORT6
ZCC78			AIM	#%11110111,TCSR1
			AIM	#%11111110,RP5CR
			STAA	M7769
			LDAB	M00BE
			STAB	M0052
			TAB
			LDX	#MDF94
			ABX
			LDAB	,X
			STAB	M00F1
			LDAA	M00DA
			CLRB
ZCC91			LSRA
			BCS	ZCC98
			BEQ	ZCCB1
			BRA	ZCCAE
ZCC98			PSHA
			PSHB
			JSR	F_EC77
			JSR	F_EA0E
			LDAA	#$04
			STAA	M0058
			JSR	F_ED8F
			BVS	ZCCAC
			JSR	HI_CALL_1D
ZCCAC			PULB
			PULA
ZCCAE			INCB
			BRA	ZCC91
ZCCB1			LDAA	M776B
			ANDA	#$02
			BEQ	ZCCD0
			TST	M7767
			BNE	ZCCD0
			LDAA	#$03
			STAA	M7767
			TST	M75F5
			BNE	ZCCCA
			JSR	F_ECFE
ZCCCA			JSR	F_A68F
			JSR	F_A68F
ZCCD0			OIM	#%00000001,RP5CR
			OIM	#%00001000,TCSR1
			OIM	#ECMI,TCSR3
			JMP	F_CB3F
ZCCDC			TST	>M00C4
			BNE	ZCCE7
			INC	>M00C4
			JMP	F_CB3F
ZCCE7			CLR	>M00C4
			TST	M756A
			BEQ	ZCD32
			ASLA
			LDX	#M7D83
			AIM	#~ECMI,TCSR3
			LDAB	TCSR1
			PSHB
			AIM	#%11110111,TCSR1
			LDAB	M7772
			ANDB	#$04
			BEQ	ZCD1E
			TST	M6E38
			BEQ	ZCD0F
			TST	>M00DA
			BNE	ZCD1A
			BRA	ZCD2C
ZCD0F			LDAB	M00BD
			ANDB	#$0F
			ADDB	#$02
			CMPB	M756A
			BNE	ZCD1E
ZCD1A			LDAB	#$FF
			BRA	ZCD20
ZCD1E			LDAB	M00DA
ZCD20			LSRB
			BCS	ZCD27
			BEQ	ZCD2C
			BRA	ZCD29
ZCD27			STAA	,X
ZCD29			INX
			BRA	ZCD20
ZCD2C			PULB
			STAB	TCSR1
			OIM	#ECMI,TCSR3
ZCD32			RTS
ZCD33			TST	M7568
			BEQ	ZCD99
			LDAB	M7772
			CMPB	#$02
			BEQ	ZCD43
			CMPB	#$06
			BNE	ZCD99
ZCD43			LDAB	M7568
			CMPB	#$02
			BEQ	ZCD9A
ZCD4A			LDAB	M00BD
			ANDB	#$0F
			CMPB	M7566
			BEQ	ZCD5C
			LDAB	M7566
			CMPB	#$10
			BEQ	ZCD5C
			BRA	ZCD99
ZCD5C			TAB
			LDX	#M7571
			ABX
			LDAB	,X
			LDAA	M7772
			CMPA	#$02
			BNE	ZCD83
			CMPB	#$A0
			BCS	ZCD92
			LDAA	#$01
			STAA	M00CC
			PSHB
			LDAB	#$07
			JSR	F_8A08
			PULB
ZCD79			SUBB	#$A0
			LDAA	#$01
			STAA	M00CC
			JSR	F_8A64
			RTS
ZCD83			CMPB	#$A0
			BCC	ZCD79
			LDAA	#$01
			STAA	M00CC
			PSHB
			LDAB	#$07
			JSR	F_8A08
			PULB
ZCD92			LDAA	#$01
			STAA	M00CC
			JSR	F_8A81
ZCD99			RTS
ZCD9A			LDAB	M7772
			CMPB	#$02
			BEQ	ZCD4A
			TAB
			LDX	#M7571
			ABX
			LDAB	,X
			CMPB	#$A0
			BCC	ZCD99
			LDAA	M00DA
			CLRB
ZCDAF			LSRA
			BCS	ZCDB6
			BEQ	ZCDC8
			BRA	ZCDC5
ZCDB6			PSHA
			PSHB
			PSHX
			LDAA	#$01
			STAA	M00CC
			LDAA	,X
			JSR	F_D052
			PULX
			PULB
			PULA
ZCDC5			INCB
			BRA	ZCDAF
ZCDC8			JSR	F_C95A
			JSR	F_C972
			RTS
ZCDCF			TST	M756F
			BNE	ZCDD5
			RTS
ZCDD5			TST	M7569
			BNE	ZCDDB
			RTS
ZCDDB			ASLA
			LDX	#M7D5B
			JSR	F_D012
			RTS
ZCDE3			TST	>M00C4
			BNE	ZCDF0
			INC	>M00C4
			STAA	M00BE
			JMP	F_CB3F
ZCDF0			CLR	>M00C4
			LDAB	M00BE
			CMPB	#$40
			BEQ	ZCE0C
			CMPB	#$7B
			BEQ	ZCE0C
			CMPB	#$7E
			BEQ	ZCE0C
			CMPB	#$7F
			BEQ	ZCE0C
			TST	M7569
			BEQ	ZCE39
			LDAB	M00BE

ZCE0C			JSR	JMPOFF1
			FCB	ZCE39 - *
			FCB	$01
			FCB	JCE43 - *
			FCB	$02
			FCB	JCE4B - *
			FCB	$03
			FCB	ZCE39 - *
			FCB	$04
			FCB	JCE58 - *
			FCB	$05
			FCB	JCE6A - *
			FCB	$06
			FCB	JCE9E - *
			FCB	$07
			FCB	JCE60 - *
			FCB	$08
			FCB	ZCE39 - *
			FCB	$0A
			FCB	JCE40 - *
			FCB	$0B
			FCB	ZCE39 - *
			FCB	$40
			FCB	JCEA0 - *
			FCB	$41
			FCB	JCEEB - *
			FCB	$42
			FCB	ZCE39 - *
			FCB	$60
			FCB	JCE9F - *
			FCB	$62
			FCB	ZCE39 - *
			FCB	$7B
			FCB	ZCF2C - *
			FCB	$7C
			FCB	ZCE39 - *
			FCB	$7E
			FCB	JCE3A - *
			FCB	$7F
			FCB	JCE3D - *
			FCB	$80
			FCB	ZCE39 - *
			FCB	$00

ZCE39			RTS
JCE3A			JMP	ZCF52
JCE3D			JMP	ZCF84
JCE40			JMP	ZCFA5
JCE43			ASLA
			LDX	#M7D53
			JSR	F_D012
			RTS
JCE4B			TST	M756F
			BNE	ZCE57
			ASLA
			LDX	#M7D5B
			JSR	F_D012
ZCE57			RTS
JCE58			ASLA
			LDX	#M7D63
			JSR	F_D012
			RTS
JCE60			ASLA
			COMA
			DECA
			LDX	#M7D6B
			JSR	F_D012
			RTS
JCE6A			LDAB	M7772
			ANDB	#$04
			BNE	ZCE9D
			LDAB	M7566
			CMPB	#$10
			BEQ	ZCE81
			LDAB	M00BD
			ANDB	#$0F
			CMPB	M7566
			BNE	ZCE9D
ZCE81			JSR	F_9091
			CMPA	M6AA9
			BEQ	ZCE9D
			STAA	M6AA9
			LDX	#F_A049
			JSR	F_92E3
ZCE92			LDAA	#$01
			STAA	M7792
			JSR	F_C95A
			JSR	F_C972
ZCE9D			RTS
JCE9E			RTS
JCE9F			RTS
JCEA0			AIM	#~ECMI,TCSR3
			LDAB	TCSR1
			PSHB
			AIM	#%11110111,TCSR1
			LDX	#M0041
			LDAB	M00DA
			CMPA	#$40
			BCC	ZCECB
			CLRA
ZCEB3			LSRB
			BCS	ZCEBA
			BEQ	ZCEE4
			BRA	ZCEC7
ZCEBA			AIM	#%01111111,$00,X
			PSHX
			PSHB
			PSHA
			TAB
			JSR	F_885F
			PULA
			PULB
			PULX
ZCEC7			INX
			INCA
			BRA	ZCEB3
ZCECB			CLRA
ZCECC			LSRB
			BCS	ZCED3
			BEQ	ZCEE4
			BRA	ZCEE0
ZCED3			OIM	#%10000000,$00,X
			PSHX
			PSHB
			PSHA
			TAB
			JSR	F_885F
			PULA
			PULB
			PULX
ZCEE0			INX
			INCA
			BRA	ZCECC
ZCEE4			PULB
			STAB	TCSR1
			OIM	#ECMI,TCSR3
			RTS
JCEEB			AIM	#~ECMI,TCSR3
			LDAB	TCSR1
			PSHB
			AIM	#%11110111,TCSR1
			LDX	#M0041
			LDAB	M7772
			ANDB	#$04
			BEQ	ZCF0D
			LDAB	M00BD
			ANDB	#$0F
			ADDB	#$02
			CMPB	M7569
			BNE	ZCF0D
			LDAB	#$FF
			BRA	ZCF0F
ZCF0D			LDAB	M00DA
ZCF0F			LSRB
			BCS	ZCF16
			BEQ	ZCF25
			BRA	ZCF22
ZCF16			CMPA	#$40
			BCC	ZCF1F
			AIM	#%10111111,$00,X
			BRA	ZCF22
ZCF1F			OIM	#%01000000,$00,X
ZCF22			INX
			BRA	ZCF0F
ZCF25			PULB
			STAB	TCSR1
			OIM	#ECMI,TCSR3
			RTS
ZCF2C			AIM	#~ECMI,TCSR3
			AIM	#%11110111,TCSR1
			LDAA	M00DA
			CLRB
ZCF35			LSRA
			BCS	ZCF3C
			BEQ	ZCF4B
			BRA	ZCF48
ZCF3C			PSHA
			PSHB
			JSR	F_E78F
			PULB
			PSHB
			JSR	F_E9C9
			PULB
			PULA
ZCF48			INCB
			BRA	ZCF35
ZCF4B			OIM	#%00001000,TCSR1
			OIM	#ECMI,TCSR3
			RTS
ZCF52			LDAB	M7772
			ANDB	#$04
			BNE	ZCF83
			LDAB	M7566
			CMPB	#$10
			BEQ	ZCF69
			LDAB	M00BD
			ANDB	#$0F
			CMPB	M7566
			BNE	ZCF83
ZCF69			CMPA	#$01
			BNE	ZCF2C
			TST	M6AA6
			BNE	ZCF2C
			LDAA	#$01
			STAA	M6AA6
ZCF77			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JMP	ZCE92
ZCF83			RTS
ZCF84			LDAB	M7772
			ANDB	#$04
			BNE	ZCF83
			LDAB	M7566
			CMPB	#$10
			BEQ	ZCF9B
			LDAB	M00BD
			ANDB	#$0F
			CMPB	M7566
			BNE	ZCF83
ZCF9B			TST	M6AA6
			BEQ	ZCF2C
			CLR	M6AA6
			BRA	ZCF77
ZCFA5			AIM	#~ECMI,TCSR3
			LDAB	TCSR1
			PSHB
			AIM	#%11110111,TCSR1
			LDAB	M7772
			BITB	#$04
			BEQ	ZD00B
			LDAB	M00BD
			ANDB	#$0F
			ADDB	#$02
			CMPB	M7569
			BNE	ZCFC4
			LDAB	#$FF
			BRA	ZCFC6
ZCFC4			LDAB	M00DA
ZCFC6			CMPA	#$56
			BCC	ZCFD2
			CMPA	#$2B
			BCC	ZCFD6
			LDAA	#$01
			BRA	ZCFD8
ZCFD2			LDAA	#$02
			BRA	ZCFD8
ZCFD6			LDAA	#$03
ZCFD8			LDX	#M6DE0
			CLR	>M00C0
ZCFDE			LSRB
			BCS	ZCFE5
			BEQ	ZCFF8
			BRA	ZCFF1
ZCFE5			TST	,X
			BEQ	ZCFF1
			CMPA	,X
			BEQ	ZCFF1
			STAA	,X
			STAA	M00C0
ZCFF1			PSHB
			LDAB	#$0C
			ABX
			PULB
			BRA	ZCFDE
ZCFF8			TST	>M00C0
			BEQ	ZD00B
			JSR	F_95E5
			LDAA	#$01
			STAA	M7791
			JSR	F_C95A
			JSR	F_C972
ZD00B			PULB
			STAB	TCSR1
			OIM	#ECMI,TCSR3
			RTS

F_D012			AIM	#~ECMI,TCSR3
			LDAB	TCSR1
			PSHB
			AIM	#%11110111,TCSR1
			LDAB	M7772
			ANDB	#$04
			BEQ	ZD03D
			TST	M6E38
			BEQ	ZD02E
			TST	>M00DA
			BNE	ZD039
			BRA	ZD04B
ZD02E			LDAB	M00BD
			ANDB	#$0F
			ADDB	#$02
			CMPB	M7569
			BNE	ZD03D
ZD039			LDAB	#$FF
			BRA	ZD03F
ZD03D			LDAB	M00DA
ZD03F			LSRB
			BCS	ZD046
			BEQ	ZD04B
			BRA	ZD048
ZD046			STAA	,X
ZD048			INX
			BRA	ZD03F
ZD04B			PULB
			STAB	TCSR1
			OIM	#ECMI,TCSR3
			RTS

F_D052			STAB	M0073
			PSHA
			LDX	#M6DD7
			LDAB	M0073
			LDAA	#$0C
			MUL
			ABX
			PULB
			CMPB	$02,X
			BEQ	ZD098
			STAB	$02,X
			LDAA	#$01
			STAA	M7791

F_D06A			PSHB
			AIM	#~ECMI,TCSR3
			AIM	#%11110111,TCSR1
			LDAB	M0073
			JSR	F_D099
			PULB
			JSR	F_AEE0
			STX	M00A9
			LDAA	M0073
			JSR	F_9A2F
			JSR	LO_CALL_00
			LDAB	M0073
			STAB	M009F
			LDAB	#$0C
			STAB	XROM
			JSR	XROM_CALL
			JSR	F_94C9
			OIM	#%00001000,TCSR1
			OIM	#ECMI,TCSR3
ZD098			RTS

F_D099			LDAA	TCSR1
			PSHA
			AIM	#%11110111,TCSR1
			PSHB
			JSR	F_95A4
			PULB
			PSHB
			LDX	#M0041
			ABX
			AIM	#%01111111,$00,X
			JSR	F_885F
			PULB
			PSHB
			JSR	F_E78F
			PULB
			TSTB
			BNE	ZD0C4
			PSHB
			JSR	HI_CALL_16
			LDAB	#$7C
			STAB	M0058
			PULB
			JSR	F_E821
ZD0C4			PULA
			STAA	TCSR1
			RTS
ZD0C8			LDAB	M00C4
			CMPB	#$FA
			BEQ	ZD0FE
			BCC	ZD101
			CMPB	#$0F
			BCC	ZD0FB
			LDX	#MD0DD
			ASLB
			ABX
			LDX	,X
			JMP	,X

MD0DD			FDB	MD10B_via_cvec_d0dd
			FDB	MD11A_via_cvec_d0df
			FDB	MD148_via_cvec_d0e1
			FDB	MD191_via_cvec_d0e3
			FDB	MD1A7_via_cvec_d0e5
			FDB	MD207_via_cvec_d0e7
			FDB	MD256_via_cvec_d0e9
			FDB	MD296_via_cvec_d0eb
			FDB	MD296_via_cvec_d0eb
			FDB	MD296_via_cvec_d0eb
			FDB	MD296_via_cvec_d0eb
			FDB	MD296_via_cvec_d0eb
			FDB	MD296_via_cvec_d0eb
			FDB	MD2D6_via_cvec_d0f7
			FDB	MD2D6_via_cvec_d0f7

ZD0FB			JMP	ZD304
ZD0FE			JMP	ZD320
ZD101			JMP	ZD104
ZD104			LDAA	#$F7
			STAA	M00BD
			JMP	F_CB3F
MD10B_via_cvec_d0dd	STAA	M00BE
			CMPA	#$43
			BNE	ZD117
			INC	>M00C4
			JMP	F_CB3F
ZD117			JMP	ZD104
MD11A_via_cvec_d0df	TAB
			ANDA	#$F0
			STAA	M00BF
			CMPB	#$10
			BCS	ZD12D
			CMPB	#$20
			BCS	ZD131
			CMPB	#$30
			BCS	ZD131
			BRA	ZD145
ZD12D			LDAA	#$01
			STAA	M00B2
ZD131			LDAA	M7566
			CMPA	#$10
			BEQ	ZD13F
			ANDB	#$0F
			CMPB	M7566
			BNE	ZD145
ZD13F			INC	>M00C4
			JMP	F_CB3F
ZD145			JMP	ZD104
MD148_via_cvec_d0e1	STAA	M00C0
			LDAB	M00BF
			CMPB	#$10
			BCS	ZD16D
			BEQ	ZD17C
			CMPA	#$03
			BNE	ZD15C
			JSR	F_D326
			JMP	ZD104
ZD15C			CMPA	#$04
			BNE	ZD166
			JSR	F_D33D
			JMP	ZD104
ZD166			CMPA	#$7E
			BEQ	ZD18B
			JMP	ZD104
ZD16D			CMPA	#$03
			BEQ	ZD18B
			CMPA	#$04
			BEQ	ZD18B
			CMPA	#$7E
			BEQ	ZD18B
			JMP	ZD104
ZD17C			CMPA	#$10
			BEQ	ZD18B
			CMPA	#$12
			BEQ	ZD18B
			CMPA	#$13
			BEQ	ZD18B
			JMP	ZD104
ZD18B			INC	>M00C4
			JMP	F_CB3F
MD191_via_cvec_d0e3	STAA	M00C1
			LDAB	M00BF
			CMPB	#$20
			BCS	ZD1A1
			JSR	F_D3A7
			BCC	ZD1A1
			JMP	ZD104
ZD1A1			INC	>M00C4
			JMP	F_CB3F
MD1A7_via_cvec_d0e5	STAA	M00C2
			LDAB	M00BF
			CMPB	#$10
			BCS	ZD1D7
			BEQ	ZD1BF
			JSR	F_D3A7
			BCC	ZD1B9
			JMP	ZD104
ZD1B9			INC	>M00C4
			JMP	F_CB3F
ZD1BF			LDAB	M00C0
			CMPB	#$10
			BNE	ZD1D1
			LDAA	M00C1
			CMPA	#$7B
			BCS	ZD1D1
			INC	>M00C4
			JMP	F_CB3F
ZD1D1			JSR	F_D8DD
			JMP	ZD104
ZD1D7			TST	M756C
			BEQ	ZD1E8
			LDAB	M00C0
			CMPB	#$03
			BEQ	ZD1EB
			CMPB	#$04
			BEQ	ZD1F6
			BRA	ZD201
ZD1E8			JMP	ZD104
ZD1EB			JSR	F_D480
			BCS	ZD1E8
			INC	>M00C4
			JMP	F_CB3F
ZD1F6			JSR	F_D4A1
			BCS	ZD1E8
			INC	>M00C4
			JMP	F_CB3F
ZD201			INC	>M00C4
			JMP	F_CB3F
MD207_via_cvec_d0e7	STAA	>M00C3
			LDAB	M00BF
			CMPB	#$10
			BCS	ZD232
			BEQ	ZD220
			JSR	F_D3A7
			BCC	ZD21A
			JMP	ZD104
ZD21A			INC	>M00C4
			JMP	F_CB3F
ZD220			LDAB	M00C1
			CMPB	#$7D
			BCC	ZD22C
			JSR	F_D8DD
			JMP	ZD104
ZD22C			INC	>M00C4
			JMP	F_CB3F
ZD232			LDAB	M00C0
			CMPB	#$03
			BEQ	ZD24A
			CMPB	#$04
			BEQ	ZD250
			JSR	F_D3A1
			BCC	ZD244
			JMP	ZD104
ZD244			INC	>M00C4
			JMP	F_CB3F
ZD24A			JSR	F_D520
			JMP	F_CB3F
ZD250			JSR	F_D547
			JMP	F_CB3F
MD256_via_cvec_d0e9	LDAB	M00BF
			CMPB	#$10
			BCS	ZD272
			BEQ	ZD26C
			JSR	F_D3A7
			BCC	ZD266
			JMP	ZD104
ZD266			INC	>M00C4
			JMP	F_CB3F
ZD26C			JSR	F_D8DD
			JMP	ZD104
ZD272			LDAB	M00C0
			CMPB	#$03
			BEQ	ZD28A
			CMPB	#$04
			BEQ	ZD290
			JSR	F_D3A1
			BCC	ZD284
			JMP	ZD104
ZD284			INC	>M00C4
			JMP	F_CB3F
ZD28A			JSR	F_D520
			JMP	F_CB3F
ZD290			JSR	F_D547
			JMP	F_CB3F
MD296_via_cvec_d0eb	LDAB	M00BF
			CMPB	#$10
			BCS	ZD2B2
			JSR	F_D3A7
			BVS	ZD2AC
			BCC	ZD2A6
			JMP	ZD104
ZD2A6			INC	>M00C4
			JMP	F_CB3F
ZD2AC			JSR	F_D35B
			JMP	ZD104
ZD2B2			LDAB	M00C0
			CMPB	#$03
			BEQ	ZD2CA
			CMPB	#$04
			BEQ	ZD2D0
			JSR	F_D3A1
			BCC	ZD2C4
			JMP	ZD104
ZD2C4			INC	>M00C4
			JMP	F_CB3F
ZD2CA			JSR	F_D520
			JMP	F_CB3F
ZD2D0			JSR	F_D547
			JMP	F_CB3F
MD2D6_via_cvec_d0f7	LDAB	M00C0
			CMPB	#$03
			BEQ	ZD2F8
			CMPB	#$04
			BEQ	ZD2FE
			JSR	F_D3A1
			BVS	ZD2EA
			BCC	ZD2F2
			JMP	ZD104
ZD2EA			JSR	F_D4C5
			BCC	ZD2F2
			JMP	ZD104
ZD2F2			INC	>M00C4
			JMP	F_CB3F
ZD2F8			JSR	F_D520
			JMP	F_CB3F
ZD2FE			JSR	F_D547
			JMP	F_CB3F
ZD304			LDAB	M00C0
			CMPB	#$03
			BEQ	ZD314
			CMPB	#$04
			BEQ	ZD31A
			JSR	F_D593
			JMP	F_CB3F
ZD314			JSR	F_D520
			JMP	F_CB3F
ZD31A			JSR	F_D547
			JMP	F_CB3F
ZD320			JSR	F_D730
			JMP	ZD104

F_D326			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			LDAA	#$01
			STAA	M00CC
			JSR	F_DE39
			CLR	>M00CC
			JSR	F_E16B
			RTS

F_D33D			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			LDAB	#$0C
			JSR	LCD_WAIT
			STAB	LCD_CMD
			CLR	>M00CC
			JSR	F_E11D
			JSR	F_C95A
			JSR	F_C972
			RTS

F_D35B			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			LDAB	#$0C
			JSR	LCD_WAIT
			STAB	LCD_CMD
			CLR	>M00CC
			LDAB	M00C9
			SUBB	#$78
			ASLB
			LDX	#MD383
			ABX
			LDX	,X
			JSR	,X
			JSR	F_C95A
			JSR	F_C972
			RTS

MD383			FDB	ME3EB_via_cvec_d383
			FDB	ME456_via_cvec_d385
			FDB	ME4C1_via_cvec_bc10
			FDB	ME543_via_cvec_bc12
			FDB	ME5BE_via_cvec_bc14
			FDB	ME383_via_cvec_d38d
			FDB	ME245_via_cvec_d38f
			FDB	MD393_via_cvec_d391

MD393_via_cvec_d391	LDAA	#$01
			STAA	M00CC
			JSR	F_DE39
			CLR	>M00CC
			JSR	F_E178
			RTS

F_D3A1			LDAB	M00C4
			SUBB	#$05
			BRA	ZD3AB
F_D3A7			LDAB	M00C4
			SUBB	#$03
ZD3AB			CMPB	#$04
			BCS	ZD3B9
			BEQ	ZD3C7
			CMPB	#$08
			BCS	ZD3DD
			BEQ	ZD402
			BCC	ZD407
ZD3B9			LDX	#S_LM
			ABX
			CMPA	,X
			BNE	ZD3C4
			CLC
			CLV
			RTS
ZD3C4			SEC
			CLV
			RTS
ZD3C7			CMPA	#$38
			BNE	ZD3D1
			CLR	>M00C9
			CLC
			CLV
			RTS
ZD3D1			CMPA	#$4D
			BNE	ZD3DA
			STAA	M00C9
			CLC
			CLV
			RTS
ZD3DA			SEC
			CLV
			RTS
ZD3DD			TST	>M00C9
			BNE	ZD3F2
			LDX	#S_976
			SUBB	#$05
			ABX
			CMPA	,X
			BNE	ZD3EF
			CLC
			CLV
			RTS
ZD3EF			SEC
			CLV
			RTS
ZD3F2			LDX	#S_CRT
			SUBB	#$05
			ABX
			CMPA	,X
			BNE	ZD3FF
			CLC
			CLV
			RTS
ZD3FF			SEC
			CLV
			RTS
ZD402			STAA	M00BE
			CLC
			CLV
			RTS
ZD407			TAB
			LDAA	M00BE
			XGDX
			TST	>M00C9
			BNE	ZD45B
			CPX	#$5330
			BNE	ZD41C
			LDAA	#$7A
			STAA	M00C9
			CLC
			SEV
			RTS
ZD41C			CPX	#$5331
			BNE	ZD428
			LDAA	#$7B
			STAA	M00C9
			CLC
			SEV
			RTS
ZD428			CPX	#$5332
			BNE	ZD434
			LDAA	#$7C
			STAA	M00C9
			CLC
			SEV
			RTS
ZD434			CPX	#$5045
			BNE	ZD440
			LDAA	#$7D
			STAA	M00C9
			CLC
			SEV
			RTS
ZD440			CPX	#$504D
			BNE	ZD44C
			LDAA	#$7E
			STAA	M00C9
			CLC
			SEV
			RTS
ZD44C			CPX	#$4145
			BNE	ZD458
			LDAA	#$7F
			STAA	M00C9
			CLC
			SEV
			RTS
ZD458			SEC
			CLV
			RTS
ZD45B			CPX	#$4530
			BNE	ZD467
			LDAA	#$78
			STAA	M00C9
			CLC
			SEV
			RTS
ZD467			CPX	#$4531
			BNE	ZD473
			LDAA	#$79
			STAA	M00C9
			CLC
			SEV
			RTS
ZD473			SEC
			CLV
			RTS

S_LM			FCC	"LM  "
S_976			FCC	"976"
S_CRT			FCC	"CRT"

F_D480			TST	>M00C1
			BNE	ZD49F
			LDAA	M00C2
			CMPA	#$5D
			BNE	ZD49F
			LDAA	#$03
			STAA	M00C9
			TST	>M00DF
			BNE	ZD49A
			LDAB	M7773
			JSR	HI_CALL_19
ZD49A			CLR	>M00C6
			CLC
			RTS
ZD49F			SEC
			RTS

F_D4A1			TST	M756D
			BEQ	ZD4AB
			JSR	F_D879
			BRA	ZD4C3
ZD4AB			LDAA	M00C1
			DECA
			CMPA	#$20
			BCC	ZD4C3
			TST	>M00C2
			BNE	ZD4C3
			LDAA	#$04
			STAA	M00C9
			CLR	>M00C8
			CLR	>M00C6
			CLC
			RTS
ZD4C3			SEC
			RTS

F_D4C5			LDAB	M00C9
			CMPB	#$7F
			BEQ	ZD4DD
			CMPB	#$7D
			BEQ	ZD4DD
			CMPB	#$03
			BEQ	ZD4DD
			TST	M756D
			BEQ	ZD4DD
			JSR	F_D879
			SEC
			RTS
ZD4DD			SUBB	#$78
			LDX	#MD508
			ABX
			ASLB
			ABX
			LDAA	M00C1
			LDAB	M00C2
			CMPA	,X
			BNE	ZD506
			CMPB	$01,X
			BNE	ZD506
			LDAA	$02,X
			STAA	M00C6
			LDAB	M00C9
			CMPB	#$7F
			BNE	ZD501
			LDAB	M7773
			JSR	HI_CALL_19
ZD501			CLR	>M00C8
			CLC
			RTS
ZD506			SEC
			RTS

MD508			FCB	$00,$22,$84,$02,$0A,$85,$00,$25,$3A,$02,$0A,$3B,$00
			FCB	$41,$3C,$00,$78,$4C,$13,$0A,$54,$00,$21,$3D

F_D520			AIM	#~ECMI,TCSR3
			LDAB	#$01
			STAB	M00B3
			LDAB	M00C4
			SUBB	#$05
			CMPB	#$57
			BCC	ZD535
			LDX	#M6A67
			ABX
			STAA	,X
ZD535			ADDA	M00C6
			STAA	M00C6
			LDAA	M00C4
			INCA
			STAA	M00C4
			CMPA	#$62
			BNE	ZD546
			LDAA	#$FA
			STAA	M00C4
ZD546			RTS

F_D547			AIM	#~ECMI,TCSR3
			LDAB	#$01
			STAB	M00B3
			PSHA
			LDAA	M00C8
			LDAB	#$4E
			MUL
			ADDD	#USER_VOICE
			XGDX
			PULA
			LDAB	M00C4
			SUBB	#$05
			CMPB	#$54
			BCC	ZD56E
			CMPB	#$43
			BCS	ZD56B
			CMPB	#$49
			BCS	ZD56E
			SUBB	#$06
ZD56B			ABX
			STAA	,X
ZD56E			ADDA	M00C6
			STAA	M00C6
			INC	>M00C4
			LDAA	M00C4
			CMPA	#$85
			BEQ	ZD57C
			RTS
ZD57C			INC	>M00C8
			LDAA	M00C8
			CMPA	M00C1
			BEQ	ZD58E
			CMPA	#$20
			BEQ	ZD58E
			LDAB	#$05
			STAB	M00C4
			RTS
ZD58E			LDAA	#$FA
			STAA	M00C4
			RTS

F_D593			AIM	#~ECMI,TCSR3
			LDAB	#$01
			STAB	M00B3
			LDAB	M00C9
			SUBB	#$78
			LDX	#MD5A7
			ASLB
			ABX
			LDX	,X
			JMP	,X

MD5A7			FDB	MD5B7_via_cvec_d5a7
			FDB	MD5D7_via_cvec_d5a9
			FDB	MD619_via_cvec_d5ab
			FDB	MD64B_via_cvec_d5ad
			FDB	MD694_via_cvec_d5af
			FDB	MD6B4_via_cvec_d5b1
			FDB	MD6D4_via_cvec_d5b3
			FDB	MD710_via_cvec_d5b5

MD5B7_via_cvec_d5a7	LDAB	M00C4
			SUBB	#$0F
			CMPB	#$18
			BCC	ZD5C5
			LDX	#M7628
			ABX
			STAA	,X
ZD5C5			ADDA	M00C6
			STAA	M00C6
			LDAA	M00C4
			INCA
			STAA	M00C4
			CMPA	#$27
			BNE	ZD5D6
			LDAA	#$FA
			STAA	M00C4
ZD5D6			RTS
MD5D7_via_cvec_d5a9	TST	>M00C8
			BNE	ZD5FD
			LDAB	M00C4
			SUBB	#$0F
			LDX	#M7640
			ABX
			STAA	,X
			ADDA	M00C6
			STAA	M00C6
			INC	>M00C4
			LDAA	M00C4
			CMPA	#$8F
			BCC	ZD5F4
			RTS
ZD5F4			LDAA	#$01
			STAA	M00C8
			LDAA	#$0F
			STAA	M00C4
			RTS
ZD5FD			LDAB	M00C4
			SUBB	#$0F
			LDX	#M76C0
			ABX
			STAA	,X
			ADDA	M00C6
			STAA	M00C6
			INC	>M00C4
			LDAA	M00C4
			CMPA	#$8F
			BNE	ZD618
			LDAA	#$FA
			STAA	M00C4
ZD618			RTS
MD619_via_cvec_d5ab	LDAB	M00C4
			SUBB	#$0F
			CMPB	#$0B
			BCC	ZD62F
			LDX	#M7565
			ABX
			STAA	,X
			ADDA	M00C6
			STAA	M00C6
			INC	>M00C4
			RTS
ZD62F			CMPB	#$1B
			BCC	ZD639
			LDX	#M7735
			ABX
			STAA	,X
ZD639			ADDA	M00C6
			STAA	M00C6
			LDAA	M00C4
			INCA
			STAA	M00C4
			CMPA	#$2A
			BNE	ZD64A
			LDAA	#$FA
			STAA	M00C4
ZD64A			RTS
MD64B_via_cvec_d5ad	LDX	#M7571
			LDAB	M00C4
			SUBB	#$0F
			ABX
			TST	>M00C8
			BNE	ZD676
			BITA	#$01
			BNE	ZD668
			ADDA	M00C6
			STAA	M00C6
			LDAA	,X
			ANDA	#$7F
			STAA	,X
			BRA	ZD672
ZD668			ADDA	M00C6
			STAA	M00C6
			LDAA	,X
			ORAA	#$80
			STAA	,X
ZD672			COM	>M00C8
			RTS
ZD676			TAB
			ADDA	M00C6
			STAA	M00C6
			TBA
			LDAB	,X
			ANDB	#$80
			ABA
			STAA	,X
			COM	>M00C8
			INC	>M00C4
			LDAB	M00C4
			CMPB	#$8F
			BNE	ZD693
			LDAA	#$FA
			STAA	M00C4
ZD693			RTS
MD694_via_cvec_d5af	LDAB	M00C4
			SUBB	#$0F
			CMPB	#$37
			BCC	ZD6A2
			LDX	#M75F1
			ABX
			STAA	,X
ZD6A2			ADDA	M00C6
			STAA	M00C6
			LDAA	M00C4
			INCA
			STAA	M00C4
			CMPA	#$46
			BNE	ZD6B3
			LDAA	#$FA
			STAA	M00C4
ZD6B3			RTS
MD6B4_via_cvec_d5b1	LDAB	M00C4
			SUBB	#$0F
			CMPB	#$6E
			BCC	ZD6C2
			LDX	#M6DD7
			ABX
			STAA	,X
ZD6C2			ADDA	M00C6
			STAA	M00C6
			LDAA	M00C4
			INCA
			STAA	M00C4
			CMPA	#$7D
			BNE	ZD6D3
			LDAA	#$FA
			STAA	M00C4
ZD6D3			RTS
MD6D4_via_cvec_d5b3	PSHA
			LDAA	M00C8
			CMPA	#$18
			BCS	ZD6DE
			PULA
			BRA	ZD6F1
ZD6DE			LDAB	#$4C
			MUL
			ADDD	#USER_PFM
			XGDX
			PULA
			LDAB	M00C4
			SUBB	#$0F
			CMPB	#$4C
			BCC	ZD6F1
			ABX
			STAA	,X
ZD6F1			ADDA	M00C6
			STAA	M00C6
			LDAA	M00C4
			INCA
			STAA	M00C4
			CMPA	#$5B
			BNE	ZD70F
			LDAA	#$FA
			STAA	M00C4
			LDAA	M00C8
			INCA
			STAA	M00C8
			CMPA	#$20
			BEQ	ZD70F
			LDAB	#$0F
			STAB	M00C4
ZD70F			RTS
MD710_via_cvec_d5b5	LDAB	M00C4
			SUBB	#$0F
			CMPB	#$17
			BCC	ZD71E
			LDX	#M6ABE
			ABX
			STAA	,X
ZD71E			ADDA	M00C6
			STAA	M00C6
			LDAA	M00C4
			INCA
			STAA	M00C4
			CMPA	#$26
			BNE	ZD72F
			LDAA	#$FA
			STAA	M00C4
ZD72F			RTS

F_D730			CLR	>M00B3
			ADDA	M00C6
			ANDA	#$7F
			BEQ	ZD749
			SUBA	#$30
			ANDA	#$7F
			BEQ	ZD749
			ADDA	#$70
			ANDA	#$7F
			BEQ	ZD749
			JSR	F_D87E
			RTS
ZD749			LDAB	M00C9
			CMPB	#$03
			BEQ	ZD75E
			CMPB	#$04
			BEQ	ZD761
			SUBB	#$78
			LDX	#MD764
			ASLB
			ABX
			LDX	,X
			JMP	,X
ZD75E			JMP	ZD774
ZD761			JMP	ZD7BD

MD764			FDB	MD7D4_via_cvec_d764
			FDB	MD7E7_via_cvec_d766
			FDB	MD7FA_via_cvec_d768
			FDB	MD80D_via_cvec_d76a
			FDB	MD81D_via_cvec_d76c
			FDB	MD830_via_cvec_d76e
			FDB	MD863_via_cvec_d770
			FDB	MD874_via_cvec_d772

ZD774			TST	>M00DF
			BNE	ZD77C
			JSR	HI_CALL_12
ZD77C			CLR	>M00DF
			JSR	LO_CALL_08
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			LDAA	M7772
			BITA	#$04
			BEQ	ZD7A2
			LDX	#M6A67
			STX	M00A9
			LDX	#M69C1
			JSR	LO_CALL_06
			JSR	F_B805
			BRA	ZD7A5
ZD7A2			JSR	F_91FE
ZD7A5			LDAA	#$01
			STAA	M7792
			CLR	M7793
			LDD	#$0101
			STD	M776E
			STD	M7770
			JSR	F_C95A
			JSR	F_C972
			RTS
ZD7BD			LDAA	M7772
			BITA	#$04
			BNE	ZD7D0
			JSR	HI_CALL_1B
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
ZD7D0			JSR	F_D883
			RTS
MD7D4_via_cvec_d764	JSR	HI_CALL_09
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_D8BB
			JSR	F_D883
			RTS
MD7E7_via_cvec_d766	JSR	HI_CALL_09
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_D8BB
			JSR	F_D883
			RTS
MD7FA_via_cvec_d768	JSR	HI_CALL_09
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_D8BB
			JSR	F_D883
			RTS
MD80D_via_cvec_d76a	JSR	HI_CALL_09
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_D883
			RTS
MD81D_via_cvec_d76c	JSR	HI_CALL_09
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_D8BB
			JSR	F_D883
			RTS
MD830_via_cvec_d76e	LDAA	#$08
			LDAB	#$0C
			LDX	#M6DD7
ZD837			ASL	$02,X
			ASR	$01,X
			ROR	$02,X
			ABX
			DECA
			BNE	ZD837
			JSR	LO_CALL_0A
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			LDAA	M7772
			BITA	#$04
			BEQ	ZD857
			JSR	F_B805
ZD857			LDAA	#$01
			STAA	M7791
			JSR	F_C95A
			JSR	F_C972
			RTS
MD863_via_cvec_d770	LDAA	M7772
			BITA	#$04
			BEQ	ZD870
			LDAB	M7779
			JSR	F_B7D6
ZD870			JSR	F_D883
			RTS
MD874_via_cvec_d772	LDAA	#$01
			STAA	M00DF
			RTS

F_D879			LDX	#S_MEM_PROTECTED
			BRA	ZD889
F_D87E			LDX	#S_MIDI_CSUM_ERROR
			BRA	ZD889
F_D883			JSR	F_C95A
			LDX	#S_MIDI_RECEIVED
ZD889			JSR	LCD_OUT
			LDAA	#$0C
			JSR	LCD_WAIT
			STAA	LCD_CMD
			LDAA	#$01
			STAA	M0057
			RTS

S_MIDI_RECEIVED		FCC	" Midi Received  "
			FCB	$00

S_MIDI_CSUM_ERROR	FCC	"Midi CSUM Error "
			FCB	$00

F_D8BB			JSR	HI_CALL_0F
			JSR	HI_CALL_18
			JSR	HI_CALL_11
			AIM	#~ECMI,TCSR3
			JSR	HI_CALL_15
			JSR	HI_CALL_16
			OIM	#ECMI,TCSR3
			RTS
HI_CALL_12		LDX	#M6ABE
ZD8D4			CLR	,X
			INX
			CPX	#M6AD5
			BNE	ZD8D4
			RTS

F_D8DD			STAA	M00BE
			LDAB	M00C1
			LDAA	M00C0
			CMPA	#$10
			BEQ	ZD90D
			CMPA	#$12
			BEQ	ZD900
			CMPB	#$17
			BCC	ZD8F3
			JSR	F_D93E
			RTS
ZD8F3			CMPB	#$40
			BCS	ZD8FF
			CMPB	#$4C
			BCC	ZD8FF
			JSR	F_DF29
			RTS
ZD8FF			RTS
ZD900			CMPB	#$57
			BCS	ZD909
			CMPB	#$5D
			BEQ	ZD909
			RTS
ZD909			JSR	F_DA3F
			RTS
ZD90D			CMPB	#$6E
			BCC	ZD915
			JSR	F_DBBD
			RTS
ZD915			CMPB	#$7B
			BNE	ZD91D
			JSR	F_DC7F
			RTS
ZD91D			CMPB	#$7C
			BNE	ZD925
			JSR	F_DD1C
			RTS
ZD925			CMPB	#$7D
			BNE	ZD92D
			JSR	F_DD7E
			RTS
ZD92D			CMPB	#$7E
			BNE	ZD935
			JSR	F_DDAC
			RTS
ZD935			CMPB	#$7F
			BNE	ZD93D
			JSR	F_DCF6
			RTS
ZD93D			RTS

F_D93E			PSHB
			JSR	F_DE08
			PULB
			CMPB	#$13
			BCS	ZD94A
			JMP	ZDA05
ZD94A			CMPB	#$05
			BCS	ZD958
			CMPB	#$0A
			BCS	ZD95F
			CMPB	#$0F
			BCS	ZD968
			BRA	ZD971
ZD958			LDAA	#$03
			STAA	M778C
			BRA	ZD976
ZD95F			SUBB	#$05
			LDAA	#$01
			STAA	M778C
			BRA	ZD976
ZD968			SUBB	#$0A
			LDAA	#$02
			STAA	M778C
			BRA	ZD976
ZD971			SUBB	#$0F
			CLR	M778C
ZD976			LDX	#MD97F
			ASLB
			ABX
			LDX	,X
			JMP	,X

MD97F			FDB	MD989_via_cvec_d97f
			FDB	MD9A6_via_cvec_d981
			FDB	MD9C2_via_cvec_d983
			FDB	MD9E2_via_cvec_d985
			FDB	MD9F0_via_cvec_d987

MD989_via_cvec_d97f	LDAA	#$01
			STAA	M7788
			LDAA	#$04
			STAA	M7774
			LDAA	#$03
			LDAB	M778C
			MUL
			INCB
			STAB	M7789
			CLR	M778C
			LDAA	M00C2
			JSR	F_DE9D
			RTS
MD9A6_via_cvec_d981	LDAA	#$01
			STAA	M7788
			LDAA	#$04
			STAA	M7774
			LDAA	#$03
			LDAB	M778C
			MUL
			STAB	M7789
			CLR	M778C
			LDAA	M00C2
			JSR	F_DE9D
			RTS
MD9C2_via_cvec_d983	LDAA	#$01
			STAA	M7788
			LDAA	#$04
			STAA	M7774
			LDAA	#$03
			LDAB	M778C
			MUL
			INCB
			INCB
			STAB	M7789
			LDAA	#$01
			STAA	M778C
			LDAA	M00C2
			JSR	F_DE9D
			RTS
MD9E2_via_cvec_d985	CLR	M7788
			LDAA	#$05
			STAA	M7774
			LDAA	M00C2
			JSR	F_DE96
			RTS
MD9F0_via_cvec_d987	LDAA	#$01
			STAA	M7788
			LDAA	#$07
			STAA	M7774
			LDAA	#$05
			STAA	M7789
			LDAA	M00C2
			JSR	F_DE9D
			RTS
ZDA05			CMPB	#$13
			BNE	ZDA0A
			RTS
ZDA0A			CMPB	#$14
			BEQ	ZDA17
			CMPB	#$15
			BEQ	ZDA1E
			CMPB	#$16
			BEQ	ZDA25
			RTS
ZDA17			LDAA	#$0E
			STAA	M7789
			BRA	ZDA2C
ZDA1E			LDAA	#$05
			STAA	M7789
			BRA	ZDA2C
ZDA25			LDAA	#$06
			STAA	M7789
			BRA	ZDA2C
ZDA2C			LDAA	#$01
			STAA	M7788
			CLR	M778C
			LDAA	#$0A
			STAA	M7774
			LDAA	M00C2
			JSR	F_DE9D
			RTS

F_DA3F			PSHB
			JSR	F_DE08
			PULB
			CMPB	#$34
			BCS	ZDA4B
			JMP	ZDADF
ZDA4B			CMPB	#$0D
			BCS	ZDA59
			CMPB	#$1A
			BCS	ZDA60
			CMPB	#$27
			BCS	ZDA69
			BRA	ZDA72
ZDA59			LDAA	#$03
			STAA	M778C
			BRA	ZDA77
ZDA60			SUBB	#$0D
			LDAA	#$01
			STAA	M778C
			BRA	ZDA77
ZDA69			SUBB	#$1A
			LDAA	#$02
			STAA	M778C
			BRA	ZDA77
ZDA72			SUBB	#$27
			CLR	M778C
ZDA77			CMPB	#$0A
			BNE	ZDA89
			CLR	M7788
			LDAA	#$08
			STAA	M7774
			LDAA	M00C2
			JSR	F_DE96
			RTS
ZDA89			CMPB	#$0C
			BNE	ZDA9B
			CLR	M7788
			LDAA	#$06
			STAA	M7774
			LDAA	M00C2
			JSR	F_DE96
			RTS
ZDA9B			CMPB	#$0B
			BNE	ZDABE
			LDAA	#$01
			STAA	M7788
			LDAA	#$04
			STAA	M7774
			LDAA	M778C
			LDAB	#$03
			MUL
			INCB
			STAB	M7789
			LDAA	#$01
			STAA	M778C
			LDAA	M00C2
			JSR	F_DE9D
			RTS
ZDABE			CMPB	#$08
			BNE	ZDAC5
			INC	M778C
ZDAC5			LDX	#MDB7B
			ASLB
			ABX
			LDAA	,X
			STAA	M7774
			LDAA	$01,X
			STAA	M7789
			LDAA	#$01
			STAA	M7788
			LDAA	M00C2
			JSR	F_DE9D
			RTS
ZDADF			CMPB	#$5D
			BEQ	ZDB46
			CMPB	#$57
			BCC	ZDAFB
			CMPB	#$36
			BCC	ZDAFC
			CLR	M7788
			SUBB	#$34
			STAB	M7774
			CLR	M778C
			LDAA	M00C2
			JSR	F_DE96
ZDAFB			RTS
ZDAFC			CMPB	#$44
			BEQ	ZDAFB
			CMPB	#$45
			BEQ	ZDAFB
			CMPB	#$46
			BEQ	ZDAFB
			CMPB	#$4D
			BCS	ZDB27
			TBA
			SUBA	#$4D
			STAA	M778C
			LDAA	#$01
			STAA	M7788
			LDAA	#$0A
			STAA	M7774
			LDAA	#$0F
			STAA	M7789
			LDAA	M00C2
			JSR	F_DE9D
			RTS
ZDB27			SUBB	#$36
			ASLB
			LDX	#MDB8F
			ABX
			LDAA	,X
			STAA	M7774
			LDAA	$01,X
			STAA	M7789
			LDAA	#$01
			STAA	M7788
			CLR	M778C
			LDAA	M00C2
			JSR	F_DE9D
			RTS
ZDB46			CLR	M776E
			CLR	M776F
			CLR	M7770
			CLR	M7771
			LDAA	M00C2
			LSRA
			ROL	M7771
			LSRA
			ROL	M7770
			LSRA
			ROL	M776F
			LSRA
			ROL	M776E
			LDAA	#$01
			STAA	M778C
			CLR	M7788
			CLR	M7774
			CLRB
			JSR	F_B1DD
			JSR	F_C95A
			JSR	F_C972
			RTS
			RTS

MDB7B			FCB	$07,$00,$07,$01,$07,$03,$07,$04,$07,$02,$09,$01,$09
			FCB	$00,$03,$02,$03,$01,$03,$03

MDB8F			FCB	$02,$01,$02,$02,$02,$03,$02,$04,$02,$05,$02,$00,$03
			FCB	$00,$03,$01,$0A,$0D,$0A,$00,$0A,$01,$0A,$02,$0A,$03
			FCB	$0A,$04,$00,$00,$00,$00,$00,$00,$0A,$07,$0A,$08,$0A
			FCB	$09,$0A,$0A,$0A,$0B,$0A,$0C

F_DBBD			PSHB
			JSR	F_DE65
			PULB
			CMPB	#$60
			BCS	ZDBC9
			JMP	ZDC24
ZDBC9			CLRA
ZDBCA			SUBB	#$0C
			BCS	ZDBD1
			INCA
			BRA	ZDBCA
ZDBD1			ADDB	#$0C
			STAA	M778C
			CMPB	#$0B
			BNE	ZDBE0
			INC	M778C
			INC	M778C
ZDBE0			CMPB	#$01
			BNE	ZDBF1
			PSHB
			LDAB	M00C2
			BNE	ZDBEC
			CLRB
			BRA	ZDBEE
ZDBEC			LDAB	#$80
ZDBEE			STAB	M00C2
			PULB
ZDBF1			CMPB	#$02
			BNE	ZDC06
			PSHB
			LDAB	M00C1
			LDX	#M6DD7
			ABX
			LDAB	,X
			LDAA	M00C2
			ANDB	#$80
			ABA
			STAA	M00C2
			PULB
ZDC06			CLR	M7788
			LDX	#MDC18
			ABX
			LDAA	,X
			STAA	M7774
			LDAA	M00C2
			JSR	F_DE96
			RTS

MDC18			FCB	$29,$2A,$2A,$2B,$2C,$2D,$2E,$2F,$30,$31,$32,$33

ZDC24			CMPB	#$64
			BCC	ZDC67
			CMPB	#$60
			BEQ	ZDC36
			CMPB	#$61
			BEQ	ZDC40
			CMPB	#$62
			BEQ	ZDC4A
			BRA	ZDC54
ZDC36			CLR	M778C
			LDAA	#$33
			STAA	M7774
			BRA	ZDC5E
ZDC40			LDAA	#$28
			STAA	M7774
			CLR	M778C
			BRA	ZDC5E
ZDC4A			LDAA	#$34
			STAA	M7774
			CLR	M778C
			BRA	ZDC5E
ZDC54			LDAA	#$33
			STAA	M7774
			LDAA	#$01
			STAA	M778C
ZDC5E			CLR	M7788
			LDAA	M00C2
			JSR	F_DE96
			RTS
ZDC67			CMPB	#$6E
			BCS	ZDC6C
			RTS
ZDC6C			SUBB	#$64
			STAB	M778C
			CLR	M7788
			LDAA	#$35
			STAA	M7774
			LDAA	M00C2
			JSR	F_DE96
			RTS

F_DC7F			LDAB	M00C2
			CMPB	#$1B
			BCS	ZDC86
			RTS
ZDC86			PSHB
			JSR	F_DDD7
			PULB
			CMPB	#$0B
			BCS	ZDC92
			JMP	ZDCE2
ZDC92			CLR	M778C
			TSTB
			BNE	ZDC9F
			LDAA	#$14
			STAA	M7774
			BRA	ZDCB3
ZDC9F			CMPB	#$08
			BNE	ZDCAA
			LDAA	#$16
			STAA	M7774
			BRA	ZDCB3
ZDCAA			CMPB	#$09
			BNE	ZDCBD
			LDAA	#$17
			STAA	M7774
ZDCB3			CLR	M7788
			LDAA	>M00C3
			JSR	F_DE96
			RTS
ZDCBD			DECB
			LDAA	#$01
			STAA	M7788
			LDAA	#$15
			STAA	M7774
			LDX	#MDCD8
			ABX
			LDAA	,X
			STAA	M7789
			LDAA	>M00C3
			JSR	F_DE9D
			RTS

MDCD8			FCB	$00,$01,$02,$03,$05,$06,$07,$00,$00,$04

ZDCE2			SUBB	#$0B
			STAB	M778C
			CLR	M7788
			LDAA	#$1F
			STAA	M7774
			LDAA	>M00C3
			JSR	F_DE96
			RTS

F_DCF6			JSR	F_DDD7
			LDAA	#$02
			STAA	M7788
			LDAA	#$15
			STAA	M7774
			CLR	M778C
			LDAA	#$0C
			STAA	M7789
			LDAA	M00C2
			STAA	M778A
			LDAA	>M00C3
			LDAB	M00BE
			ASLB
			LSRD
			TBA
			JSR	F_DEC9
			RTS

F_DD1C			LDAB	M00C2
			CMPB	#$37
			BCS	ZDD23
			RTS
ZDD23			JSR	F_DDD7
			LDAB	M00C2
			CMPB	#$07
			BCC	ZDD58
			LDAA	#$01
			STAA	M7788
			LDX	#MDD4A
			ASLB
			ABX
			LDAA	,X
			STAA	M7774
			LDAA	$01,X
			STAA	M7789
			CLR	M778C
			LDAA	>M00C3
			JSR	F_DE9D
			RTS

MDD4A			FCB	$19,$00,$19,$01,$19,$02,$19,$03,$1A,$01,$1A,$00,$1A
			FCB	$02

ZDD58			LDAA	#$02
			STAA	M7788
			LDAA	#$1B
			STAA	M7774
			CLR	M778A
			SUBB	#$07
			CLRA
ZDD68			SUBB	#$04
			BCS	ZDD6F
			INCA
			BRA	ZDD68
ZDD6F			ADDB	#$04
			STAA	M7789
			STAB	M778C
			LDAA	>M00C3
			JSR	F_DEC9
			RTS

F_DD7E			JSR	F_DDD7
			LDAB	M00C2
			CMPB	#$0C
			BCS	ZDD88
			RTS
ZDD88			LDAA	#$02
			STAA	M7788
			LDAA	#$1C
			STAA	M7774
			CLR	M7789
			STAB	M778A
			CLR	M778C
			LDAA	>M00C3
			JSR	F_DEC9
			LDAA	#$01
			STAA	M778C
			LDAA	M00BE
			JSR	F_DEC9
			RTS

F_DDAC			JSR	F_DDD7
			LDAA	#$02
			STAA	M7788
			LDAA	#$1C
			STAA	M7774
			LDAA	#$02
			STAA	M7789
			LDAA	M00C2
			STAA	M778A
			CLR	M778C
			LDAA	>M00C3
			JSR	F_DEC9
			LDAA	#$01
			STAA	M778C
			LDAA	M00BE
			JSR	F_DEC9
			RTS

F_DDD7			LDAB	M7772
			ANDB	#$07
			STAB	M7772
			LDX	#MDDE8
			ASLB
			ABX
			LDX	,X
			JMP	,X

MDDE8			FDB	MDE07_via_cvec_dde8
			FDB	MDE02_via_cvec_ddea
			FDB	MDE02_via_cvec_ddea
			FDB	MDE07_via_cvec_dde8
			FDB	MDDF8_via_cvec_ddf0
			FDB	MDDF8_via_cvec_ddf0
			FDB	MDDFD_via_cvec_ddf4
			FDB	MDE07_via_cvec_dde8

MDDF8_via_cvec_ddf0	LDAB	#$07
			JSR	F_8A08

MDDFD_via_cvec_ddf4	LDAB	#$07
			JSR	F_8A08

MDE02_via_cvec_ddea	LDAB	#$05
			JSR	F_8A08

MDE07_via_cvec_dde8	RTS

F_DE08			LDAB	M7772
			ANDB	#$07
			STAB	M7772
			LDX	#MDE19
			ASLB
			ABX
			LDX	,X
			JMP	,X

MDE19			FDB	MDE33_via_cvec_de19
			FDB	MDE38_via_cvec_de1b
			FDB	MDE33_via_cvec_de19
			FDB	MDE38_via_cvec_de1b
			FDB	MDE29_via_cvec_de21
			FDB	MDE29_via_cvec_de21
			FDB	MDE2E_via_cvec_de25
			FDB	MDE38_via_cvec_de1b

MDE29_via_cvec_de21	LDAB	#$07
			JSR	F_8A08

MDE2E_via_cvec_de25	LDAB	#$07
			JSR	F_8A08

MDE33_via_cvec_de19	LDAB	#$06
			JSR	F_8A08

MDE38_via_cvec_de1b	RTS

F_DE39			LDAB	M7772
			ANDB	#$07
			STAB	M7772
			LDX	#MDE4A
			ASLB
			ABX
			LDX	,X
			JMP	,X

MDE4A			FDB	MDE64_via_cvec_de4a
			FDB	MDE64_via_cvec_de4a
			FDB	MDE64_via_cvec_de4a
			FDB	MDE64_via_cvec_de4a
			FDB	MDE5A_via_cvec_de52
			FDB	MDE5A_via_cvec_de52
			FDB	MDE5F_via_cvec_de56
			FDB	MDE64_via_cvec_de4a

MDE5A_via_cvec_de52	LDAB	#$07
			JSR	F_8A08

MDE5F_via_cvec_de56	LDAB	#$07
			JSR	F_8A08

MDE64_via_cvec_de4a	RTS

F_DE65			LDAB	M7772
			ANDB	#$07
			STAB	M7772
			LDX	#MDE76
			ASLB
			ABX
			LDX	,X
			JMP	,X

MDE76			FDB	MDE86_via_cvec_de76
			FDB	MDE86_via_cvec_de76
			FDB	MDE8B_via_cvec_de7a
			FDB	MDE95_via_cvec_de7c
			FDB	MDE90_via_cvec_de7e
			FDB	MDE95_via_cvec_de7c
			FDB	MDE90_via_cvec_de7e
			FDB	MDE95_via_cvec_de7c

MDE86_via_cvec_de76	LDAB	#$07
			JSR	F_8A08

MDE8B_via_cvec_de7a	LDAB	#$07
			JSR	F_8A08

MDE90_via_cvec_de7e	LDAB	#$06
			JSR	F_8A08

MDE95_via_cvec_de7c	RTS

F_DE96			CLR	M7788
			JSR	F_DF0D
			RTS

F_DE9D			PSHA
			LDAB	M778C
			PSHB
			LDAB	M7789
			PSHB
			CLR	M7788
			CLR	M778C
			LDAB	M7774
			JSR	F_B1DD
			LDAB	#$01
			JSR	F_B931
			PULB
			STAB	M7789
			PULB
			STAB	M778C
			LDAA	#$01
			STAA	M7788
			PULA
			JSR	F_DF0D
			RTS

F_DEC9			PSHA
			LDAB	M778A
			PSHB
			LDAB	M778C
			PSHB
			LDAB	M7789
			PSHB
			CLR	M7788
			CLR	M778C
			LDAB	M7774
			JSR	F_B1DD
			LDAB	#$01
			JSR	F_B931
			PULB
			STAB	M7789
			LDAA	#$01
			STAA	M7788
			LDAB	M7774
			JSR	F_B1DD
			LDAB	#$01
			JSR	F_B931
			PULB
			STAB	M778C
			PULB
			STAB	M778A
			LDAB	#$02
			STAB	M7788
			PULA
			JSR	F_DF0D
			RTS

F_DF0D			PSHA
			LDAB	M7774
			JSR	F_B1DD
			PULA
			CMPA	M7783
			BLS	ZDF1C
			BRA	ZDF22
ZDF1C			LDX	M7781
			JSR	F_BE61
ZDF22			JSR	F_C95A
			JSR	F_C972
			RTS

F_DF29			CLR	>M00CC
			LDAA	M00C2
			LDAB	M00C1
			CMPB	#$41
			BEQ	ZDF63
			CMPB	#$49
			BEQ	ZDF6F
			CMPB	#$4A
			BEQ	ZDF7B
			CMPA	#$40
			BCC	ZDF43
			JMP	ZDF93
ZDF43			CMPB	#$40
			BNE	ZDF4A
			JMP	hdlr_RST
ZDF4A			BCC	ZDF4F
			JMP	ZDF93
ZDF4F			CMPB	#$4C
			BCS	ZDF56
			JMP	ZDF93
ZDF56			SUBB	#$40
			LDX	#MDF87
			ABX
			LDAB	,X
ZDF5E			JSR	F_8A08
			BRA	ZDF93
ZDF63			CMPA	#$40
			BCC	ZDF6B
			LDAB	#$04
			BRA	ZDF5E
ZDF6B			LDAB	#$03
			BRA	ZDF5E
ZDF6F			CMPA	#$40
			BCC	ZDF77
			LDAB	#$0D
			BRA	ZDF5E
ZDF77			LDAB	#$0A
			BRA	ZDF5E
ZDF7B			CMPA	#$40
			BCC	ZDF83
			LDAB	#$0E
			BRA	ZDF5E
ZDF83			LDAB	#$0B
			BRA	ZDF5E

MDF87			FCB	$00,$00,$05,$06,$07,$08,$09,$02,$01,$00,$00,$0C

ZDF93			RTS

MDF94			FCB	$FE,$C0,$B4,$AE,$A8,$A2,$9E,$98,$94,$90,$8D,$8A,$86
			FCB	$82,$80,$7D,$7A,$77,$74,$72,$70,$6D,$6B,$69,$67,$65
			FCB	$63,$61,$5F,$5D,$5C,$5A,$58,$56,$55,$53,$52,$51,$4F
			FCB	$4E,$4C,$4B,$4A,$48,$47,$46,$44,$43,$42,$41,$40,$3F
			FCB	$3E,$3C,$3B,$3A,$39,$38,$37,$36,$35,$34,$32,$31,$30
			FCB	$2F,$2E,$2D,$2C,$2B,$2A,$29,$28,$27,$26,$25,$24,$23
			FCB	$22,$21,$20,$1F,$1E,$1D,$1C,$1B,$1A,$1A,$19,$18,$17
			FCB	$16,$16,$15,$14,$13,$12,$12,$11,$10,$10,$0F,$0E,$0E
			FCB	$0D,$0C,$0C,$0B,$0B,$0A,$09,$09,$08,$07,$07,$06,$06
			FCB	$05,$05,$04,$04,$03,$03,$02,$02,$01,$01,$00

;-------
;
; Serial interrupt handler
;
SIO			LDAA	XROM
			PSHA
			LDAA	TRSCR
			ASLA
			BCS	ZE023
			ASLA
			BCS	ZE06C
			BMI	ZE043
			BRA	ZE075
ZE023			LDAA	RDR
			LDX	M00BA
			STAA	,X
			INX
			CPX	#M7EE8
			BNE	ZE032
			LDX	#M7E0C
ZE032			CPX	M00B6
			BEQ	ZE03A
			STX	M00BA
			BRA	ZE075
ZE03A			LDAA	#$01
			STAA	M00CA
			JSR	HI_CALL_07
			BRA	ZE075
ZE043			LDX	M00B4
			CPX	M00B8
			BEQ	ZE066
			LDAA	,X
			BPL	ZE057
			CMPA	#$F0
			BEQ	ZE055
			CMPA	#$FE
			BEQ	ZE055
ZE055			STAA	M00BC
ZE057			STAA	TDR
			INX
			CPX	#M7E0C
			BNE	ZE062
			LDX	#M7DCC
ZE062			STX	M00B4
			BRA	ZE075
ZE066			LDAA	#$3A
			STAA	TRSCR
			BRA	ZE075
ZE06C			LDAA	#$02
			STAA	M00CA
			JSR	HI_CALL_07
			LDAA	RDR
ZE075			PULA
			STAA	XROM
			RTS

;-------

HI_CALL_08		LDAA	#%00001100
			STAA	RMCR
			LDAA	#%00111010
			STAA	TRSCR
			LDAA	TRSCR
			LDAA	RDR
			LDX	#M7DCC
			STX	M00B8
			STX	M00B4
			LDAA	#$F7
			STAA	M00BD
			LDX	#M7E0C
			STX	M00BA
			STX	M00B6
			RTS

;-------

HI_CALL_07		LDAA	#$F7
			STAA	M00BD
			LDX	#M7E0C
			STX	M00BA
			STX	M00B6
			RTS

F_E0A4			TST	M7568
			BEQ	ZE0C1
			TST	M756C
			BNE	ZE0C1
			TST	>M00CC
			BNE	ZE0C1
			LDAA	M7567
			ORAA	#$C0
			JSR	HI_CALL_0C
			TBA
			ANDA	#$7F
			JSR	HI_CALL_0C
ZE0C1			RTS

F_E0C2			RTS
			PSHA
			CMPB	#$40
			BEQ	ZE0D5
			CMPB	#$7E
			BEQ	ZE0D5
			CMPB	#$7F
			BEQ	ZE0D5
			TST	M7569
			BEQ	ZE0E7
ZE0D5			LDAA	M7567
			ORAA	#$B0
			JSR	HI_CALL_0C
			TBA
			JSR	HI_CALL_0C
			PULA
			LSRA
			JSR	HI_CALL_0C
			RTS
ZE0E7			PULA
			RTS

F_E0E9			RTS
			PSHB
			ADDB	#$5F
			LDAA	#$FF
			BSR	F_E0C2
			PULB
			RTS

F_E0F3			RTS
			TST	M6AA6
			BEQ	ZE0FF
			LDAB	#$7E
			LDAA	#$02
			BRA	ZE102
ZE0FF			LDAB	#$7F
			CLRA
ZE102			JMP	F_E0C2

HI_CALL_0B		RTS
			LDAA	#$FE
			JSR	HI_CALL_0C
			RTS

F_E10C			RTS
			RTS

F_E10E			RTS

F_E10F			RTS

F_E110			RTS

F_E111			RTS

F_E112			RTS
ZE113			RTS

F_E114			RTS

F_E115			RTS
HI_CALL_06		RTS
HI_CALL_0D		RTS
HI_CALL_04		RTS
HI_CALL_0A		RTS
			RTS
			RTS
			RTS

F_E11D			TST	M756C
			BEQ	ZE159
			TST	>M00CC
			BNE	ZE159
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C8D5
			STX	M00A7
			LDX	#S_TRANSMITTING
			JSR	LCD_WRITE
			CLR	>M00C7
			JSR	HI_CALL_0E
ZE141			LDAA	M00C7
			LDAB	#$4E
			MUL
			ADDD	#USER_VOICE
			XGDX
			JSR	F_E306
			LDAB	M00C7
			INCB
			STAB	M00C7
			CMPB	#$20
			BNE	ZE141
			JSR	HI_CALL_10
ZE159			RTS

S_TRANSMITTING		FCC	"Transmitting!!  "
			FCB	$00

F_E16B			TST	M756C
			BEQ	ZE182
			TST	>M00CC
			BNE	ZE182
			JMP	ZE1C6

F_E178			TST	M756C
			BEQ	ZE182
			TST	>M00CC
			BEQ	ZE185
ZE182			JMP	ZE230
ZE185			CLRB
ZE186			LDX	#ME236
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$02
			BCS	ZE186
			LDAA	M7567
			JSR	HI_CALL_0C
ZE19A			LDX	#ME236
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0F
			BCS	ZE19A
			LDAA	#$3D
			STAA	M00C5
			LDX	#M6ABE
ZE1AF			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M6AD5
			BNE	ZE1AF
			JSR	HI_CALL_10
ZE1C6			CLRB
ZE1C7			LDX	#ME231
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$02
			BCS	ZE1C7
			LDAA	M7567
			JSR	HI_CALL_0C
ZE1DB			LDX	#ME231
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$05
			BCS	ZE1DB
			CLR	>M00C5
			LDX	#M6A67
ZE1EF			LDAA	,X
			CPX	#M6AAD
			BNE	ZE1F7
			CLRA
ZE1F7			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M6ABE
			BNE	ZE1EF
ZE209			LDAA	#$63
			PSHX
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M6AC1
			BNE	ZE209
ZE21B			LDAA	#$32
			PSHX
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M6AC4
			BNE	ZE21B
			JSR	HI_CALL_10
ZE230			RTS

ME231			FCB	$F0,$43,$03,$00,$5D

ME236			FCB	$F0,$43,$7E,$00,$21,$4C,$4D,$20,$20,$38,$39,$37,$36
			FCB	$41,$45

ME245_via_cvec_d38f	TST	M756C
			BEQ	ZE28A
			TST	>M00CC
			BNE	ZE28A
			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C8D5
			STX	M00A7
			LDX	#S_TRANSMITTING
			JSR	LCD_WRITE
			CLR	>M00C7
			JSR	F_E28B
ZE269			LDAA	M00C7
			CMPA	#$18
			BCS	ZE274
			LDX	#D_MODE_SINGLE
			BRA	ZE27B
ZE274			LDAB	#$4C
			MUL
			ADDD	#USER_PFM
			XGDX
ZE27B			JSR	F_E2C2
			LDAB	M00C7
			INCB
			STAB	M00C7
			CMPB	#$20
			BNE	ZE269
			JSR	HI_CALL_10
ZE28A			RTS

F_E28B			CLRB
ZE28C			LDX	#ME2B3
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$02
			BCS	ZE28C
			LDAA	M7567
			JSR	HI_CALL_0C
ZE2A0			LDX	#ME2B3
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0F
			BCS	ZE2A0
			LDAA	#$54
			STAA	M00C5
			RTS

ME2B3			FCB	$F0,$43,$7E,$13,$0A,$4C,$4D,$20,$20,$38,$39,$37,$36
			FCB	$50,$4D

F_E2C2			CLRB
ZE2C3			PSHB
			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			PULB
			INCB
			CMPB	#$4C
			BNE	ZE2C3
			RTS
HI_CALL_0E		CLRB
ZE2DB			LDX	#ME301
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$02
			BCS	ZE2DB
			LDAA	M7567
			JSR	HI_CALL_0C
ZE2EF			LDX	#ME301
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$05
			BCS	ZE2EF
			CLR	>M00C5
			RTS

ME301			FCB	$F0,$43,$04,$20,$00


F_E306			CLRB
ZE307			PSHB
			LDAA	,X
			CMPB	#$30
			BNE	ZE31F
			TIM	#%00000100,$00,X
			BNE	ZE319
			ANDA	#$FB
			ORAA	#$02
			BRA	ZE31D
ZE319			ORAA	#$04
			ANDA	#$FD
ZE31D			ANDA	#$0F
ZE31F			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			PULB
			INCB
			CMPB	#$43
			BNE	ZE307
			PSHX
ZE333			LDAA	#$63
			PSHB
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULB
			INCB
			CMPB	#$46
			BNE	ZE333
ZE344			LDAA	#$32
			PSHB
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULB
			INCB
			CMPB	#$49
			BNE	ZE344
			PULX
ZE356			PSHB
			LDAA	,X
			CMPB	#$4F
			BNE	ZE35F
			ANDA	#$0F
ZE35F			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			PULB
			INCB
			CMPB	#$54
			BNE	ZE356
ZE372			CLRA
			PSHB
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULB
			INCB
			CMPB	#$80
			BNE	ZE372
			RTS
ME383_via_cvec_d38d	LDAA	#$08
			LDAB	#$0C
			LDX	#M6DD7
ZE38A			ASR	$02,X
			ROL	$02,X
			ROL	$01,X
			ABX
			DECA
			BNE	ZE38A
			TST	M756C
			BNE	ZE39A
			RTS
ZE39A			TST	>M00CC
			BEQ	ZE3A0
			RTS
ZE3A0			LDAA	#$F0
			JSR	HI_CALL_0C
			LDAA	#$43
			JSR	HI_CALL_0C
			LDAA	M7567
			JSR	HI_CALL_0C
			CLRB
ZE3B1			LDX	#ME3DE
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0D
			BCS	ZE3B1
			LDAA	#$4C
			STAA	M00C5
			LDX	#M6DD7
ZE3C6			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#USER_PFM
			BNE	ZE3C6
			JSR	HI_CALL_10
			RTS

ME3DE			FCB	$7E,$00,$78,$4C,$4D,$20,$20,$38,$39,$37,$36,$50,$45

ME3EB_via_cvec_d383	TST	M756C
			BNE	ZE3F1
			RTS
ZE3F1			TST	>M00CC
			BEQ	ZE3F7
			RTS
ZE3F7			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C8D5
			STX	M00A7
			LDX	#S_TRANSMITTING
			JSR	LCD_WRITE
			LDAA	#$F0
			JSR	HI_CALL_0C
			LDAA	#$43
			JSR	HI_CALL_0C
			LDAA	M7567
			JSR	HI_CALL_0C
			CLRB
ZE41C			LDX	#ME449
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0D
			BCS	ZE41C
			LDAA	#$84
			STAA	M00C5
			LDX	#M7628
ZE431			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M7640
			BNE	ZE431
			JSR	HI_CALL_10
			RTS

ME449			FCB	$7E,$00,$22,$4C,$4D,$20,$20,$4D,$43,$52,$54,$45,$30

ME456_via_cvec_d385	TST	M756C
			BNE	ZE45C
			RTS
ZE45C			TST	>M00CC
			BEQ	ZE462
			RTS
ZE462			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C8D5
			STX	M00A7
			LDX	#S_TRANSMITTING
			JSR	LCD_WRITE
			LDAA	#$F0
			JSR	HI_CALL_0C
			LDAA	#$43
			JSR	HI_CALL_0C
			LDAA	M7567
			JSR	HI_CALL_0C
			CLRB
ZE487			LDX	#ME4B4
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0D
			BCS	ZE487
			LDAA	#$85
			STAA	M00C5
			LDX	#M7640
ZE49C			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M7740
			BNE	ZE49C
			JSR	HI_CALL_10
			RTS

ME4B4			FCB	$7E,$02,$0A,$4C,$4D,$20,$20,$4D,$43,$52,$54,$45,$31

ME4C1_via_cvec_bc10	TST	M756C
			BNE	ZE4C7
			RTS
ZE4C7			TST	>M00CC
			BEQ	ZE4CD
			RTS
ZE4CD			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C8D5
			STX	M00A7
			LDX	#S_TRANSMITTING
			JSR	LCD_WRITE
			LDAA	#$F0
			JSR	HI_CALL_0C
			LDAA	#$43
			JSR	HI_CALL_0C
			LDAA	M7567
			JSR	HI_CALL_0C
			CLRB
ZE4F2			LDX	#ME536
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0D
			BCS	ZE4F2
			LDAA	#$3A
			STAA	M00C5
			LDX	#M7565
ZE507			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M7570
			BNE	ZE507
			LDX	#M7740
ZE51E			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M7750
			BNE	ZE51E
			JSR	HI_CALL_10
			RTS

ME536			FCB	$7E,$00,$25,$4C,$4D,$20
			FCB	$20,$38,$39,$37,$36,$53
			FCB	$30

ME543_via_cvec_bc12	TST	M756C
			BNE	ZE549
			RTS
ZE549			TST	>M00CC
			BEQ	ZE54F
			RTS
ZE54F			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C8D5
			STX	M00A7
			LDX	#S_TRANSMITTING
			JSR	LCD_WRITE
			LDAA	#$F0
			JSR	HI_CALL_0C
			LDAA	#$43
			JSR	HI_CALL_0C
			LDAA	M7567
			JSR	HI_CALL_0C
			CLRB
ZE574			LDX	#ME5B1
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0D
			BCS	ZE574
			LDAA	#$3B
			STAA	M00C5
			LDX	#M7571
ZE589			LDAA	,X
			ROLA
			ROLA
			PSHX
			ANDA	#$01
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			LDAA	,X
			ANDA	#$7F
			PSHX
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M75F1
			BNE	ZE589
			JSR	HI_CALL_10
			RTS

ME5B1			FCB     $7E,$02,$0A,$4C,$4D,$20
			FCB	$20,$38,$39,$37,$36,$53
			FCB	$31

ME5BE_via_cvec_bc14	TST	M756C
			BNE	ZE5C4
			RTS
ZE5C4			TST	>M00CC
			BEQ	ZE5CA
			RTS
ZE5CA			JSR	HI_CALL_00
			JSR	HI_CALL_01
			CLR	>M005A
			JSR	F_C8D5
			STX	M00A7
			LDX	#S_TRANSMITTING
			JSR	LCD_WRITE
			LDAA	#$F0
			JSR	HI_CALL_0C
			LDAA	#$43
			JSR	HI_CALL_0C
			LDAA	M7567
			JSR	HI_CALL_0C
			CLRB
ZE5EF			LDX	#ME61C
			ABX
			LDAA	,X
			JSR	HI_CALL_0C
			INCB
			CMPB	#$0D
			BCS	ZE5EF
			LDAA	#$3C
			STAA	M00C5
			LDX	#M75F1
ZE604			LDAA	,X
			PSHX
			ANDA	#$7F
			TAB
			ADDB	M00C5
			STAB	M00C5
			JSR	HI_CALL_0C
			PULX
			INX
			CPX	#M7628
			BNE	ZE604
			JSR	HI_CALL_10
			RTS

ME61C			FCB	$7E,$00,$41,$4C,$4D,$20,$20,$38,$39,$37,$36,$53,$32

ME629_via_cvec_bc16	JSR	ME3EB_via_cvec_d383
			JSR	F_F052
			JSR	ME456_via_cvec_d385
			RTS
ME633_via_cvec_bc0e	JSR	ME543_via_cvec_bc12
			JSR	F_F052
			JSR	ME5BE_via_cvec_bc14
			JSR	F_F052
			JSR	ME3EB_via_cvec_d383
			JSR	F_F052
			JSR	ME456_via_cvec_d385
			RTS
HI_CALL_10		LDAA	M00C5
			NEGA
			ANDA	#$7F
			JSR	HI_CALL_0C
			LDAA	#$F7
			JSR	HI_CALL_0C
			RTS
HI_CALL_0C		LDX	M00B8
			STAA	,X
			CPX	#M7E0B
			BNE	ZE663
			LDX	#M7DCB
ZE663			INX
			CPX	M00B4
			BEQ	HI_CALL_0C
			STX	M00B8
			LDAA	#$3E
			STAA	TRSCR
			RTS

F_E66F			JSR	F_E6CE
			LDX	#LCD_BUFFER
			STX	M00A7
			LDAA	#$01
			CMPA	M00CA
			BNE	ZE682
			LDX	#S_MIDI_BUFFER_FULL
			BRA	ZE685
ZE682			LDX	#S_MIDI_DATA_ERROR
ZE685			JSR	PUTSTRX
			JSR	LCD_UPDATE
			LDAA	#$0C
			JSR	LCD_WAIT
			STAA	LCD_CMD
			CLR	>M00CA
			LDAA	#$01
			STAA	M0056
			RTS

S_MIDI_BUFFER_FULL	FCC	"Midi Buffer Full"
			FCB	$00

S_MIDI_DATA_ERROR	FCC	"Midi Data Error!"
			FCB	$00

F_E6BD			JSR	F_E6CE
			SEI
			SPIN3
			JSR	HI_CALL_07
			CLI
			JSR	F_C7C2
			CLR	>M00CB
			RTS

F_E6CE			LDAA	TCSR1
			PSHA
			AIM	#%11110111,TCSR1
			JSR	HI_CALL_16
			LDAA	#$07
			LDX	#M7CF1
ZE6DC			TIM	#%00000100,$01,X
			BNE	ZE6E8
ZE6E1			DEX
			DEX
			DECA
			BPL	ZE6DC
			BRA	ZE710
ZE6E8			PSHA
			PSHX
			LDX	#M793B
			TAB
			ABX
			LDAA	,X
			BMI	ZE70C
			LDAB	M7772
			ANDB	#$04
			BEQ	ZE700
			TST	M6E38
			BEQ	ZE700
			CLRA
ZE700			STAA	M00E0
			JSR	F_87CA
			PULX
			PULA
			PSHA
			PSHX
			JSR	F_8609
ZE70C			PULX
			PULA
			BRA	ZE6E1
ZE710			LDAB	M006C
			ASLB
			LDAA	M7772
			ANDA	#$04
			BEQ	ZE72C
			TST	M6E38
			BNE	ZE78B
			LDAA	#$08
			MUL
			ADDD	#M7F39
			XGDX
			DEX
			DEX
			LDAB	#$08
			BRA	ZE734
ZE72C			LDX	#M7F39
			ABX
			DEX
			DEX
			LDAB	#$01
ZE734			PSHB
			LDAB	M006C
ZE737			TIM	#%00000100,$01,X
			BNE	ZE747
ZE73C			DEX
			DEX
			DECB
			BNE	ZE737
			PULB
			DECB
			BNE	ZE734
			BRA	ZE78B
ZE747			PULA
			PSHA
			PSHB
			PSHX
			DECA
			STAA	M00E0
			LDAB	M006C
			ASLB
			MUL
			ADDD	#M7F39
			STD	M00E1
			TIM	#%00000001,$01,X
			BNE	ZE77B
			LDX	#M7F01
			LDAB	M00E0
			ABX
			LDAA	,X
			STAA	M005A
			TSTA
			BLE	ZE787
			JSR	F_87CA
			LDAA	M005A
			DECA
			STAA	M005A
			LDX	#M7F01
			LDAB	M00E0
			ABX
			STAA	,X
			BNE	ZE782
ZE77B			LDX	M00E1
			JSR	F_8703
			BRA	ZE787
ZE782			PULX
			PSHX
			JSR	F_8731
ZE787			PULX
			PULB
			BRA	ZE73C
ZE78B			PULA
			STAA	TCSR1
			RTS

F_E78F			STAB	M00E0
			LDX	#M00F6
			ABX
			TST	,X
			BNE	ZE79C
			JMP	ZE820
ZE79C			JSR	F_87CA
			LDAA	M7772
			ANDA	#$04
			BEQ	ZE7AB
			TST	M6E38
			BNE	ZE7B7
ZE7AB			LDAA	M00E0
			JSR	F_9A2F
			TST	$3F,X
			BEQ	ZE7B7
			JMP	ZE7E7
ZE7B7			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAA	,X
			TAB
			LDX	#M7CE3
			ASLB
			ABX
ZE7C5			LDAB	$01,X
			ANDB	#$7C
			CMPB	#$04
			BEQ	ZE7DE
ZE7CD			INX
			INX
			PSHX
			LDX	#M7EF9
			LDAB	M00E0
			ABX
			CMPA	,X
			PULX
			BEQ	ZE820
			INCA
			BRA	ZE7C5
ZE7DE			PSHA
			PSHX
			JSR	F_85FA
			PULX
			PULA
			BRA	ZE7CD
ZE7E7			LDX	#M7F01
			LDAB	M00E0
			ABX
			LDAA	,X
			STAA	M005A
			TSTA
			BLE	ZE820
			LDAA	M00E0
			LDAB	M006C
			ASLB
			MUL
			ADDD	#M7F39
			STD	M00E1
			LDAB	M006C
			DECB
			ASLB
			LDX	M00E1
			ABX
			LDAB	M006C
ZE808			LDAA	$01,X
			ANDA	#$7C
			CMPA	#$04
			BEQ	ZE817
ZE810			DEX
			DEX
			DECB
			BNE	ZE808
			BRA	ZE820
ZE817			PSHB
			PSHX
			JSR	F_86E4
			PULX
			PULB
			BRA	ZE810
ZE820			RTS

F_E821			STAB	M00E0
			LDX	#M00F6
			ABX
			TST	,X
			BNE	ZE82E
			JMP	ZE8CF
ZE82E			JSR	F_87CA
			LDAA	M7772
			ANDA	#$04
			BEQ	ZE83D
			TST	M6E38
			BNE	ZE849
ZE83D			LDAA	M00E0
			JSR	F_9A2F
			TST	$3F,X
			BEQ	ZE849
			JMP	ZE87E
ZE849			LDX	#M7EF1
			LDAB	M00E0
			ABX
			LDAA	,X
			TAB
			LDX	#M7CE3
			ASLB
			ABX
ZE857			TIM	#%00000100,$01,X
			BNE	ZE86D
ZE85C			INX
			INX
			PSHX
			LDX	#M7EF9
			LDAB	M00E0
			ABX
			CMPA	,X
			PULX
			BEQ	ZE8CF
			INCA
			BRA	ZE857
ZE86D			LDAB	M0058
			ANDB	#$78
			ANDB	$01,X
			BEQ	ZE85C
			PSHA
			PSHX
			JSR	F_8609
			PULX
			PULA
			BRA	ZE85C
ZE87E			LDX	#M7F01
			LDAB	M00E0
			ABX
			LDAA	,X
			STAA	M005A
			LDAA	M00E0
			LDAB	M006C
			ASLB
			MUL
			ADDD	#M7F39
			STD	M00E1
			LDAB	M006C
			DECB
			ASLB
			LDX	M00E1
			ABX
			LDAB	M006C
ZE89C			TIM	#%00000100,$01,X
			BNE	ZE8A8
ZE8A1			DEX
			DEX
			DECB
			BNE	ZE89C
			BRA	ZE8CF
ZE8A8			LDAA	M0058
			ANDA	#$78
			ANDA	$01,X
			BEQ	ZE8A1
			PSHB
			PSHX
			LDAA	M005A
			DECA
			STAA	M005A
			LDX	#M7F01
			LDAB	M00E0
			ABX
			STAA	,X
			PULX
			PSHX
			BNE	ZE8C8
			JSR	F_8703
			BRA	ZE8CB
ZE8C8			JSR	F_8731
ZE8CB			PULX
			PULB
			BRA	ZE8A1
ZE8CF			RTS

F_E8D0			TST	>M00AF
			BEQ	ZE8F3
			TST	>M00B2
			BNE	ZE8F3
			LDD	M00B0
			ADDD	#DDR2
			STD	M00B0
			XGDX
			CPX	#M0060
			BCS	ZE8F3
			CLR	>M00AF
			LDD	#$0000
			STD	M00B0
			LDAA	#$01
			STAA	M00CB
ZE8F3			RTS
HI_CALL_15		LDAA	M776B
			ANDA	#$E9
			STAA	M776B
			LDAA	M7772
			BITA	#$04
			BNE	ZE935
			ANDA	#$07
			BNE	ZE92C
			LDAA	M7788
			BEQ	ZE92C
			LDAA	M7774
			CMPA	#$19
			BEQ	ZE94D
			CMPA	#$1A
			BEQ	ZE956
			CMPA	#$1B
			BNE	ZE92C
			LDAA	M7788
			CMPA	#$02
			BEQ	ZE95A
			LDAA	M776B
			ANDA	#$F7
			STAA	M776B
			BRA	ZE95A
ZE92C			LDAA	M776B
			ANDA	#$F7
			STAA	M776B
			RTS
ZE935			LDAA	M6E39
			CMPA	#$01
			BEQ	ZE94D
			CMPA	#$02
			BEQ	ZE956
			CMPA	#$03
			BEQ	ZE95A
			LDAA	M776B
			ANDA	#$F7
			STAA	M776B
			RTS
ZE94D			LDAA	M776B
			ORAA	#$10
			STAA	M776B
			RTS
ZE956			JSR	F_E963
			RTS
ZE95A			LDAA	M776B
			ORAA	#$04
			STAA	M776B
			RTS

F_E963			CLRA
			CLRB
			STD	M775D
			STD	M775F
			STD	M7761
			STD	M7763
ZE971			LDX	#M7933
			ABX
			LDAA	,X
			BEQ	ZE99B
			LSRA
			BCS	ZE99B
			ASLA
			LDX	#M793B
			ABX
			PSHB
			LDAB	,X
			TSTB
			BPL	ZE98A
			PULB
			BRA	ZE99B
ZE98A			LDX	#M775D
			ABX
			ORAA	#$01
			STAA	,X
			PULB
			LDAA	M776B
			ORAA	#$02
			STAA	M776B
ZE99B			INCB
			CMPB	#$08
			BNE	ZE971
			RTS
HI_CALL_16		LDAA	M776B
			BITA	#$10
			BNE	ZE9AD
			BITA	#$02
			BNE	ZE9C5
			RTS
ZE9AD			AIM	#%11110111,TCSR1
			CLR	M7751
			CLR	M7752
			CLR	M7753
			CLR	M7754
			LDAA	M776B
			ANDA	#$FE
			STAA	M776B
			RTS
ZE9C5			CLR	M7766
			RTS

F_E9C9			LDAA	M776B
			BITA	#$10
			BNE	ZE9D5
			BITA	#$02
			BNE	ZEA02
			RTS
ZE9D5			CMPB	M784E
			BNE	ZEA01
			CLRB
ZE9DB			LDX	#M7751
			ABX
			TST	,X
			BEQ	ZE9F9
			TST	$0C,X
			BNE	ZE9F9
			LDAA	#$01
			STAA	$0C,X
			LDAA	M75F1
			INCA
			STAA	$14,X
			LDAA	M776B
			ORAA	#$01
			STAA	M776B
ZE9F9			INCB
			CMPB	#$04
			BNE	ZE9DB
			LDAB	M784E
ZEA01			RTS
ZEA02			LDX	#M775D
			ABX
			TST	,X
			BEQ	ZEA0D
			CLR	M7766
ZEA0D			RTS

F_EA0E			CMPB	M784E
			BNE	ZEA1A
			LDAA	M776B
			BITA	#$10
			BNE	ZEA1B
ZEA1A			RTS
ZEA1B			LDAA	M784E
			PSHB
			LDAB	>M0052
			JSR	F_8831
			PULB
			BCC	ZEA1A
			TST	M7751
			BEQ	ZEA4A
			TST	M7752
			BEQ	ZEA4D
			TST	M7753
			BEQ	ZEA51
			TST	M7754
			BEQ	ZEA55
			CLR	M7751
			LDAA	#$0C
			STAA	>M0058
			LDAB	M784E
			JSR	F_E821
ZEA4A			CLRB
			BRA	ZEA57
ZEA4D			LDAB	#$01
			BRA	ZEA57
ZEA51			LDAB	#$02
			BRA	ZEA57
ZEA55			LDAB	#$03
ZEA57			PSHB
			LDAB	M75F4
			LDAA	#$A5
			MUL
			ASLD
			ASLD
			COMA
			LSRA
			LDAB	>M00F1
			ABA
			BCS	ZEA72
			BNE	ZEA6E
			LDAA	#$01
			BRA	ZEA77
ZEA6E			CMPA	#$78
			BCS	ZEA77
ZEA72			PULB
			LDAB	M784E
			RTS
ZEA77			PULB
			LDX	#M7751
			ABX
			STAA	$04,X
			LDAA	>M0052
			STAA	,X
			LDAA	#$01
			STAA	$08,X
			CLR	$0C,X
			LDAA	M75F1
			INCA
			STAA	$10,X
			LDAA	M776B
			ORAA	#$01
			STAA	M776B
			LDAB	M784E
			RTS

F_EA9B			CMPB	M784E
			BNE	ZEAA7
			LDAA	M776B
			BITA	#$10
			BNE	ZEAA8
ZEAA7			RTS
ZEAA8			LDAA	M784E
			PSHB
			LDAB	>M0051
			JSR	F_8831
			PULB
			BCC	ZEAA7
			LDAA	>M0051
			CLRB
ZEAB9			LDX	#M7751
			ABX
			CMPA	,X
			BNE	ZEAC7
			TST	$0C,X
			BNE	ZEAC7
			BRA	ZEAD0
ZEAC7			INCB
			CMPB	#$04
			BNE	ZEAB9
			LDAB	M784E
			RTS
ZEAD0			LDAA	#$01
			STAA	$0C,X
			LDAA	M75F1
			INCA
			STAA	$14,X
			LDAA	M776B
			ORAA	#$01
			STAA	M776B
			LDAB	M784E
			RTS

F_EAE6			LDAA	M776B
			ANDA	#$FE
			STAA	M776B
			BITA	#$10
			BNE	ZEAF3
			RTS
ZEAF3			CLRB
ZEAF4			LDX	#M7751
			ABX
			TST	,X
			BEQ	ZEB22
			LDAA	M776B
			ORAA	#$01
			STAA	M776B
			TST	$04,X
			BEQ	ZEB15
			DEC	$10,X
			BNE	ZEB15
			PSHB
			JSR	F_EB28
			PULB
			LDX	#M7751
			ABX
ZEB15			TST	$0C,X
			BEQ	ZEB22
			DEC	$14,X
			BNE	ZEB22
			PSHB
			JSR	F_EBB1
			PULB
ZEB22			INCB
			CMPB	#$04
			BCS	ZEAF4
			RTS

F_EB28			PSHB
			LDAB	$08,X
			LDAA	,X
			STAA	>M0052
ZEB30			LDAA	M75F2
			ADDA	>M0052
			SUBA	#$18
			BMI	ZEB42
ZEB3A			STAA	>M0052
			DECB
			BNE	ZEB30
			BRA	ZEB52
ZEB42			CMPA	#$C0
			BCS	ZEB4C
ZEB46			ADDA	#$0C
			BMI	ZEB46
			BRA	ZEB3A
ZEB4C			SUBA	#$0C
			BMI	ZEB4C
			BRA	ZEB3A
ZEB52			LDAA	$04,X
			STAA	>M00F1
			PULB
			CMPB	#$01
			BCS	ZEB69
			BEQ	ZEB70
			CMPB	#$02
			BEQ	ZEB77
			LDAA	#$44
			STAA	>M0058
			BRA	ZEB7E
ZEB69			LDAA	#$0C
			STAA	>M0058
			BRA	ZEB7E
ZEB70			LDAA	#$14
			STAA	>M0058
			BRA	ZEB7E
ZEB77			LDAA	#$24
			STAA	>M0058
			BRA	ZEB7E
ZEB7E			LDAB	M784E
			PSHX
			JSR	HI_CALL_1D
			PULX
			INC	$08,X
			LDAA	$04,X
			LDAB	M75F3
			PSHX
			LDX	#MEBA9
			ABX
			ADDA	,X
			PULX
			BCS	ZEB9D
			CMPA	#$78
			BCC	ZEB9D
			BRA	ZEBA0
ZEB9D			CLR	$04,X
			RTS
ZEBA0			STAA	$04,X
			LDAA	M75F1
			INCA
			STAA	$10,X
			RTS

MEBA9			FCB	$FF,$76,$3B,$27,$1D,$17,$13,$0E

F_EBB1			PSHB
			LDAB	$0C,X
			LDAA	,X
			STAA	>M0051
ZEBB9			LDAA	M75F2
			ADDA	>M0051
			SUBA	#$18
			BMI	ZEBCB
ZEBC3			STAA	>M0051
			DECB
			BNE	ZEBB9
			BRA	ZEBDB
ZEBCB			CMPA	#$C0
			BCS	ZEBD5
ZEBCF			ADDA	#$0C
			BMI	ZEBCF
			BRA	ZEBC3
ZEBD5			SUBA	#$0C
			BMI	ZEBD5
			BRA	ZEBC3
ZEBDB			PULB
			CMPB	#$01
			BCS	ZEBEA
			BEQ	ZEBEE
			CMPB	#$02
			BEQ	ZEBF2
			LDAA	#$44
			BRA	ZEBF6
ZEBEA			LDAA	#$0C
			BRA	ZEBF6
ZEBEE			LDAA	#$14
			BRA	ZEBF6
ZEBF2			LDAA	#$24
			BRA	ZEBF6
ZEBF6			STAA	>M0058
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1C
			PULX
			INC	$0C,X
			LDAA	$0C,X
			CMPA	$08,X
			BNE	ZEC10
			TST	$04,X
			BNE	ZEC10
			CLR	,X
			RTS
ZEC10			LDAA	M75F1
			INCA
			STAA	$14,X
			RTS

F_EC17			LDAA	#$02
			BITA	M776B
			BNE	ZEC1F
			RTS
ZEC1F			INC	M7765
			LDAA	M7765
			CMPA	#$3C
			BEQ	ZEC2A
			RTS
ZEC2A			CLR	M7765
			CLRA
			CLRB
ZEC2F			LDX	#M775D
			ABX
			TST	,X
			BEQ	ZEC41
			LDX	#M7D6B
			ABX
			CMPA	,X
			BCC	ZEC41
			LDAA	,X
ZEC41			INCB
			CMPB	#$08
			BNE	ZEC2F
			TAB
			COMB
			LDX	#MA82B
			ABX
			LDAB	,X
			COMB
			LDX	#MEF41
			ABX
			LDAA	,X
			STAA	M775B
			TST	M75F5
			BEQ	ZEC6F
			LDAB	M7750
			CMPB	#$40
			BCS	ZEC68
			STAA	M775C
			RTS
ZEC68			ASLB
			ASLB
			MUL
			STAA	M775C
			RTS
ZEC6F			LDAB	M7750
			MUL
			STAA	M775C
			RTS

F_EC77			LDAA	#$02
			BITA	M776B
			BNE	ZEC7F
			RTS
ZEC7F			TST	M75F5
			BNE	ZEC85
			RTS
ZEC85			LDX	#M775D
			ABX
			TST	,X
			BNE	ZEC8E
			RTS
ZEC8E			INC	M7766
			LDAA	M7766
			CMPA	#$01
			BEQ	ZEC99
			RTS
ZEC99			PSHB
			LDAA	M75F5
			CMPA	#$01
			BEQ	ZECA6
			LDAA	>M0052
			BRA	ZECA9
ZECA6			LDAA	M7769
ZECA9			ASLA
			LDAB	M7750
			CMPB	#$41
			BCS	ZECD8
			CMPA	#$80
			BEQ	ZECD8
			BCS	ZECC8
			SUBA	#$80
			MUL
			CMPA	#$20
			BCS	ZECC2
			LDAA	#$FF
			BRA	ZECD8
ZECC2			ASLD
			ASLD
			ADDA	#$80
			BRA	ZECD8
ZECC8			NEGA
			SUBA	#$80
			MUL
			CMPA	#$20
			BCS	ZECD3
			CLRA
			BRA	ZECD8
ZECD3			ASLD
			ASLD
			ADDA	#$80
			NEGA
ZECD8			JSR	F_ED1E
			PULB
			RTS

F_ECDD			LDAA	M776B
			BITA	#$02
			BNE	ZECE5
			RTS
ZECE5			TST	M75F5
			BNE	ZECEB
			RTS
ZECEB			LDX	#M775D
			ABX
			TST	,X
			BNE	ZECF4
			RTS
ZECF4			DEC	M7766
			BMI	ZECFA
			RTS
ZECFA			CLR	M7766
			RTS

F_ECFE			LDAB	#$02
			BITB	M776B
			BNE	ZED06
			RTS
ZED06			TST	M75F5
			BEQ	ZED0C
			RTS
ZED0C			LDAA	M7836
			SUBA	#$3F
			CMPA	#$80
			BCC	ZED18
			ASLA
			BRA	ZED1A
ZED18			COMA
			ASLA
ZED1A			JSR	F_ED1E
			RTS

F_ED1E			LDAB	M775B
			MUL
			TST	M75F5
			BEQ	ZED33
			LDAB	M7750
			CMPB	#$40
			BCC	ZED37
			ASLB
			ASLB
			MUL
			BRA	ZED37
ZED33			LDAB	M7750
			MUL
ZED37			TAB
			LDAA	M775C
			SBA
			TST	M75F6
			BEQ	ZED44
			PSHA
			TBA
			PULB
ZED44			STAA	M7751
			STAB	M7752
			CLRB
ZED4B			LDX	#M775D
			ABX
			LDAA	,X
			BEQ	ZED69
			LDX	#M7753
			ABX
			BITA	#$02
			BEQ	ZED62
			LDAA	M7752
			STAA	,X
			BRA	ZED6F
ZED62			LDAA	M7751
			STAA	,X
			BRA	ZED6F
ZED69			LDX	#M7753
			ABX
			CLR	,X
ZED6F			INCB
			CMPB	#$08
			BNE	ZED4B
			RTS

F_ED75			LDAA	#$31
			STAA	M7751
			STAA	M7752
			STAA	M7753
			STAA	M7754
			CLR	M7755
			LDAA	M776B
			ORAA	#$08
			STAA	M776B
			RTS

F_ED8F			LDAA	M776B
			BITA	#$04
			BNE	ZED98
			CLV
			RTS
ZED98			CMPB	M784E
			BEQ	ZED9F
			CLV
			RTS
ZED9F			LDAA	M784E
			PSHB
			LDAB	>M0052
			JSR	F_8831
			PULB
			BCS	ZEDAE
			CLV
			RTS
ZEDAE			LDAA	M776B
			BITA	#$08
			BNE	ZEDC2
			LDAA	>M0052
			PSHA
			JSR	F_EE69
			PULA
			STAA	>M0052
			SEV
			RTS
ZEDC2			LDAA	>M0052
			SUBA	#$24
			SUBA	M7789
			CMPA	#$31
			BCS	ZEDD0
			SEV
			RTS
ZEDD0			LDAB	M7755
			CMPB	#$04
			BCS	ZEDDC
			LDAB	M784E
			CLV
			RTS
ZEDDC			LDX	#M7751
			ABX
			STAA	,X
			INC	M7755
			LDAB	M784E
			CLV
			RTS

F_EDEA			LDAA	M776B
			BITA	#$04
			BNE	ZEDF3
			CLV
			RTS
ZEDF3			CMPB	M784E
			BEQ	ZEDFA
			CLV
			RTS
ZEDFA			LDAA	M784E
			PSHB
			LDAB	>M0051
			JSR	F_8831
			PULB
			BCS	ZEE09
			CLV
			RTS
ZEE09			LDAA	M776B
			BITA	#$08
			BNE	ZEE1D
			LDAA	>M0051
			PSHA
			JSR	F_EED5
			PULA
			STAA	>M0051
			SEV
			RTS
ZEE1D			CLV
			RTS

F_EE1F			LDAA	M776B
			ANDA	#$0C
			CMPA	#$0C
			BEQ	ZEE29
			RTS
ZEE29			TST	M7755
			BNE	ZEE2F
			RTS
ZEE2F			LDX	#M7CE3
			CLRA
			ORAA	$01,X
			ORAA	$03,X
			ORAA	$05,X
			ORAA	$07,X
			ORAA	$09,X
			ORAA	$0B,X
			ORAA	$0D,X
			ORAA	$0F,X
			TSTA
			BEQ	ZEE47
			RTS
ZEE47			LDAA	M776B
			ANDA	#$F7
			STAA	M776B
			LDAB	M7789
			ASLB
			ASLB
			LDX	#M75F8
			ABX
			LDD	M7751
			STD	,X
			LDD	M7753
			STD	$02,X
			JSR	F_C95A
			JSR	F_C972
			RTS

F_EE69			LDAA	>M0052
			STAA	M7756
ZEE6F			SUBA	#$0C
			BCC	ZEE6F
			ADDA	#$0C
			TAB
			ASLB
			ASLB
			LDX	#M75F8
			ABX
			LDAA	,X
			CMPA	#$31
			BCC	ZEE92
			SUBA	#$18
			ADDA	M7756
			STAA	>M0052
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1D
			PULX
ZEE92			LDAA	$01,X
			CMPA	#$31
			BCC	ZEEA8
			SUBA	#$18
			ADDA	M7756
			STAA	>M0052
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1D
			PULX
ZEEA8			LDAA	$02,X
			CMPA	#$31
			BCC	ZEEBE
			SUBA	#$18
			ADDA	M7756
			STAA	>M0052
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1D
			PULX
ZEEBE			LDAA	$03,X
			CMPA	#$31
			BCC	ZEED4
			SUBA	#$18
			ADDA	M7756
			STAA	>M0052
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1D
			PULX
ZEED4			RTS

F_EED5			LDAA	>M0051
			STAA	M7756
ZEEDB			SUBA	#$0C
			BCC	ZEEDB
			ADDA	#$0C
			TAB
			ASLB
			ASLB
			LDX	#M75F8
			ABX
			LDAA	,X
			CMPA	#$31
			BCC	ZEEFE
			SUBA	#$18
			ADDA	M7756
			STAA	>M0051
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1C
			PULX
ZEEFE			LDAA	$01,X
			CMPA	#$31
			BCC	ZEF14
			SUBA	#$18
			ADDA	M7756
			STAA	>M0051
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1C
			PULX
ZEF14			LDAA	$02,X
			CMPA	#$31
			BCC	ZEF2A
			SUBA	#$18
			ADDA	M7756
			STAA	>M0051
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1C
			PULX
ZEF2A			LDAA	$03,X
			CMPA	#$31
			BCC	ZEF40
			SUBA	#$18
			ADDA	M7756
			STAA	>M0051
			LDAB	M784E
			PSHX
			JSR	HI_CALL_1C
			PULX
ZEF40			RTS

MEF41			FCB	$00,$08,$0C,$13,$18,$1D,$20,$27,$2B,$30,$33,$38,$3C
			FCB	$3F,$43,$47,$4B,$50,$54,$58,$5B,$5F,$63,$65,$68,$6C
			FCB	$6F,$72,$75,$78,$7B,$7D,$80,$83,$9A,$9C,$8B,$8D,$90
			FCB	$92,$94,$96,$99,$9B,$9D,$9F,$A1,$A3,$A5,$A7,$A9,$AB
			FCB	$AD,$AE,$B0,$B2,$B3,$B5,$B7,$B8,$BA,$BB,$BD,$BE,$BF
			FCB	$C1,$C2,$C4,$C5,$C6,$C7,$C9,$CA,$CB,$CC,$CD,$CE,$CF
			FCB	$D1,$D1,$D2,$D3,$D4,$D5,$D6,$D7,$D8,$D8,$D9,$DA,$DB
			FCB	$DC,$DC,$DD,$DE,$DE,$DF,$E0,$E1,$E1,$E2,$E2,$E3,$E4
			FCB	$E4,$E5,$E5,$E6,$E6,$E7,$E7,$E8,$E8,$E9,$E9,$EA,$EA
			FCB	$EB,$EB,$EB,$EC,$EC,$ED,$ED,$ED,$EE,$EE,$EE,$EF,$EF
			FCB	$F0,$F0,$F0,$F0,$F1,$F1,$F1,$F2,$F2,$F2,$F2,$F3,$F3
			FCB	$F3,$F3,$F4,$F4,$F4,$F4,$F5,$F5,$F5,$F5,$F5,$F6,$F6
			FCB	$F6,$F6,$F6,$F6,$F7,$F7,$F7,$F7,$F7,$F7,$F8,$F8,$F8
			FCB	$F8,$F8,$F8,$F8,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$F9,$FA
			FCB	$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FA,$FB,$FB,$FB
			FCB	$FB,$FB,$FB,$FB,$FB,$FB,$FB,$FB,$FB,$FB,$FC,$FC,$FC
			FCB	$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FC,$FC
			FCB	$FC,$FC,$FC,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD
			FCB	$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD,$FD
			FCB	$FD,$FD,$FD,$FD,$FD,$FD,$FE,$FE,$FF

S_VERSION		FCC	"V1.6  03-Feb-88 "
			FCB	$00

F_F052			LDAB	#30
F_F054			LDX	#4500
ZF057			DEX
			BNE	ZF057
			DECB
			BNE	F_F054
			RTS
			RTS
			RTS
			RTS
			RTS
			RTS
			RTS
			RTS
ZF065			BRA	ZF065

			INCLUDE	"inc/vecs.asm"
